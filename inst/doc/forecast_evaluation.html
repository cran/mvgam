<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Nicholas J Clark" />

<meta name="date" content="2024-05-09" />

<title>Forecasting and forecast evaluation in mvgam</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Forecasting and forecast evaluation in
mvgam</h1>
<h4 class="author">Nicholas J Clark</h4>
<h4 class="date">2024-05-09</h4>


<div id="TOC">
<ul>
<li><a href="#simulating-discrete-time-series" id="toc-simulating-discrete-time-series">Simulating discrete time
series</a>
<ul>
<li><a href="#modelling-dynamics-with-splines" id="toc-modelling-dynamics-with-splines">Modelling dynamics with
splines</a></li>
<li><a href="#modelling-dynamics-with-gps" id="toc-modelling-dynamics-with-gps">Modelling dynamics with
GPs</a></li>
</ul></li>
<li><a href="#forecasting-with-the-forecast-function" id="toc-forecasting-with-the-forecast-function">Forecasting with the
<code>forecast()</code> function</a></li>
<li><a href="#forecasting-with-newdata-in-mvgam" id="toc-forecasting-with-newdata-in-mvgam">Forecasting with
<code>newdata</code> in <code>mvgam()</code></a></li>
<li><a href="#scoring-forecast-distributions" id="toc-scoring-forecast-distributions">Scoring forecast
distributions</a></li>
<li><a href="#further-reading" id="toc-further-reading">Further
reading</a></li>
<li><a href="#interested-in-contributing" id="toc-interested-in-contributing">Interested in contributing?</a></li>
</ul>
</div>

<p>The purpose of this vignette is to show how the <code>mvgam</code>
package can be used to produce probabilistic forecasts and to evaluate
those forecasts using a variety of proper scoring rules.</p>
<div id="simulating-discrete-time-series" class="section level2">
<h2>Simulating discrete time series</h2>
<p>We begin by simulating some data to show how forecasts are computed
and evaluated in <code>mvgam</code>. The <code>sim_mvgam()</code>
function can be used to simulate series that come from a variety of
response distributions as well as seasonal patterns and/or dynamic
temporal patterns. Here we simulate a collection of three time
count-valued series. These series all share the same seasonal pattern
but have different temporal dynamics. By setting
<code>trend_model = &#39;GP&#39;</code> and <code>prop_trend = 0.75</code>, we
are generating time series that have smooth underlying temporal trends
(evolving as Gaussian Processes with squared exponential kernel) and
moderate seasonal patterns. The observations are Poisson-distributed and
we allow 10% of observations to be missing.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>simdat <span class="ot">&lt;-</span> <span class="fu">sim_mvgam</span>(<span class="at">T =</span> <span class="dv">100</span>, </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>                    <span class="at">n_series =</span> <span class="dv">3</span>, </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                    <span class="at">trend_model =</span> <span class="st">&#39;GP&#39;</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>                    <span class="at">prop_trend =</span> <span class="fl">0.75</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                    <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                    <span class="at">prop_missing =</span> <span class="fl">0.10</span>)</span></code></pre></div>
<p>The returned object is a <code>list</code> containing training and
testing data (<code>sim_mvgam()</code> automatically splits the data
into these folds for us) together with some other information about the
data generating process that was used to simulate the data</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">str</span>(simdat)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; List of 6</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;  $ data_train        :&#39;data.frame&#39;:  225 obs. of  5 variables:</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;   ..$ y     : int [1:225] 0 1 3 0 0 0 1 0 3 1 ...</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;   ..$ season: int [1:225] 1 1 1 2 2 2 3 3 3 4 ...</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;   ..$ year  : int [1:225] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;   ..$ series: Factor w/ 3 levels &quot;series_1&quot;,&quot;series_2&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;   ..$ time  : int [1:225] 1 1 1 2 2 2 3 3 3 4 ...</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;  $ data_test         :&#39;data.frame&#39;:  75 obs. of  5 variables:</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;   ..$ y     : int [1:75] 0 1 1 0 0 0 2 2 0 NA ...</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;   ..$ season: int [1:75] 4 4 4 5 5 5 6 6 6 7 ...</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;   ..$ year  : int [1:75] 7 7 7 7 7 7 7 7 7 7 ...</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;   ..$ series: Factor w/ 3 levels &quot;series_1&quot;,&quot;series_2&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;   ..$ time  : int [1:75] 76 76 76 77 77 77 78 78 78 79 ...</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;  $ true_corrs        : num [1:3, 1:3] 1 0.465 -0.577 0.465 1 ...</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  $ true_trends       : num [1:100, 1:3] -1.45 -1.54 -1.61 -1.67 -1.73 ...</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;  $ global_seasonality: num [1:100] 0.0559 0.6249 1.3746 1.6805 0.5246 ...</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  $ trend_params      :List of 2</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;   ..$ alpha: num [1:3] 0.767 0.988 0.897</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;   ..$ rho  : num [1:3] 6.02 6.94 5.04</span></span></code></pre></div>
<p>Each series in this case has a shared seasonal pattern. The resulting
time series are similar to what we might encounter when dealing with
count-valued data that can take small counts:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot_mvgam_series</span>(<span class="at">data =</span> simdat<span class="sc">$</span>data_train, </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                  <span class="at">series =</span> <span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting time series features for GAM models in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<p>For individual series, we can plot the training and testing data, as
well as some more specific features of the observed data:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot_mvgam_series</span>(<span class="at">data =</span> simdat<span class="sc">$</span>data_train, </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                  <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                  <span class="at">series =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting time series features for GAM models in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<div id="modelling-dynamics-with-splines" class="section level3">
<h3>Modelling dynamics with splines</h3>
<p>The first model we will fit uses a shared cyclic spline to capture
the repeated seasonality, as well as series-specific splines of time to
capture the long-term dynamics. We allow the temporal splines to be
fairly complex so they can capture as much of the temporal variation as
possible:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(y <span class="sc">~</span> <span class="fu">s</span>(season, <span class="at">bs =</span> <span class="st">&#39;cc&#39;</span>, <span class="at">k =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                <span class="fu">s</span>(time, <span class="at">by =</span> series, <span class="at">bs =</span> <span class="st">&#39;cr&#39;</span>, <span class="at">k =</span> <span class="dv">20</span>),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>              <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">season =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">12.5</span>)),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>              <span class="at">trend_model =</span> <span class="st">&#39;None&#39;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>              <span class="at">data =</span> simdat<span class="sc">$</span>data_train)</span></code></pre></div>
<p>The model fits without issue:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">summary</span>(mod1, <span class="at">include_betas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; y ~ s(season, bs = &quot;cc&quot;, k = 8) + s(time, by = series, bs = &quot;cr&quot;, </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;     k = 20)</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x000001ba309013f0&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; 3 </span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; 75 </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt;              2.5%   50%  97.5% Rhat n_eff</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.41 -0.21 -0.039    1   813</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt;                         edf Ref.df Chi.sq p-value    </span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; s(season)              3.77      6   21.9  0.0039 ** </span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; s(time):seriesseries_1 6.50     19   14.6  0.8790    </span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; s(time):seriesseries_2 9.49     19  228.9  &lt;2e-16 ***</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt; s(time):seriesseries_3 5.93     19   18.9  0.8515    </span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations ended with a divergence (0%)</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Thu May 09 6:54:44 PM 2024.</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>And we can plot the partial effects of the splines to see that they
are estimated to be highly nonlinear</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="at">type =</span> <span class="st">&#39;smooths&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting GAM smooth functions using mvgam" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="modelling-dynamics-with-gps" class="section level3">
<h3>Modelling dynamics with GPs</h3>
<p>Before showing how to produce and evaluate forecasts, we will fit a
second model to these data so the two models can be compared. This model
is equivalent to the above, except we now use Gaussian Processes to
model series-specific dynamics. This makes use of the <code>gp()</code>
function from <code>brms</code>, which can fit Hilbert space approximate
GPs. See <code>?brms::gp</code> for more details.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(y <span class="sc">~</span> <span class="fu">s</span>(season, <span class="at">bs =</span> <span class="st">&#39;cc&#39;</span>, <span class="at">k =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                <span class="fu">gp</span>(time, <span class="at">by =</span> series, <span class="at">c =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">k =</span> <span class="dv">20</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">FALSE</span>),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>              <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">season =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">12.5</span>)),</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>              <span class="at">trend_model =</span> <span class="st">&#39;None&#39;</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>              <span class="at">data =</span> simdat<span class="sc">$</span>data_train)</span></code></pre></div>
<p>The summary for this model now contains information on the GP
parameters for each time series:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summary</span>(mod2, <span class="at">include_betas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; y ~ s(season, bs = &quot;cc&quot;, k = 8) + gp(time, by = series, c = 5/4, </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt;     k = 20, scale = FALSE)</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x000001ba309013f0&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; 3 </span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; 75 </span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt;             2.5%   50% 97.5% Rhat n_eff</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; (Intercept) -1.1 -0.52  0.31    1   768</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; GAM gp term marginal deviation (alpha) and length scale (rho) estimates:</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt;                               2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; alpha_gp(time):seriesseries_1 0.21  0.8   2.1 1.01   763</span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; alpha_gp(time):seriesseries_2 0.74  1.4   2.9 1.00  1028</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; alpha_gp(time):seriesseries_3 0.50  1.1   2.8 1.00  1026</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; rho_gp(time):seriesseries_1   1.20  5.1  23.0 1.00   681</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; rho_gp(time):seriesseries_2   2.20 10.0  17.0 1.00   644</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; rho_gp(time):seriesseries_3   1.50  8.8  23.0 1.00   819</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt;            edf Ref.df Chi.sq p-value    </span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; s(season) 4.12      6   25.9 0.00052 ***</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; 4 of 2000 iterations ended with a divergence (0.2%)</span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt;  *Try running with larger adapt_delta to remove the divergences</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Thu May 09 6:55:28 PM 2024.</span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>We can plot the posteriors for these parameters, and for any other
parameter for that matter, using <code>bayesplot</code> routines. First
the marginal deviation (<span class="math inline">\(\alpha\)</span>)
parameters:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">mcmc_plot</span>(mod2, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">&#39;alpha_gp&#39;</span>), <span class="at">regex =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&#39;areas&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Summarising latent Gaussian Process parameters in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<p>And now the length scale (<span class="math inline">\(\rho\)</span>)
parameters:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">mcmc_plot</span>(mod2, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">&#39;rho_gp&#39;</span>), <span class="at">regex =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&#39;areas&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Summarising latent Gaussian Process parameters in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<p>We can also plot the nonlinear effects using
<code>marginaleffects</code> utilities:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">require</span>(<span class="st">&#39;ggplot2&#39;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">plot_predictions</span>(mod2, </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                 <span class="at">condition =</span> <span class="fu">c</span>(<span class="st">&#39;time&#39;</span>, <span class="st">&#39;series&#39;</span>, <span class="st">&#39;series&#39;</span>),</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;link&#39;</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Summarising latent Gaussian Process parameters in mvgam and marginaleffects" width="60%" style="display: block; margin: auto;" /></p>
<p>The estimates for the temporal trends are fairly similar for the two
models, but below we will see if they produce similar forecasts</p>
</div>
</div>
<div id="forecasting-with-the-forecast-function" class="section level2">
<h2>Forecasting with the <code>forecast()</code> function</h2>
<p>Probabilistic forecasts can be computed in two main ways in
<code>mvgam</code>. The first is to take a model that was fit only to
training data (as we did above in the two example models) and produce
temporal predictions from the posterior predictive distribution by
feeding <code>newdata</code> to the <code>forecast()</code> function. It
is crucial that any <code>newdata</code> fed to the
<code>forecast()</code> function follows on sequentially from the data
that was used to fit the model (this is not internally checked by the
package because it might be a headache to do so when data are not
supplied in a specific time-order). When calling the
<code>forecast()</code> function, you have the option to generate
different kinds of predictions (i.e. predicting on the link scale,
response scale or to produce expectations; see
<code>?forecast.mvgam</code> for details). We will use the default and
produce forecasts on the response scale, which is the most common way to
evaluate forecast distributions</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fc_mod1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod1, <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>fc_mod2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod2, <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test)</span></code></pre></div>
<p>The objects we have created are of class <code>mvgam_forecast</code>,
which contain information on hindcast distributions, forecast
distributions and true observations for each series in the data:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">str</span>(fc_mod1)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; List of 16</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;  $ call              :Class &#39;formula&#39;  language y ~ s(season, bs = &quot;cc&quot;, k = 8) + s(time, by = series, bs = &quot;cr&quot;, k = 20)</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: 0x000001ba309013f0&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt;  $ trend_call        : NULL</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;  $ family            : chr &quot;poisson&quot;</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt;  $ family_pars       : NULL</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt;  $ trend_model       : chr &quot;None&quot;</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt;  $ drift             : logi FALSE</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt;  $ use_lv            : logi FALSE</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;  $ fit_engine        : chr &quot;stan&quot;</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;  $ type              : chr &quot;response&quot;</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;  $ series_names      : Factor w/ 3 levels &quot;series_1&quot;,&quot;series_2&quot;,..: 1 2 3</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;  $ train_observations:List of 3</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: int [1:75] 0 0 1 1 0 0 0 0 0 0 ...</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: int [1:75] 1 0 0 1 1 0 1 0 1 2 ...</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: int [1:75] 3 0 3 NA 2 1 1 1 1 3 ...</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;  $ train_times       : int [1:75] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt;  $ test_observations :List of 3</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: int [1:25] 0 0 2 NA 0 2 2 1 1 1 ...</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: int [1:25] 1 0 2 1 1 3 0 1 0 NA ...</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: int [1:25] 1 0 0 1 0 0 1 0 1 0 ...</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt;  $ test_times        : int [1:25] 76 77 78 79 80 81 82 83 84 85 ...</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt;  $ hindcasts         :List of 3</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: num [1:2000, 1:75] 1 1 0 0 0 1 1 1 0 0 ...</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:75] &quot;ypred[1,1]&quot; &quot;ypred[2,1]&quot; &quot;ypred[3,1]&quot; &quot;ypred[4,1]&quot; ...</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: num [1:2000, 1:75] 0 0 0 0 0 0 0 1 0 0 ...</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:75] &quot;ypred[1,2]&quot; &quot;ypred[2,2]&quot; &quot;ypred[3,2]&quot; &quot;ypred[4,2]&quot; ...</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: num [1:2000, 1:75] 3 0 2 1 0 1 2 1 5 1 ...</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:75] &quot;ypred[1,3]&quot; &quot;ypred[2,3]&quot; &quot;ypred[3,3]&quot; &quot;ypred[4,3]&quot; ...</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt;  $ forecasts         :List of 3</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: num [1:2000, 1:25] 1 3 2 1 0 0 1 1 0 0 ...</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: num [1:2000, 1:25] 6 0 0 0 0 2 0 0 0 0 ...</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: num [1:2000, 1:25] 0 1 1 3 3 1 3 2 4 2 ...</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;mvgam_forecast&quot;</span></span></code></pre></div>
<p>We can plot the forecasts for some series from each model using the
<code>S3 plot</code> method for objects of this class:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod1, <span class="at">series =</span> <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; Out of sample CRPS:</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; 14.6296405</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod2, <span class="at">series =</span> <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; Out of sample DRPS:</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; 10.92516425</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">plot</span>(fc_mod1, <span class="at">series =</span> <span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt; Out of sample CRPS:</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; 84201962707.6125</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod2, <span class="at">series =</span> <span class="dv">2</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt; Out of sample DRPS:</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; 14.311523</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAAeFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtgYGBmAABmADpmtrZmtv+PJyeQOgCQOjqQZgCQ2/+iUFCzs7O2ZgC2/7a2//+5fHzFkpLHmZnQ0NDbkDrb/7bb/9vb///cvLzcv7/p1dX/tmb/25D//7b//9v///9SaXd9AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAYR0lEQVR4nO2da2PbOHZAldieZt16vI3lxvVoNtrKNv//P6z4fuENXBGQzvkwQ4vEJXhxQlIgBO4qAAF2W1cArhPEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUCEtGLt8BRa/Ez4et41fP+liYZY0OJlwmH31C6cdj/U0RALWnxM+HoedDrc/VZGQyxo8THh8/GpXzypL4aIBR2csUAEv3usbz/bhY8H7rHAiJ8Jn4/tt0L1+QqxYIB+rJIoKL9parobSBIONBSUX7+aHs7qNN8MD3wr3IKC8ut3837W6ePhvkKsjSgov37dDfXZ6vPxfOuOWJtQUH4DOkhrsxBrEwrKr/8Zq/7/PWJtQkH59b7Hqvl40IxvKOjAi6Sg/PrVtB/V8PWMWFtQUH7pIAUREAtEQCwQAbFABMQCERALREAsEAGxSqKg/CJWSRSUX8QqiYLyi1glUVB+EaskCsovYpVEQflFrJIoKL+IVRIF5RexSqKg/CIWiIBYIAJigQiIBSIgFoiAWInYb12BzECsRCDWHMRKxEXEKii/iJUIxJqDWIlArDmIlYY9Ys1BrDQg1gLESsP+ImYVlF/ESgNiLUCsNCDWAsRKA2ItQKwk7C8jVkEgVhIQawliJQGxliBWEvbZm3W88P4QKwmItQSxUrDPXqwjYpUIYq1ArBRcSqzw/CJWkWQv1hGxigSxViBWCvYXMitGrAubhVgJ2Ocu1hGxigSx1iBWAhBrDWIlIHexjhuKZXs/vWM0xBKlPLGs76d3jHaTYu0vJlYYx+3Esr+f3jHabYuVqVnHLcxqTbC/n94xGmJlyIZi2d9P7xgNsTJkQ7Hs76d3jIZYGbKlWNb30ztGQ6wM2VSsRNEQK0PyEev1Sbnt52N9VjvtdtrLJWLJEpbfMsQ63FfDt8h1NMQSJU6si5rlK1an1OnutzLajYslbdYVi/Xxx8968aS+GCKWLFcs1tc/W7E4Yw3sMxfrWIBY5/v2XXuP9UMdDbFEuVKxqsatbz+rw06zAWLJcr1i2aIhlig3J9ZuIEGVSgOxVNDzHs0FxQriuIlZowlfz/f1OFL11z3XaIiVH1uL9fr918fDfa2XjvZbYQv9WAP7zM3aWKyv5x/V6fxtzzQeyzr0AbG2royCjcWqu6YOdVeCyR3T+ayJhlj5kYFY56thdTDeZJ10PVhdNMTKj83vse7+frzX9qk7RrtBsfaZi3XcWqyv5/Mdue1aZ4uGWKKE5HdzsZJEQyxRYsW6oFmIFQtiKZnU9PNxd/ev55hbLMQSNqtIsU7ffp6/EX48cPPuwW63Qywlsw7SuqvB3N1gi3ZjYjUPIRBLxbyDlLkb/EAsLZMz1n0j1itnLHcQS8vkHmv3dBZLOzjULdqNicU9lpb5t8JdPfA4JtqtiVVd9lthCMdtzKIfK5J95mIdEatMEEsNYkWyFCs3s7YV6/Px7u9H49hQx2iIhVgtnLEiQSw1k36smH6GPhpiIVbLrOc9PhpiiYoVkN/NxfqKG9fQRbtpseRfZl+iWP0ERXHRblmsrhtecmfxYl3MrMmlkG+FIcy8qs2S3FmJYqWJdnNi7TMXa+mVk1gpLESsOCa3WP1QB8G9lSkWQ5MD2M/NEr57L1IshiaHsOptQKwWhibHgVgaGJocx2XF8md7sRiaHILCq8zFcpEl8T0WQ5P9QSwdDE2OArF00I8VBWLpQKwoEEvHdBojJrf1RiVWTmatvXKQxUtCHaMJ9sltHaLdmFhKrwTF8s5vBmK5TG5rj4ZYiNUy7yC1TW5rjYZYiNUyE8s+ua0tGmJlL5bdltT3WExu6w1iaZl+K2RyW0/UXiFWDf1YESCWHsSKALH0IFYEiKUHsSK4uFi+qLyy2uLjoB7EikAjVj5mIVaR6LxCrIpJQWJALAOznvdoblesxSQOmZCDWEwK4s1Updn0yVtXbCAHsZgUxJu5VxOztq7YQA5iMSmIL/vLi+Wb3xzESsKtirUvSSylLkdloZiqRpRVRLtVsfaXuccqU6yPB37+5YO2t6FIsY6qQjFVHZZOu/prIT9YdUYvlphZnvlVe6XSZfKpz+2Yqar9Qj8Si5/Yu4JYxqr2C30HqXHM+9ez+ZsjYpUr1lFRKKaq/YLLGWu4TraXTUU0xCpSrOnHqcVyuMeadM5rfnJxS2IZvEIsv2+Fn4+DdCf1xRCxZMXyxE+s47pQxL59TOCMNQWxjLQmnO/cP//T3oN16M9nuplKEatIsWafbyHW8EBRd4OPWCWLdVwVith3Z8JhN8BDaDcQy8jYj+VyxtJGGYioSmHkL5bGq5Uuuu14CL0FJq8yMcvVF8TKiU3E8stvMWINYwG1d2KIlZFYzr5sLlb19Wy5s0csWbOuVazKNhkNYiFWX1W/zU/m4VqIlY9Yel2OgRv6VTWirCIaYiFWV9Vhiem4fbB4JWRWkWIxHbcP2Ytl0OWyYjEdtxeIZatqv8B03F5sI5YHWYnFdNzOWMXa2CyTV0fnLSMqMLnHYjpuDxDLwvRbIdNxu4NYFujHCsLu1ba+Gb2aC4NYOREu1mXMykks249RnaIhFmK1zDpII+J00W5ErAivosRyzq+7WM4C+la1X2AOUg9ixIoxC7GuHMSyV7VfiOxo6KLdhlhRXt2aWLahVm7RECsLsSxeXfhSyO8KXYkTK8KsEsVKwm2IFelVVmI5C+hd1YiyimiIhVhdVcdFJrd1JFascLOKFOu6JrcV/LV/tFfyne85iXVdk9tKziOBWC6sOkivYwSpoFjxXonbZfPq6LplRB04Y/mSSixBs6xiHR23jKgD91i+IJYTfCv05SrEOrptGVEH+rE8SeaVoFnOYjnqFwJiebKpWI75RawCuRKxjk4b+tdwrGrz38/Hu795CO1CQq/ExHLx6ui0oX8Nx6pGlFVEQyxRsxDrarkasY4uG3pXcFLVfqGfjvs6et7FQCzXqvYLiOWCjzQCZqUVy0m+UNqa9r8prGHuBgPuXs3ePp6jWMdLiFVFvpliiIZYo1cOZvnuvkSxklC8WJYmd/VKSiwnHL1yci+ciQn1uIbIn+pcj1jqNncWa+8mlohZuYnV3rXr3kToGA2xJmY5bCVxDJmJNQz0u4rxWKGYm9zDK0cEDiGhV4wgTYa5zdOLJWBWbmJd1wjSUBAruVhXNoI0DHOTC3iVXqyUXiX6Vtj8yD5ukizEkhXLIb8ZipWAaxJr3eYSYvmZhViFYmxyEa9Si5XUK8RKBWIlFosRpC3GNveRZfnH8Mk6jE/9ihMrFYWLZWxyD6+mve7NH8MnikEPPhW05jetV4iViDRizR5AV+N4pOWqWxDL/n56x2h5iBXUaJVZLGevthQrsVdpzljt4+dD1E+hcxPL06yVIoZ1Bmb2zMRSDnrwqOCYX3Wb5yjWNT3S2Vis+ciG5o/hE8Wgh6BDLEesK3oIHdpoa0OMK1MRcoiaNs9RrCs6Y4W2mqnN5bwKFEvV6Km9SvoQ+grusRArK7Har4Yx56tMxApuNVOjC4oVYJam0TMVKwFXK5akV8nESu4VYs0IbrWyxFq3eq5inS+Fd/96jnoHWA5iBbeaqdEzEavLr6bVMxXr9O3n4e53+b/SQay8xPo6n6vqX+gYfqXTdnWdDI99MhTLvdmG7acL6pjr7dYfi4u1bPb0XiXrIG3E0neQNmId7psl9cj4DMQKb7Zu88VABHXQ9XbLj0XMavOrafZMxao7SGuxDB2ktVidUif1VuWLVS2fF6uDrrdbfIxYw9Jp93QWy/QrnVqsjz+aDtTT/Lw2PmmNqIoW1waIazWjMNmIpW92vR7vNduJ1XaQmjrea7G+/tmKdckzlmsLxDVbt7VxIMKE5XbV4uMLiDVvd4tYQWY5V0xRVY9t21Fb7T2W+rvjFYhlHIiwMGu6UC0/RqyWr2eXX6qe3Tqf07TXSxGxXFsgstm8dVjsJKqwIwaxDHpsK5buJOQXTVgsYxPEtVuEF90+4ko78df/aRve5lWQWa71UjDrx4oGsYJLO1GiWP33vSgkxHJtgchmi9Ci20VkcRf0Yhns2Fisz1x/V+jaApHtFqHFfjOxxpbPV6wkiItlaIK4douwYthDZHGHSoaI9f4ebpZjvVRkL5ZrE0S2W7gU4w5iy9srqRXLIMfGYh3OF8GoeW3baHmK5dBw4VKM8aMDWCu5Eqtv+mzFqoe6x42YaaMhVkwAayUX/Vj5i9X2NUTNa9tGSy7WPPv6JohsN9fmN4d3LtCtGlc75kInlt2rqgoxy6laavqf2DcjreKm86uExarG0QbG7UxNv6jtzrH4tAKG6M4F2lWT1Q6ZqDdei9W2vVWsuvSGYsW9abySFasbOGDdztj088qOZtmtMo1c0FTCMNRhHA/iKla3eZhYbWnEGtE0k2q9WYp1YO8RLtoCutpcRCybUyFijeXCKUes2YgU1XqzFevA3iNcrGItq2PYw0Isu1lRYr23YrmadWNiTUekKNebUAX2HuFiuRKuq2PYQ3vLtDogPZp7LDex3huvthBr+BeU1yMdiyfuTrgGDiFFWLdUeIn1ruDSYqUitVi2hghuuWABLJHTRNHm4jJivSNWcMOFC2COnCaKNhfrnnfECsLSDuENFy6AJXKaKLpU+Iil8srNrOsXy9YOl29+W+BrEOv9psXyHwHlGtgX9yr7xFHnArHSYGmH8IYLbn1L3JjQLqnwEEvtlYtZiBXecKGNb4sbE9olFYiVBFtDBLdcUMNbo4bFdhzh0G5iEGv5wDBYrPebF8u/Cd0Ch0YNCu44wqHbRN+PVS0e9+i8spuFWOEK+JZ0ixoSXPlkXZ8KrVjV8kEiYq1I2eryRNbfLNZq8+aBn0qRTqy1Rm89FrHUJSOacQOxwmZgyJTYA1AO2dBGmos1dcQqlsUsxMqM6ANQDdnQRtKLdWyuhDctltsX60JIewDLDK02WIi1ciShWG8FihU2A0OWpD2ERYLWG1jEMnllNktT0qvx5yBWFGkPYZGg9QaIpUfbHJP1xZD6EOYZWq9fivUuJtbbtYkV3ihbkPoYhtKaMH/92ySW2SuTWLqS/gYMbCJW2NQeGZL6IGYJUqyPEstg1hWIZWyQqjCx0h/ENEOK1Sux3oXEekOsLUl/EBViqaM5imVpEueBDW2fj3b17BND0GH1LLB9D7aj9GddgcXqSeMvp2PQeVVVNrO0RgZqUHNhscYMqYs3vdC214bM3jay3lj9ics8CuvXmBj3YD9Mf6rVwnTlP/4xfi2slj8V1OhRb+cr1tt1idU9N7P99n3xUojlxuvi6u0Uq+eBrXuwH6Y/JrGq3Vms3qxq9eNmtVjtdlcqlmNOCxPLkAe3A/al3e9Lw1svllKIt5eBWaGZXeqSsxAxKkSUVUSLEWt40m8Ra/G2kdXGmk/0QVdiue3BlAjHI/Zk4sjLm6NYL7NCWrOuWqzhSb/Zq8XbRtYbqz8xBB1WzwLb9mBKhLH64YyKnB1Ze6UU62VW6DbFKgtTIoR2OSqidkQp1hR3sV4QayPMmZDZ50QslSNWr7SnLPUJC7G2wJwJmX0i1hyZLG+MORMy+1yK9eYrlu5aqPYKsTbAkgmZnZrFcvBKI5bmhIVYG2BLhchOp2KtHXEVa20WYuWDLRUiO/3rf02OuIilPmVpvEKsDbClQmSniLVg3iK6UQTaJrQOYbCUDitpDGPPhXss9yrVYlXV1JF6iEM35qFzYlz/Mt24/6MvNPdqHAHRi1VvHKVCTOF1NGW4Wc/1bLzAekHRDDvrEAZL6bCS5jD2XLjHcq/SWaxq9oCmT84o1mT9y4vqj3aTuViTERC9V13gcBWCSyqjqcLNnrXNHutWqwV1M6wf180KWEuHlLSFseIRy7lKf/3Vrv6zY0zO/BPjH+vH1/Og88DBKoQWVEe7AbESJGloL98qJRRrvEIutitUrPl4gfXCGqVY8wK20n4lVecaIbEqv4OphyY3q7sLXzd0YfTk7a0d9NBf0vqNm+tdt92ff67Eell80pfMXKzFTcNuOl5gvaBsVNsQBktpv5LKi9i4XYosLd865n4w/TsmOrGaoQu72bCY3fR2afTqvflj8OhlJtbikz5MhFd0N6yx1DdpwjyrNrk1UvYrrLoNJj0LfYHaoynLv6dhIo4MsZZY6ps0X/5T08xF8fBqLLAwaS3WG2JJYKlv0nwhlmu06xDLVOGk+YoV601nhE6s9bXQdCVErIRYKpw0Xd6pMYtl9spZrDfEksBS4aTp8s7NrF/TVyz1tRCxLoSlxknT5Z2blVhvGiO0Yi1PWcYrIWIlxFLjpOnyzs3VivX13HbH6t7CahBrPUZBPbIhaOyBBv0wAm3gSY0Nq1Oirqx6DMgwKUgzPmEh1mSMQrfw/r42qx61MNhUVefFYQREO6BhOtQh4rC8xDrsntqF0+6HOppWrPUYBfXIhqCxBzoLVsX7T/SBJ1U2rU6IsrLqMSCDWO34hMUpaxyj0C8oxGqGOPRiNX8MIyCGAQ1j333EYfmI9fU86HS4+62MphNr/ShZ/QA66BGxToJV8f4T01ProcrG1QlRVVb9qH4QqxufsBCr6h8TDgtrsRSPpfvnhJO/BrMiDstHrM/Hp37xNL8YjhVSFpxmal5G7dJsE48KLlgX7z+JDCyBIjn9J/rj0IQwHJ5GrNk+kyTnImesqtKJNVsw/+EPYll2k4tY1eHbz3bh48HrHqtdtRyROPw1+1j/hz/r4v0n2Xm1rNIsXfrj0HxqOLx1fmel1s0UiF+Iz8fWZ/X5ymVGP7gRLj1VJMRQUH4RqyQKyi9ilURB+UWskigov4hVEgXlF7FKoqD8IlZJFJTf1GLBlYNYIMI2Yl1yBwTOOjBiEVgkMGIRWCQwYhFYJDBiEVgkMGIRWCQwYhFYJDBiEVgkMGIRWCRwOQ+foCgQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhGkxfr4D80Ey+Ecdrvdfb1w6hfS8drM/JU68EmqxjKBuzaLCy4s1uejbubuYA67H+dDva+P9+kcP6lZp2ZKudSBT+egHw8CNR7iJQ3ctVlkcFmxTvop4UNpD/Hw/dfXc71w6mevTBO7Fit14M/Hel5NgRp/Pdf/DA7ffiYN3LXZEDMwuKhYHw8/DqnF+niop24+Z7OdB1U3G2oQh7v/bk4uaQOf5jO3pgs8iJUycN9mQ8zA4NL3WMnFann9/qs1rD0dpOHjj5+vjVhpAx++/89jc5OSvMbtRerud+LAnVhdzMDgZYrV3me1B5zslqWebbwWK3Xgw+58yqovKMlrfG79Xf2OkMSBmzYbYgYGL1Ks4d49aTPVc9fLiFX/Yz9fEJPX+LUx9vsvxEoUc9de9dNeWM4Xwra7IfmlsLnHOrdP8ho39z3hVysdt3opfG3fENXfVD5ZNnfl0E7TM94Kpwp8GsVKHLg5l5wvsokDz27eQ2tdnlj9K8gEuhvaM1bqwG3LnNJ3NwxnrMSBD9l3N1QCYo3fewU6SNue99SB6xw07yFKHbi/x0oc+JB/B6mAWMMVq7BHOj/6hZSB62Skr3HXZlk/0oFbBbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERDLg9Ou56md5AG0IJYnp12q6a2uG8TyBLHcQCxPOrFe67mK/+vxfFE8tXMqNVMKJZwavHQQy5OpWN9/Va+7u9/NfOv1TKNJJ50vHMTyZCpWPxP2oZ51vnv9xMbVywbE8mQq1lM3N+fZp3aOznQT1xYPYnmiEevQ90NsXb9cQCxPjGcsGEAsTzRidXNuo1cPYnmiEauZGjv15OAlg1ie6MQaX/wKNYgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCP8PehLEdEpbJJMAAAAASUVORK5CYII=" width="60%" style="display: block; margin: auto;" /></p>
<p>Clearly the two models do not produce equivalent forecasts. We will
come back to scoring these forecasts in a moment.</p>
</div>
<div id="forecasting-with-newdata-in-mvgam" class="section level2">
<h2>Forecasting with <code>newdata</code> in <code>mvgam()</code></h2>
<p>The second way we can produce forecasts in <code>mvgam</code> is to
feed the testing data directly to the <code>mvgam()</code> function as
<code>newdata</code>. This will include the testing data as missing
observations so that they are automatically predicted from the posterior
predictive distribution using the <code>generated quantities</code>
block in <code>Stan</code>. As an example, we can refit
<code>mod2</code> but include the testing data for automatic
forecasts:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(y <span class="sc">~</span> <span class="fu">s</span>(season, <span class="at">bs =</span> <span class="st">&#39;cc&#39;</span>, <span class="at">k =</span> <span class="dv">8</span>) <span class="sc">+</span> </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                <span class="fu">gp</span>(time, <span class="at">by =</span> series, <span class="at">c =</span> <span class="dv">5</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">k =</span> <span class="dv">20</span>,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">FALSE</span>),</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>              <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">season =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">12.5</span>)),</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>              <span class="at">trend_model =</span> <span class="st">&#39;None&#39;</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>              <span class="at">data =</span> simdat<span class="sc">$</span>data_train,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>              <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test)</span></code></pre></div>
<p>Because the model already contains a forecast distribution, we do not
need to feed <code>newdata</code> to the <code>forecast()</code>
function:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>fc_mod2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod2)</span></code></pre></div>
<p>The forecasts will be nearly identical to those calculated
previously:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod2, <span class="at">series =</span> <span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#&gt; Out of sample DRPS:</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt; 10.8576175</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting posterior forecast distributions using mvgam and R" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="scoring-forecast-distributions" class="section level2">
<h2>Scoring forecast distributions</h2>
<p>A primary purpose of the <code>mvgam_forecast</code> class is to
readily allow forecast evaluations for each series in the data, using a
variety of possible scoring functions. See
<code>?mvgam::score.mvgam_forecast</code> to view the types of scores
that are available. A useful scoring metric is the <a href="https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-062713-085831" target="_blank">Continuous Rank Probability Score (CRPS)</a>. A CRPS
value is similar to what we might get if we calculated a weighted
absolute error using the full forecast distribution.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>crps_mod1 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod1, <span class="at">score =</span> <span class="st">&#39;crps&#39;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">str</span>(crps_mod1)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt;  $ series_1  :&#39;data.frame&#39;:  25 obs. of  5 variables:</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt;   ..$ score         : num [1:25] 0.1938 0.1366 1.355 NA 0.0348 ...</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 NA 1 1 1 1 1 1 ...</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type    : chr [1:25] &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; ...</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt;  $ series_2  :&#39;data.frame&#39;:  25 obs. of  5 variables:</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;   ..$ score         : num [1:25] 0.379 0.306 0.941 0.5 0.573 ...</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 1 1 1 1 1 1 NA ...</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type    : chr [1:25] &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; ...</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt;  $ series_3  :&#39;data.frame&#39;:  25 obs. of  5 variables:</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt;   ..$ score         : num [1:25] 0.32 0.556 0.379 0.362 0.219 ...</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type    : chr [1:25] &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; ...</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt;  $ all_series:&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt;   ..$ score       : num [1:25] 0.892 0.999 2.675 NA 0.827 ...</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon: int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type  : chr [1:25] &quot;sum_crps&quot; &quot;sum_crps&quot; &quot;sum_crps&quot; &quot;sum_crps&quot; ...</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>crps_mod1<span class="sc">$</span>series_1</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt;         score in_interval interval_width eval_horizon score_type</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt; 1  0.19375525           1            0.9            1       crps</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt; 2  0.13663925           1            0.9            2       crps</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt; 3  1.35502175           1            0.9            3       crps</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt; 4          NA          NA            0.9            4       crps</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; 5  0.03482775           1            0.9            5       crps</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="co">#&gt; 6  1.55416700           1            0.9            6       crps</span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt; 7  1.51028900           1            0.9            7       crps</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a><span class="co">#&gt; 8  0.62121225           1            0.9            8       crps</span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a><span class="co">#&gt; 9  0.62630125           1            0.9            9       crps</span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a><span class="co">#&gt; 10 0.59853100           1            0.9           10       crps</span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a><span class="co">#&gt; 11 1.30998625           1            0.9           11       crps</span></span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a><span class="co">#&gt; 12 2.04829775           1            0.9           12       crps</span></span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a><span class="co">#&gt; 13 0.61251800           1            0.9           13       crps</span></span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a><span class="co">#&gt; 14 0.14052300           1            0.9           14       crps</span></span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a><span class="co">#&gt; 15 0.65110800           1            0.9           15       crps</span></span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a><span class="co">#&gt; 16 0.07973125           1            0.9           16       crps</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a><span class="co">#&gt; 17 0.07675600           1            0.9           17       crps</span></span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a><span class="co">#&gt; 18 0.09382375           1            0.9           18       crps</span></span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a><span class="co">#&gt; 19 0.12356725           1            0.9           19       crps</span></span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a><span class="co">#&gt; 20         NA          NA            0.9           20       crps</span></span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a><span class="co">#&gt; 21 0.20173600           1            0.9           21       crps</span></span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a><span class="co">#&gt; 22 0.84066825           1            0.9           22       crps</span></span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a><span class="co">#&gt; 23         NA          NA            0.9           23       crps</span></span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a><span class="co">#&gt; 24 1.06489225           1            0.9           24       crps</span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a><span class="co">#&gt; 25 0.75528825           1            0.9           25       crps</span></span></code></pre></div>
<p>The returned list contains a <code>data.frame</code> for each series
in the data that shows the CRPS score for each evaluation in the testing
data, along with some other useful information about the fit of the
forecast distribution. In particular, we are given a logical value (1s
and 0s) telling us whether the true value was within a pre-specified
credible interval (i.e. the coverage of the forecast distribution). The
default interval width is 0.9, so we would hope that the values in the
<code>in_interval</code> column take a 1 approximately 90% of the time.
This value can be changed if you wish to compute different coverages,
say using a 60% interval:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>crps_mod1 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod1, <span class="at">score =</span> <span class="st">&#39;crps&#39;</span>, <span class="at">interval_width =</span> <span class="fl">0.6</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>crps_mod1<span class="sc">$</span>series_1</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt;         score in_interval interval_width eval_horizon score_type</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; 1  0.19375525           1            0.6            1       crps</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; 2  0.13663925           1            0.6            2       crps</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; 3  1.35502175           0            0.6            3       crps</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; 4          NA          NA            0.6            4       crps</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; 5  0.03482775           1            0.6            5       crps</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; 6  1.55416700           0            0.6            6       crps</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; 7  1.51028900           0            0.6            7       crps</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; 8  0.62121225           1            0.6            8       crps</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; 9  0.62630125           1            0.6            9       crps</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; 10 0.59853100           1            0.6           10       crps</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; 11 1.30998625           0            0.6           11       crps</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; 12 2.04829775           0            0.6           12       crps</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt; 13 0.61251800           1            0.6           13       crps</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; 14 0.14052300           1            0.6           14       crps</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; 15 0.65110800           1            0.6           15       crps</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; 16 0.07973125           1            0.6           16       crps</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; 17 0.07675600           1            0.6           17       crps</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; 18 0.09382375           1            0.6           18       crps</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; 19 0.12356725           1            0.6           19       crps</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; 20         NA          NA            0.6           20       crps</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; 21 0.20173600           1            0.6           21       crps</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt; 22 0.84066825           1            0.6           22       crps</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt; 23         NA          NA            0.6           23       crps</span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt; 24 1.06489225           1            0.6           24       crps</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt; 25 0.75528825           1            0.6           25       crps</span></span></code></pre></div>
<p>We can also compare forecasts against out of sample observations
using the <a href="https://link.springer.com/article/10.1007/s11222-016-9696-4" target="_blank">Expected Log Predictive Density (ELPD; also known as the
log score)</a>. The ELPD is a strictly proper scoring rule that can be
applied to any distributional forecast, but to compute it we need
predictions on the link scale rather than on the outcome scale. This is
where it is advantageous to change the type of prediction we can get
using the <code>forecast()</code> function:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>link_mod1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod1, <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test, <span class="at">type =</span> <span class="st">&#39;link&#39;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">score</span>(link_mod1, <span class="at">score =</span> <span class="st">&#39;elpd&#39;</span>)<span class="sc">$</span>series_1</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt;         score eval_horizon score_type</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt; 1  -0.5304414            1       elpd</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#&gt; 2  -0.4298955            2       elpd</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt; 3  -2.9617583            3       elpd</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="co">#&gt; 4          NA            4       elpd</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co">#&gt; 5  -0.2007644            5       elpd</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co">#&gt; 6  -3.3781408            6       elpd</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt; 7  -3.2729088            7       elpd</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co">#&gt; 8  -2.0363750            8       elpd</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt; 9  -2.0670612            9       elpd</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="co">#&gt; 10 -2.0844818           10       elpd</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="co">#&gt; 11 -3.0576463           11       elpd</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="co">#&gt; 12 -3.6291058           12       elpd</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="co">#&gt; 13 -2.1692669           13       elpd</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="co">#&gt; 14 -0.2960899           14       elpd</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="co">#&gt; 15 -2.3738851           15       elpd</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co">#&gt; 16 -0.2160804           16       elpd</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="co">#&gt; 17 -0.2036782           17       elpd</span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="co">#&gt; 18 -0.2115539           18       elpd</span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a><span class="co">#&gt; 19 -0.2235072           19       elpd</span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co">#&gt; 20         NA           20       elpd</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a><span class="co">#&gt; 21 -0.2413680           21       elpd</span></span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a><span class="co">#&gt; 22 -2.6791984           22       elpd</span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a><span class="co">#&gt; 23         NA           23       elpd</span></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a><span class="co">#&gt; 24 -2.6851981           24       elpd</span></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a><span class="co">#&gt; 25 -0.2836901           25       elpd</span></span></code></pre></div>
<p>Finally, when we have multiple time series it may also make sense to
use a multivariate proper scoring rule. <code>mvgam</code> offers two
such options: the Energy score and the Variogram score. The first
penalizes forecast distributions that are less well calibrated against
the truth, while the second penalizes forecasts that do not capture the
observed true correlation structure. Which score to use depends on your
goals, but both are very easy to compute:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>energy_mod2 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod2, <span class="at">score =</span> <span class="st">&#39;energy&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">str</span>(energy_mod2)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt;  $ series_1  :&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 NA 1 1 1 1 1 1 ...</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt;  $ series_2  :&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 1 1 1 1 1 1 NA ...</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt;  $ series_3  :&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt;  $ all_series:&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt;   ..$ score       : num [1:25] 0.773 1.147 1.226 NA 0.458 ...</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon: int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type  : chr [1:25] &quot;energy&quot; &quot;energy&quot; &quot;energy&quot; &quot;energy&quot; ...</span></span></code></pre></div>
<p>The returned object still provides information on interval coverage
for each individual series, but there is only a single score per horizon
now (which is provided in the <code>all_series</code> slot):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>energy_mod2<span class="sc">$</span>all_series</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co">#&gt;        score eval_horizon score_type</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; 1  0.7728517            1     energy</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt; 2  1.1469836            2     energy</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; 3  1.2258781            3     energy</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; 4         NA            4     energy</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt; 5  0.4577536            5     energy</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; 6  1.8094487            6     energy</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt; 7  1.4887317            7     energy</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt; 8  0.7651593            8     energy</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; 9  1.1180634            9     energy</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; 10        NA           10     energy</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; 11 1.5008324           11     energy</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; 12 3.2142460           12     energy</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; 13 1.6129732           13     energy</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; 14 1.2704438           14     energy</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; 15 1.1335958           15     energy</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; 16 1.8717420           16     energy</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; 17        NA           17     energy</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; 18 0.7953392           18     energy</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt; 19 0.9919119           19     energy</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; 20        NA           20     energy</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; 21 1.2461964           21     energy</span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; 22 1.5170615           22     energy</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co">#&gt; 23        NA           23     energy</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co">#&gt; 24 2.3824552           24     energy</span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="co">#&gt; 25 1.5314557           25     energy</span></span></code></pre></div>
<p>You can use your score(s) of choice to compare different models. For
example, we can compute and plot the difference in CRPS scores for each
series in data. Here, a negative value means the Gaussian Process model
(<code>mod2</code>) is better, while a positive value means the spline
model (<code>mod1</code>) is better.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>crps_mod1 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod1, <span class="at">score =</span> <span class="st">&#39;crps&#39;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>crps_mod2 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod2, <span class="at">score =</span> <span class="st">&#39;crps&#39;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>diff_scores <span class="ot">&lt;-</span> crps_mod2<span class="sc">$</span>series_1<span class="sc">$</span>score <span class="sc">-</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  crps_mod1<span class="sc">$</span>series_1<span class="sc">$</span>score</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="fu">plot</span>(diff_scores, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">1.25</span>, <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>, </span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>              <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Forecast horizon&#39;</span>,</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(CRPS[GP]<span class="sc">~-</span><span class="er">~</span>CRPS[spline]))</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>gp_better <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(diff_scores <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&#39;GP better in &#39;</span>, gp_better, <span class="st">&#39; of 25 evaluations&#39;</span>,</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>                    <span class="st">&#39;</span><span class="sc">\n</span><span class="st">Mean difference = &#39;</span>, </span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>                    <span class="fu">round</span>(<span class="fu">mean</span>(diff_scores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>diff_scores <span class="ot">&lt;-</span> crps_mod2<span class="sc">$</span>series_2<span class="sc">$</span>score <span class="sc">-</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  crps_mod1<span class="sc">$</span>series_2<span class="sc">$</span>score</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">plot</span>(diff_scores, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">1.25</span>, <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>, </span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>              <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Forecast horizon&#39;</span>,</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(CRPS[GP]<span class="sc">~-</span><span class="er">~</span>CRPS[spline]))</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>gp_better <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(diff_scores <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&#39;GP better in &#39;</span>, gp_better, <span class="st">&#39; of 25 evaluations&#39;</span>,</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>                    <span class="st">&#39;</span><span class="sc">\n</span><span class="st">Mean difference = &#39;</span>, </span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>                    <span class="fu">round</span>(<span class="fu">mean</span>(diff_scores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>diff_scores <span class="ot">&lt;-</span> crps_mod2<span class="sc">$</span>series_3<span class="sc">$</span>score <span class="sc">-</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  crps_mod1<span class="sc">$</span>series_3<span class="sc">$</span>score</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="fu">plot</span>(diff_scores, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">1.25</span>, <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>, </span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>              <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&#39;l&#39;</span>,</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Forecast horizon&#39;</span>,</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(CRPS[GP]<span class="sc">~-</span><span class="er">~</span>CRPS[spline]))</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>gp_better <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(diff_scores <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&#39;GP better in &#39;</span>, gp_better, <span class="st">&#39; of 25 evaluations&#39;</span>,</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>                    <span class="st">&#39;</span><span class="sc">\n</span><span class="st">Mean difference = &#39;</span>, </span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>                    <span class="fu">round</span>(<span class="fu">mean</span>(diff_scores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAAz1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmZjpmkJBmkLZmtttmtv+LAACQOgCQOjqQZjqQZpCQkDqQkGaQttuQ27aQ29uQ2/+2ZgC2Zjq2Zma2kDq2kGa2ttu227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb25Db29vb/7bb/9vb////tmb/tpD/25D/27b/29v//7b//9v///9YDzcsAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAV/UlEQVR4nO2di5rjtnlAMeudjOx16s3IXrf2rOI2mwydpK5b03bqDqutpPd/phIXguBNEkn8okid8+23I/HyExKPABAEQHUAEEBNnQBYJogFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCDCbMT6+N1nSqk337zoN4myfP7s1yfq1U+tO26/Cf+0s9907P3x6/woX/zo3qXq/qUjdfl2d0/NnTKbzocjxz4vIRb9IU5sci3MRazUqaRe6xNWiKVUcTI7xUrtWU2Pntyuk+W8uLP+blddYuX7+60qOyVRxTIfArFi4r1S5twmlXeGDrFyGR7KPz3ZrbUev7p9P65Vl1j5hn5NuFMuQVce185Ra4Z9iImYh1j5V2rKlv33NpNKbH6Qn70imxARa/v1ymcR+7+vVKdYYfhwp1yyfodFrMuSZ1iP7tXnHw5eLP/XvHz1X9/l+pkz/zF/dfeNz9oekqJA8iv0rn9+p17Z3e35zBf9Jdfnkw/Vg+cr86Ok1QxS8+s7pT4JjtLcKVfhqRosSJlJemp+KDqSqTD6hDx7j/w6d5TCPX/0arp/zquid75WOB2zEKvxO27NsSx6Q53BWQtqYpUr3BonSnE+1WdBlaog3ylfmarXP6wrYn2vakdp20m9cdVCv9jtk5nfij1wWStrilWuq4pVHr2S7qT8FqZlFmLt1rUyqLWOpe5/3Cf6dOmv/sfDL+bMVYrCcEW+Zf76v+3OXqxXLkSArpjn+/789qWajMwc8G/hURo7JZXKfyUBNpgpK21NLC2SXhErWBd8iJ8qRw/SbaOmtY8wBXMSy1x7hScszFwSU6aYLfMT8FhUnCtihSsq/nixnpqSJP4oVbHs2bd7NsSyO+2/W702HhW7hQlI9RZZeV1beFQvCv26iljh0YN05//dfYjzpY9k1mKFdQlbeTffdFZoV57ySrGiyrPhOCJWUhZyFbGKN6mrS9VlDBaUNcFayh79Jcf+1+9WqkOsYl0oVuXoQbrtV2SrXtMyC7FsTbgiVq0e5K8Kk/PFCkJ0ZBQHW5V5cKepQ6z8rNbECncqNjGECdD51m9rk21u3yn3yZoJKde1i5WHbtn8rnbNcHlmIZb+/tyJs19fq1i+bMiCUq4u1mN1e0enWGlYjTs3x6rsVGxiCBOgF//JrNEtX1/8+z9ai8Jg3ZEcK0z3xz99pjrbRS7HPMTSF1P3uh3r16+7c6ywjvUQ7FmpYz2U258hljluw6Vil446VrmTbdIKmtga25kNrW5ZPccyC4J1oViVozfSvXs3/WXhPMQKW97tdVCbWK/Kq0L1ra4zP9TEClecI5bePjhD510VBjuFx2tZkNgPY7R5+bgpxUrNgrUTq1h35KrQp9tsftjWr6InYCZiHX5eOa1efzh0FYWfFS04rrVIv8xlULZECdqx9IpzxNoWB7Wb7rrasRq5XLFTZl+//qm20oqXucAmcWEdy4d4CNe5D9HWjlWmu7hepo51Lv/3d+2NaXfvqrxXW97dy//Nd3vr/5QrzhHL55OtYh10ufzJt/pVKFZlJ9Pr4W2wU5Cy8obPx3e6FTWxRZz5ZbzL97IVq3Kd+xC+5d0fvZLuX8zXRMs7LBTEAhEQC0RALBABsUAExAIREAtEQCwQYXliJf4WbPmqB6YV1DVCukFdlbFdYuy/X7le0wW6rdM2dVZHoc2CZYpV3ikZI5Yb1FUZ2yVG2SeoIPXt95UbQTNhmWLZXk5HhtV0E9y3cS8bHaNFyPTt6TS4yWf6NaRFv8Zvr6K/cQ8WKpb+4ad6IMMYsUYNHeuJ7a4cDhcztwe3X/7Lj+VQssm7LPRgkWL908oUZHf/bMUqx3yVY6naxnrt8+1+/4MvCs8YOlZZVIYzYxDtDeLg2Brfb6FetlqlggGugUcDxyhOyyLF+sMmL1F261f/ptx4iqKDSTD6vTnWy/dQaRerZehYdVEZzvVdeRsO97J0ihX2tSoW/O57V2NP68XkDFikWI9JXh3J1ENWSOKGXIVjqZpjvUz3Ol2HLirvp4aONRa5cHmgP+h+eqbe77cwnBCr2tm0rLGb3mh3317k+4vEMsXS08LkcmWqNhjM4HvEPdW7i7pOgq1itQwdqy0KRsroQOkX/3FoHLsTL1YhnBbr8fCzKYT3tlff2xlVsZYp1tN2dfeXvDg0YoUjY4KxVA2xwmvAFrFaho41FxXjHwqPqsduxTYz3P+jJceyLR62B+KHMN+bA8sUKz+3ugLfECsYS9UcgdBHLJOvNBedFKtZFFbEqtaxbN3NDMmprpsDyxTLnC1TChqxil96OJZqgFj1oWPNRS1iVXOZTrF+67gq1GI1isk5sEyxTKv1g/3VB+6EY6nahuScqGPVh441F4V1rOzzD80msM7Ke7NJIfFFYeOKcQ4sUaw7MyeCHaBsJCmGXIVjqZqDCNNibddVYX3oWHOR3dQHemqM/+omaFIo/X/5pT6cbTYsVKztyv1ftmPZDKG7jlXcresQq23oWGNR6aBrvTr/Ll9wr9AVoLY17HV1ONtsWKhYlbsg5ZCrYCxVy3h63fL++Q8ddazWoWP1RW5T2/Ju2tvD4V7HKXs3FDUz3Xr1NhjORu8GAMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0SILBaeggWxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0QYYkLW/URGxAILYoEIfUzwT77tfowsYoGllwnblfGpmWOVwsVLGcyaniYk5vnqFIVwir4m6EwLseAk/U1I1BvEglMMMGG3Riw4BQ2kIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIEJpwn6j7n/78jlWOLhtvAn7zeP29y/Z/UuccHDjeBN2X/2Ui5X/Hycc3Di1HCslx4IoVOpYSo30CrHAwVUhiIBYIEJpQnbsyan9w8FtU14Vrp9ihoMbJ2xuiBkObpzShOQxaji4bYKikDoWxIOrQhABsUAEZ8Luq/+kKISI9DMhzdUzrRJph4CIBZZeJmidtquHA2LBKYqi0BaEx4vC/ebJbHr/glhwgj4muMZ5bVZNLOWJmjiYL31MsDmW/vtAjgXHqfXHeji6caHTdtVVZCIWWMIepPn/6XGzMvXoNkYsOErtJjR93iEOpQkmszqRY/UIB7dN/Sb0yLZ3xAIL9wpBBMQCERALRAgq7/cvqbvFHCMc3DZl5f3L5/zf9lOaGyAGYTtWnmchFsQhKArV3XNGUQhxoPIOIiAWiKBsl9BM5QVhlHAAGrVdPWqvng6j61cm3PgQsAhUoqfESvQNwmTkDWgTbnwIWARKd8Pab44NkOgVbnyKYBGo9aPu2WA6+SEWRMOItV3p6lUydp7IA2JBgdI1q1RfEe7W1LEgGiq7e95v8ryqsxt7v3DjQ8AiULoJK/cqOzFA5+xwABpa3kEExAIRVDmDTJxwABqlrwjNbZ044SLFgbmj7ADoCE1YNlycMDB7TAPpIYvR1GDCxQkDs8eJFaXPzAGxoACxQATEAhEQC0RQ63KaR7rNQDRCE/6KWBAL0/JusqrdmhzrOO/fv586CfNBd5sxXfxyvyI0vy9YrPeWqZMxF5Tu7r5bP6UM/zoBYvXCXBXuN2/idMdasFjv32NWH5R5KEASoxg04eKEuUIQqx9OLG5CnwKx+uHEilMQLlks6lj9QKxzQaxeINb5oFUPuKUDIjCYAkRALBBBualmIo2nQKyzuIHamjJP4j24J/KODzc+xPK5ietL5dtG7VxGY8OND7F8bkOsjdcpxhgwxDrNbbTh23YsQ4wxYNHEWvD3fitilTnW9Yi16G/+RsQqG92vaEa/wd/8LE7XLXilp+N2ZaF/MSrc+BCH4b/pmZyxmSRzHKp4Mn0apUtWQ6yh+c6SxZpJxjoOpfuP6huFZ92GtpseuatYE2vgmR4oVtzKyw2cfEl6lV1pMZFW1pW9xRFr4H4xxZpN5net9BFrf7rNy/eUMO/yM1N5H2xw6n1xWsv19ffN/d+POF7r8fMjxoq3mPeHM+kj1q6zzUs1MIvL86zqG55673KL8H3oTXv8Hsd7f/r4zeP1SP9i3x/OJHaOVXkXsWxqCdRcdNbR+mxEWTiYfnWsYuxhZ1+IYXWs05u0nei24C2R2nU8cUTEGku/hqed62/a2ZQ6RKyBJ7qXIX13o/I+FumOfuflV5OL1QiDWCNxJuy+ijMJ6QBPBwpy3n7dQh4PfqAdayQTiNV+VnuLNTKn6xtJmqmPH5uLizW00jOstGoN3lIOTm3W5AmIzvRijfhSz9hrsH2XZfIEROfSYp1XNsXjGsQ6KzdemllXIJZw/SJStjbm+JOrPQFXIdbUIFZ8rqCOdQ2IloPnmyWUhilwJuz/Nc4EWXMVayjNT1JfMlyseX9LEwyxn/cXFtLUoXNJ79aUuf8AmbthBOeINbIX7eg0TgViDaeZGbVlT8MMac/oZmQaYg3nPLGG6RBP0YlArOGcK1ac2DMVa7uK8sjxmxIr6u2ps2PPxKyiuWHzdNh+ejVD7GcCYnUTNJDu/zj+oSe3JdY57VjxYs9XrM34svDWxLooc/IKsWbELMUqZuUeOZURYokyG61obpg91+oaYs2a6y0dvQnpg3+Ib4xwcBGuXyw9Zj591HpFCQcX4YpbIIrK+5fPBy3W2EZSxLooMxDL9SAd25MUsS7K9YtVtGFlIye4RazLcrVeeRMycws6G/soe8S6LNcvlp1edPRM74h1aa5TK9qxFsh1qIZYC+NaCkd12K4edBVLja1euXAwLVcjlpn1UVfdM3qQLoCraYCwzytMdK09xqPsEWtirkcsPROyfXrvFT39C4ZyPWLpx8rZh6si1hK4Eq+sWPbBX1f0WDkYzNWIpWtWZv723Zo61iK4Bq1yE7K75/0mz6v2mwglIWJdJxO4pp9XqJ8HkJ33XLnT4eDqmKR0pOV9+SAWSDBNC4TSPd1jtLkX4eDamEgsfUXY+TCv/uEixYF4TCSWeQZh1+MH+4eLEwZiMk0dyzS6ZzGaGky4OGEgJlOKFaXPzAGxrpQp2rEQCyRALBABsUAEVcxfdNYYHd/m1dXFBrHAEprw11NiaZ1MF3nEghMoP8fMbn0qx7LDpXdrPX8IYsFRdLcZ08Uv9+tU8/tu/WT/3L8gFhxH6e7uuTHpGcO/igke9psHxILjmKvC/ebNWd2xCp22q66KPmKBRZniLTlZDFoyt129u2l5ZRk9gTBPnFjchIa4OLGi9Es+IBYUDBDLDhbrCDc6QbAMEAtE6HdLx4BYcJoBJiAWnAaxbhPxrn/KTTUTaTwFYs2CC3RWVuae8sHdWx4fbnwIkOcSYvm2UTuX0dhw40OAOJcYEGaHfxlijAFDrDlwEbHWviYeYwwYYs2By4hV5liIdStcpI7lG92Z0e9muIRYvlXqWPPU+eHGh4BLcIF2LNfHKj2zS9apcAAa5R7PFGdCP8QCBxOvgQiIBSIgFoiAWCACYoEjbgsEYoEhdpspYoEBsUCC6PelEQs0iAUiIBbIQB0LREAsEIJ2LJgBiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFogwxIQjj7BALLAgFojQx4Td6cf8IhZYepmwXRmfyLHgJD1NSPTzKxALTtLXBJ1pIRacpL8JiXrTEKuse8VJFcyeASbs1uRYcAoaSEGEASYce7AhYoEFsUAExAIREAtEQCwQgatCEAGxQATEAhEQC0RALBABsUAExAIREAs6GfPYJsSCDsY9aA6xoAPEAglGPswXsaAdxAIREAtkoI4FIiAWCEE7FlwdiAUiIBaIgFggAmKBCIgFIiAWiBBbLFg4E4kliWhSCR45NmIRXCQ2YhFcJDZiEVwkNmIRXCQ2YhFcJDZiEVwkNmIRXCQ2YhFcJPaMxII5gVggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIMBOxdms99OhBJPb2U/Ps9EzkADa4SPLTIqRAyovYwxM+E7Gyu2ep0Lv1K33uM/WUv4xtVhFcIPmpeswT/SCS8jL24ITPRKzUnB8J8p+7jr3f6DMTWwAXXCL5VqU8sEDKfewRCZ+JWIlMKagfF/tovrz876H4P3pwieTb59ymd88CKfexRyR8HmLtN2/yoj7qSS9xYunvcreOfYzUZodSyU9e/SSVch17RMLnIZbJm22eHx9z7nVF5SBQyTLBxZJv60JCKc9jj0j4PMSyCNXg5cWyxE++r7sLpDwrrwUHJXxWYpmvMDryRaElevJTZWtXEilPgwJwUMIR61CpvMc+gqBYiT33IilPworVgsVylykybQ6pXHNDJTuMnPzUnW6JlBexRyR8HmKZL2+/kbksTAUbSANrIye/bF+In3Ife0TC5yGWzpuVTEHof5Ayt3Rc8PjJT+0Eezqjip7yIPbghM9FLJgZiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFhmegLlZqHtSxrOntEa/P5lcMJmDWLpuTaH7uqnO5OaxnK+IBZiiYBYoVipmyM4+d1GT+JTvNUv7MRmutjUhVtmys7tqihB95t8D7OmFiMvCjNb1D75VfvNY+I2Xi6IFYiV5PaYScfsTIlp8Va/MBNd6RqTzpz0THf7zf1LkGMVs5/VYrg6lt7Yryo3XjCI5SrvuTd2Ijszb345LWkulHFAO+RnTsyci4FYWqDcolqMQiyvm17lN57gw14MxCpzLDuPp7bHnHT/Npw4Ns9tbBloFtXqWLrcq8Zw/5vpYf0qv/HFPuIEIFanWG7CRBWIlWirdKGo/TLl2VlibVcPB8S6OWpi6dwlyLEOwVTXmXKFo36ja0pdYvkYrlYWPAIsX4VYt4EXK6gf2XxGv8118A/+MGo4TYxvTbFqMcz/iTU0qGMh1i1Qvyp8KE66fmuk0p5kxbo0Lw2NYalWri5WI4Zubnishkes26CtHcuedP8M06IdSzdJ3f/iWriMXL4dy7tSjZHc/8/G3zLy7ViIBTAMxAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBABsUAExAIREAtEQCwQAbFABMQCERALREAsEAGxQATEAhEQC0RALBDh/wERfxtGQaIA3gAAAABJRU5ErkJggg==" width="60%" style="display: block; margin: auto;" /></p>
<p>The GP model consistently gives better forecasts, and the difference
between scores grows quickly as the forecast horizon increases. This is
not unexpected given the way that splines linearly extrapolate outside
the range of training data</p>
</div>
<div id="further-reading" class="section level2">
<h2>Further reading</h2>
<p>The following papers and resources offer useful material about
Bayesian forecasting and proper scoring rules:</p>
<p>Hyndman, Rob J., and George Athanasopoulos. <a href="https://otexts.com/fpp3/distaccuracy.html">Forecasting: principles
and practice</a>. <em>OTexts</em>, 2018.</p>
<p>Gneiting, Tilmann, and Adrian E. Raftery. <a href="https://www.tandfonline.com/doi/abs/10.1198/016214506000001437">Strictly
proper scoring rules, prediction, and estimation</a> <em>Journal of the
American statistical Association</em> 102.477 (2007) 359-378.</p>
<p>Simonis, Juniper L., Ethan P. White, and SK Morgan Ernest. <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecy.3431">Evaluating
probabilistic ecological forecasts</a> <em>Ecology</em> 102.8 (2021)
e03431.</p>
</div>
<div id="interested-in-contributing" class="section level2">
<h2>Interested in contributing?</h2>
<p>I’m actively seeking PhD students and other researchers to work in
the areas of ecological forecasting, multivariate model evaluation and
development of <code>mvgam</code>. Please reach out if you are
interested (n.clark’at’uq.edu.au)</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
