<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Nicholas J Clark" />

<meta name="date" content="2024-09-04" />

<title>Time-varying effects in mvgam</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Time-varying effects in mvgam</h1>
<h4 class="author">Nicholas J Clark</h4>
<h4 class="date">2024-09-04</h4>


<div id="TOC">
<ul>
<li><a href="#time-varying-effects" id="toc-time-varying-effects">Time-varying effects</a>
<ul>
<li><a href="#simulating-time-varying-effects" id="toc-simulating-time-varying-effects">Simulating time-varying
effects</a></li>
<li><a href="#the-dynamic-function" id="toc-the-dynamic-function">The
<code>dynamic()</code> function</a></li>
</ul></li>
<li><a href="#salmon-survival-example" id="toc-salmon-survival-example">Salmon survival example</a>
<ul>
<li><a href="#a-state-space-beta-regression" id="toc-a-state-space-beta-regression">A State-Space Beta
regression</a></li>
<li><a href="#including-time-varying-upwelling-effects" id="toc-including-time-varying-upwelling-effects">Including time-varying
upwelling effects</a></li>
<li><a href="#comparing-model-predictive-performances" id="toc-comparing-model-predictive-performances">Comparing model
predictive performances</a></li>
</ul></li>
<li><a href="#further-reading" id="toc-further-reading">Further
reading</a></li>
<li><a href="#interested-in-contributing" id="toc-interested-in-contributing">Interested in contributing?</a></li>
</ul>
</div>

<p>The purpose of this vignette is to show how the <code>mvgam</code>
package can be used to estimate and forecast regression coefficients
that vary through time.</p>
<div id="time-varying-effects" class="section level2">
<h2>Time-varying effects</h2>
<p>Dynamic fixed-effect coefficients (often referred to as dynamic
linear models) can be readily incorporated into GAMs / DGAMs. In
<code>mvgam</code>, the <code>dynamic()</code> formula wrapper offers a
convenient interface to set these up. The plan is to incorporate a range
of dynamic options (such as random walk, AR1 etc…) but for the moment
only low-rank Gaussian Process (GP) smooths are allowed (making use
either of the <code>gp</code> basis in <code>mgcv</code> of of Hilbert
space approximate GPs). These are advantageous over splines or random
walk effects for several reasons. First, GPs will force the time-varying
effect to be smooth. This often makes sense in reality, where we would
not expect a regression coefficient to change rapidly from one time
point to the next. Second, GPs provide information on the ‘global’
dynamics of a time-varying effect through their length-scale parameters.
This means we can use them to provide accurate forecasts of how an
effect is expected to change in the future, something that we couldn’t
do well if we used splines to estimate the effect. An example below
illustrates.</p>
<div id="simulating-time-varying-effects" class="section level3">
<h3>Simulating time-varying effects</h3>
<p>Simulate a time-varying coefficient using a squared exponential
Gaussian Process function with length scale <span class="math inline">\(\rho\)</span>=10. We will do this using an
internal function from <code>mvgam</code> (the <code>sim_gp</code>
function):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1111</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>beta_temp <span class="ot">&lt;-</span> mvgam<span class="sc">:::</span><span class="fu">sim_gp</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>),</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                            <span class="at">alpha_gp =</span> <span class="fl">0.75</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>                            <span class="at">rho_gp =</span> <span class="dv">10</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                            <span class="at">h =</span> N) <span class="sc">+</span> <span class="fl">0.5</span></span></code></pre></div>
<p>A plot of the time-varying coefficient shows that it changes smoothly
through time:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">plot</span>(beta_temp, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&#39;l&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Coefficient&#39;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">box</span>(<span class="at">bty =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Simulating time-varying effects in mvgam and R" width="60%" style="display: block; margin: auto;" /></p>
<p>Next we need to simulate the values of the covariate, which we will
call <code>temp</code> (to represent <span class="math inline">\(temperature\)</span>). In this case we just use a
standard normal distribution to simulate this covariate:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Finally, simulate the outcome variable, which is a Gaussian
observation process (with observation error) over the time-varying
effect of <span class="math inline">\(temperature\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> <span class="dv">4</span> <span class="sc">+</span> beta_temp <span class="sc">*</span> temp,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>             <span class="at">sd =</span> <span class="fl">0.25</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(temp)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">plot</span>(out,  <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&#39;l&#39;</span>, <span class="at">xlab =</span> <span class="st">&#39;Time&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Outcome&#39;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">box</span>(<span class="at">bty =</span> <span class="st">&#39;l&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAAWlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZmY6kNtmAABmADpmtrZmtv+LAACQOgCQOjqQ2/+2ZgC2///bkDrb2//b/9vb////tmb/25D//7b//9v////KNxGdAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAWz0lEQVR4nO2dCXejvJJA3dv73nRmmrxOe6adRP//b45XVKUFJKDYfO85nbYBqUqla4yJAwcHYMBh6QRgnyAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSZMK9YBT+EGYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQm7FKtZOgHYpVhNg1mLg1hgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYUGfC8XD4/vl6OBx+ZXpDLLhRZcLxu3Nvh/OPz9ef6d4QC27UmPD5et5Rnb78Pj88ffub7A2x4EaNCR8vZ7He//lzfnj6+kf10jJtdsNArBXAHgtM4BgLTKgz4Y1PhVAG57HABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHAhJ2KhVlLg1hgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGDCE4iFZEuwf7HYfS0CYoEJiAUm7F4sjuSXAbHABMQCExALTEAsMAGxwATEAhPqrpqcvqSt6G11YjWItQx1Yv3Xj/RFbdveEAtu1In10x0vF03O97YGsRrEWgG1Yjl3OsRureoGAoi1BurFcle39J0p2t4QC24MEivfG2LBDcQCE3Z4Hgux1gBigQmIBSYg1gwsnsACIJY9y2eQwTItxLJn+QzSmOaFWPYsn0EaxKoDsQpBrDoQqxDEqgOxCkGsOhCrEMSqA7EKQaw6EKsQxKoDsQpBrDoQqxDEqgOxCkGsOhCrEMSqA7EKQaw6EKuXWz6mpUEse5bPIOCeEGLVgVh9INYgEKsPxBoEYvWBWIOQLjXNCsxaPIEQxBpEINby87p4AiG3hGxfcohlz+IJhCDWIBCrD8QaBGL1gViD6BRriSle/uNDAGINokusJaZ4BZ9LAxBrEIjVB2INArH6QKxBIFYPzfrEOh5+ufcfh8OX35netiqW5cQjVi/Hr3/c+7/OUn2+/kr3tlGxTGcesfr4eDnr9Ha9FvcpfY8KxOrJZxWsUqzP1+sFbk/6ctyrvc47YiVYnVju7SzVcRt7rKZ9jFgh6xPrcpem6y7rlDl6R6xcPnbd17M+sa73pLiQu58OYuXyseu+njWK1dcbYmXyseu+HsQaBmL1gFjDQKwe7gkhViWI1QNiDQOxepBimSX2fGKlSolYk4NYj81s85myv9EdzCzWx8vh2/+99t2SsLs3xMrkM2l343uYU6zTl9/Hb3/fe+5T39MbYmXymbS78T3MKNblVzVnsa7/hve2XbHszHpysS735b2Klb6NeGFviJXJZ9Luxvcw6x7r+1WsN/ZYFvlM2t3gpm0Psx5jHX6dxbp8+XhEb4iVyWfS7ka2XOBTYf7b7IW9LSqWfEGmxcqVErEmZ0fnsVTdECvfErHqQKzClohVB2IVtpxZrOsh1pmtnm5otitWVfCtifX5OuY8w6O3bYplWuH+3uuiD071EaaZV6zLCdLxvSFWfe+V0bcm1ue4Xz/fe0Os+t7XJNZ0VfAmXP92fmxviFXf+0JiNQmxJizDbg7efZX2L9awXGOxIpEsxNr6wbvXqV+ssHqGYjWLi6UG38ZLijVlGXZz8F4hVnxkYSZW+56TXjskemWufuuFxNr6wfsGxZL5VnW5KbHc+48x32u494ZYUc/PLtbj2H3TB++IlQvilttjTdIbYkU9TyxWba4VYk1ahicUKy4fYg3quhNhwuWqtdv9ot9mxUol1N3jMLHaOBVijSiK/Gry5WPhZr+ajFj5DHzDOrHGVEX9McWFrf4xBWLlM/ANFxDrcYJ0q3/+hVj5DHzDWKxGbrnQHuvm3qnjlMTWxJI1t0pqzWIpdYzEKjjGuop1vWry9Yrvqd62JdbjwQxipbofJ1Zhk0KxGjux+j8VXsS6K7W+y3E/m1iFbdRg82Kl85xIrF4uYt2/tbW+GwgkxfIVlButSKzkjqK3yz2K9fmfm1jb2GPp3X23WBZmIdaFy2H7qes01u3XibdjrPRXIRArlVSm9+ZJxLqdZ+i5PtbZrfNRWPYIH7FSSWXud/4kYrXnsTZ9gjQ4Gt6OWMXRtyvW5CdITQ6L4yjt/GXFatYqVs0MCh1LN5e5uD6xGt24NK0I+1/p2ExZMky3WI1Ap/b0YrULDMQy+yX0s4iV+9z39GLdPvSNeSN8arHy7qxTLB/cWYs1AYgVLVyxWO4pxBr9ToRYuc1lLm52sT7++/Zbwsk/FZZlN8nEIlZyc5mLE58AXY9Yo4rypGKJ1W6zYhXWdYxYpVnF3Ez4fPW/Rp76zhSTipXfqEIs1ywrlpxpl1jfF2dDYjm/xxqFtVgdW21HLBVVp1gWx0asfKKDWMnBe3mZujp4GrE6vpaa2lym0iWWsxDL7C+hZxPLFYnl9BK5ZhTFYjXNUmL5+swp1p3TqDOkGbH68iutk5+T1KpCsZyZWFEPDWJ53r4P76xTrM7j7jqxEn7ZiqXWpbetEsvP5kCxil8K6xHL4nSDGIJaI7YYIlYwXdViNfGabFydRMah5MLViiVGti+x2iVPJZbKYgmxHlFnFuvjZeK3wsfIJhRLVcX38Vgxt1jCktTYVyhW+BL1/RmI9fhUOOpKpIPEKq+TH32wdxcVmkmsYF+JWCHm57E6xZL7YWuxRJBKsfTKhChimHG+jXjnCbPIi9W0PzJ9IpaWIVjTblFSJzH6ViNzsUS8NgtRcpFLh1i+gWjdJVZGN1mtomnXY15GrLfH33aNoEYsOeTBYmmFpFi+bqPEus9HRizfp9hGbdonVmI+w8Tl4u2Jdbo59Tbqm8k9YjWpFSZiibkLxBIbG4kltlUT5kPq9BuXmMKEWI1IZjtitZdMPo26pN9axUq9QxaLpddKNUSoHrFUQtF0psXSOT1CTS5WIzOZXKz2b3Mef6wzsLdasWSBS8UKGz7WOV+0aB5ls9FiqR62LZZ46ZmIJf5kfuo/WO0Vq7tQTdxiYrEa1U8q+6xYjQ8lJ3CgWE0irFpULJZ6386JJYZjKVZ7aDXqt9ADxXIuHJPYKGgwtVi+09SAesVS7yZtp0FrFVKn5RckhhrMssi3U6woA3l8NrdYfo+1iFiuTCzxmnW+1n7DoHp1YiV3mP1iiblpOw1aq5Aums0asRSJhIOi+U3bWs8q1pLHWF1iqUahWHLatFhObVckVqaK8SRGStWI1egWTjTqESuWyg8mkXTc0UJiWX8qDMrUrphGLDV9atamE6sRWWTFCl5Boqn86XeqjV+QFis25BFM9RUlHTVbSqz7H9ibncfSVfIrFhcrXdIgyeBUuxPz4YK5UQMVT+VPPRT5/PJQZxYk4scrhtiGi4vmG8my+G3txTI+8y4LIMafEUvXRTxZnVjOBXOjZ9o/lT9Vt4FYIuNw8Hq88c5Udh41C8WSRTUWawpKxNKzmhJLlkoXaYRYcg50ComSyuSD2RDzL6wYLpYaGmLleisTK3Lgvtw3EW3lLKlqho/CTuVSPQdNhVjhbIj5991MIFbju4nFCjUSw1fVkgVWGYhB6oGqcEuLlT/VNZlYst5+qV8kKmsulj7J5gONEMvvddWGObGizuXw1EbqQdiyRiyV7RDmESuqUkas4CUXzpJf5Csra6w6VdMQpRCklq6ij55Io10bBExMq2oW9S039MlEJVOLGl+coK7TiJUtSTF1l+P2f4ifdmuAWEH1Ho9EQ99R1FpOx/RiieiJNKJJCKMMFitdsrBzuetX2aYy0GXTY0yIlS1JOVV7rPcfV5/iPVbHDQTCmoRjlHMnt/CV9h25tmqpSXAWYqngQRpyV5tKOcxMySQfJ8QK1RXrgx7URupBbKRKzw8nqkK2JOVUvhW+XU53DXsrVFOipkNu6QIP7tu6tFjqqNaJ+U4t9bHkDAQlDVKXo3Bx23aJHI3aVOSgYzThE410oF2UVFOuSoilSqHS88OJqpAtSTm1x1iXndZkYsnpicVyasxypayQrJvq3S9VE3bfyunlfWJpW5zK/JGL/CdXiOkvEMv5/9KxItllO731ULFECoOpP3h/O/zbXCynF4ZFXlCsMJDzudy6CRyUmekYQe8qE92TjpURSxYqziAqm8oirIIu+TAGfCr8eBkvlpp/uaVzUfmVFFGFEqsnEktOoguahpMt5yGeVvHERT2mMknlGeWkx9wGkzXVCyvFapqoJBXMc4JUFN6P1amSBfuyqLmsoqlYcuJUHuH/cvqa+z5GtWuHKp7IyiRHeXuqetKZ24kVPNUb1jKbWOLVUCOWa1QDe7FUPiqN8H85fXJbFUZmln9viYxQQXXmNmKJauopGsqKxHp8qyoaeVqsyBonOlRLRb2LxAr3PPKJ3CwjltpWZjZCrNw3F1TjeF/ja+cHGZVXLX48jJOpZF6xGqezTk5JNPJHxdruZEtdy2SFxbSViXVtFInViKZziiWXBo91Y13ux9ZBJfYiVmqCu8UKBhQUN2qpp0RoEseVnTgXTGeygyiPcrHka0gMLVM4nV809iiNOJVgTCIRXYkdiRXsbqL9TyxW2MFUYgWH143cKtlBlEexWGqCMkPTvSem0tsQphGnEozJbxFUolAsn/hAZhXr8SjyINha99CuET0MFEuEUU0HiuVXhaNoHiORmQ0RS7xJqzqEqeSelIjViMXtwzibOtYv1mOV32QGseJpFlMjRhI9Fv2m9tZ1Yvn9iV6iSxK65I8mdCmS9ZUihc83JJZ/DYpqx1t3hQgMshErNc1qs866h2KJhR2jKhMrfV1fXWG9e30OsZyf6vszY7GcS8zaNUxWrI5Z9ksXEyvTNvrrCPn4GcTyf4Xy+H8ZsZRAj8I2nWIpN7rrHvQbNu5sEA62d4J1u3qxmqCJqGBn3G5mF6tdev9/RWI14fI4dKFYOpOocXrrhEIF9YhSeQikjjt0sTry1FXrDtzJk4gV7DW7xMruPjYi1qOd1CuqTzbP/YpVMGGqaVosFyzUZSoRKzWhiFXOMmK53PTUieVbxIUbLVbu81cm8+S2s4iVaafEir3J5Ll1sfzaxDC7Y4iZbVskxHL6dE5CLEkb2j/qTtdIrGQny4hVYHQXc4iVl3+IWGLLtkVKLJcXKzbLySTXJlZXmLZxuMRViuWiNBFrVrFKE51ErLJ6pIV0YlwlYsVPx3g1m1iZBqsUq/OFUJroomLJg7PhYo0CsdJiZYOWJlotVk6Q/nI8pVg9FwFIDbMsVFosNeGWYvVmOkCs1HvPcLFUgRKHUEGe6afDsb8ntKsRqxyt0kxiBdcj7suvVqzuiF2hsuGDfesziTUwVIVY8V6zR6zC2ezeKiVW18b9IWsapyuCWAVUiBVF6hOrInzXBjOJlb1LWBwYsfrpF8s1S4sVpjm8twE0Pg/EqiAUy/lnqd5LxBoSvmuDZcUSeSBWBbsSa9zJyKJEfBb7EStftmnEErXbqliGVIk1WZ7ziJVlzCC8SohVkEgmi5RYU0RdWKwJ3gKmEqsylVqxJpuxaqK3umjtHsUaT6FYiRvUBWLVh+3bALGmYs1iBW0Qyy9ArBRTiDUobn9eiFXF6XDI3SLsmcQqSsy58E+452cLYr0dDj/f//kj78iqe1tcrPAzULbNbGLJmCZxCvKoEGuqc7VVJlxul/l23Vud0neOXkKs4CrViJXIY+ViXfdT7/+6iqWvb9txA4FZyIiVPQ5CLLVgFWK5z/9169pjXciI1bH5EmKZhKnLIx5tVIBp0qwyob0Rubg5ue4NsWSUMKZNmN40KsWahjoTTrc7+x5zN/hdgVhFEziPWFHMOcL0BF6pWL29bUQsfWdJxEKsHLViOcSSSxArh/rgU9oCsR5LECtHfW0QSyxBrBwbEMvyS6LdcRFrOFsQaykQawSIlUePD7GqQKw8iDUCxMqDWCNArDyINQLEyoNYI0CsPIg1AsTKUyCWQdSdiFV/9hGx/ALEmpDnESv8Xli4FrEm5YnE6gaxpkVY9dReIdbEsLu6g1jTglh3EGtabm+CiIVYE4NYdxBrWhDrDmJNy62eiGX1nemnFcsh1h3EmhbEuoNY04JYdxBrWhDrDmJNC2LdQaxpQaw7iDUtiHUHsablIdbSeSwOYk0LYt1BrGlBrDtrEOt4ONyv6acvbtv2hljbYwViXXR6//HdIdaeWF6sz9fL3urj5dtfxNoTJiWovxz31azjuq7zPgTEMqV+j3X5/zt7LOhm0HXe338cEAs6qb3O++3GAZ+viAWdPO95rOsxK2JZ8cRiXUAsKxBr6RR2CmItncJOQaylU9gpiLV0CjsFsZZOYacg1tIp7BTEWjqFnYJYS6ewUxBr6RR2CmItncJOQaylU9gpiLV0CjsFsZZOYacg1tIp7BTEWjqFnYJYS6ewU55crCe/K4Uhzy4WGIFYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYMLVYsHMQC0xYRqy5u3+2eBsaHmJtKd6GhodYW4q3oeEh1pbibWh4iLWleBsaHmJtKd6GhodYW4q3oeEh1pbibWh4iLWleBsaHr/cAxMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMsxTodDofvhv0LPl4O92BzBH3/53qr9TaUccxbuLmGeIxGNSieoVinw69zNeYx6/Tl93xBP16+/pGhjGM+ws0zxOPh5znC99HDsxPr8/X66nqUw5bjtfbzBD2/gC/R2lDGMe/hZhrizaBzrLHDsxPr/cfP9qc5b99nC3ru/DrHbSjbmI9wMw3x/cev88/jl99jh2cp1iXFj5c5xPp8/ff5OODnXEHvYt1Dmcc83naQMw7x7eufscOzE+vy1uxmOsi6Rrnss+cJep3pNpR5zGu4OYd4O84aN7x9iHWP+OX3fsW6McsQ22P3dYo151vhjXMJ9vtWeGOOIV72V+OHZ3/w/sssQsi16nMEVQfv9jFDsWzDvV29Gj28fZxuuH+WER+STcMd5zzdoHaQ9kM8Hm4Grfd0w5wnSK+D/3z9OVPQ46wnSIXH9kP0pxVWe4J01l/pnHfgh9tLbY6g9/emuX6lcw83yxCPt+v2XfZPq/2VDjwziAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFgVnA4Pfr19+7t0NusGsSo5Hea74NeWQaxKEKsMxKrkLtb5rfD9x/+8nN8UT7eL/lwvADTfZTFXD2JVIsX6+se9Hb79/Xw9H3Adz3bNdFH7TYBYlUix7pfXu1wZ7eaUuFros4NYlUixft2vzXn26XaNzjkv5btyEKuSjFjHx3mIpfNbC4hVSeceC1oQq5KMWLdjLPRqQaxKMmK5t/ODOe/vsnYQq5KcWP7OpHABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDDh/wEA2pgZwNEAQgAAAABJRU5ErkJggg==" alt="Simulating time-varying effects in mvgam and R" width="60%" style="display: block; margin: auto;" /></p>
<p>Gather the data into a <code>data.frame</code> for fitting models,
and split the data into training and testing folds.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(out, temp, time)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>data_train <span class="ot">&lt;-</span> data[<span class="dv">1</span><span class="sc">:</span><span class="dv">190</span>,]</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>data_test <span class="ot">&lt;-</span> data[<span class="dv">191</span><span class="sc">:</span><span class="dv">200</span>,]</span></code></pre></div>
</div>
<div id="the-dynamic-function" class="section level3">
<h3>The <code>dynamic()</code> function</h3>
<p>Time-varying coefficients can be fairly easily set up using the
<code>s()</code> or <code>gp()</code> wrapper functions in
<code>mvgam</code> formulae by fitting a nonlinear effect of
<code>time</code> and using the covariate of interest as the numeric
<code>by</code> variable (see <code>?mgcv::s</code> or
<code>?brms::gp</code> for more details). The <code>dynamic()</code>
formula wrapper offers a way to automate this process, and will
eventually allow for a broader variety of time-varying effects (such as
random walk or AR processes). Depending on the arguments that are
specified to <code>dynamic</code>, it will either set up a low-rank GP
smooth function using <code>s()</code> with <code>bs = &#39;gp&#39;</code> and a
fixed value of the length scale parameter <span class="math inline">\(\rho\)</span>, or it will set up a Hilbert space
approximate GP using the <code>gp()</code> function with
<code>c=5/4</code> so that <span class="math inline">\(\rho\)</span> is
estimated (see <code>?dynamic</code> for more details). In this first
example we will use the <code>s()</code> option, and will mis-specify
the <span class="math inline">\(\rho\)</span> parameter here as, in
practice, it is never known. This call to <code>dynamic()</code> will
set up the following smooth:
<code>s(time, by = temp, bs = &quot;gp&quot;, m = c(-2, 8, 2), k = 40)</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(out <span class="sc">~</span> <span class="fu">dynamic</span>(temp, <span class="at">rho =</span> <span class="dv">8</span>, <span class="at">stationary =</span> <span class="cn">TRUE</span>, <span class="at">k =</span> <span class="dv">40</span>),</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>             <span class="at">data =</span> data_train,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>             <span class="at">silent =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Inspect the model summary, which shows how the <code>dynamic()</code>
wrapper was used to construct a low-rank Gaussian Process smooth
function:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">summary</span>(mod, <span class="at">include_betas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; out ~ s(time, by = temp, bs = &quot;gp&quot;, m = c(-2, 8, 2), k = 40)</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000026c107b3fd8&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; gaussian</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt; identity</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt; 190 </span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a><span class="co">#&gt; Observation error parameter estimates:</span></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="co">#&gt;              2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">#&gt; sigma_obs[1] 0.23 0.25  0.28    1  1709</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">#&gt;             2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)    4   4   4.1    1  1960</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a><span class="co">#&gt;              edf Ref.df Chi.sq p-value    </span></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="co">#&gt; s(time):temp  17     40    164  &lt;2e-16 ***</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations ended with a divergence (0%)</span></span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:52:26 AM 2024.</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>Because this model used a spline with a <code>gp</code> basis, it’s
smooths can be visualised just like any other <code>gam</code>. We can
plot the estimates for the in-sample and out-of-sample periods to see
how the Gaussian Process function produces sensible smooth forecasts.
Here we supply the full dataset to the <code>newdata</code> argument in
<code>plot_mvgam_smooth</code> to inspect posterior forecasts of the
time-varying smooth function. Overlay the true simulated function to see
that the model has adequately estimated it’s dynamics in both the
training and testing data partitions</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot_mvgam_smooth</span>(mod, <span class="at">smooth =</span> <span class="dv">1</span>, <span class="at">newdata =</span> data)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">190</span>, <span class="at">lty =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">lines</span>(beta_temp, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">&#39;white&#39;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">lines</span>(beta_temp, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>We can also use <code>plot_predictions</code> from the
<code>marginaleffects</code> package to visualise the time-varying
coefficient for what the effect would be estimated to be at different
values of <span class="math inline">\(temperature\)</span>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">require</span>(marginaleffects)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>range_round <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>}</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">plot_predictions</span>(mod, </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                 <span class="at">newdata =</span> <span class="fu">datagrid</span>(<span class="at">time =</span> unique,</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                                    <span class="at">temp =</span> range_round),</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                 <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;time&#39;</span>, <span class="st">&#39;temp&#39;</span>, <span class="st">&#39;temp&#39;</span>),</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;link&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>This results in sensible forecasts of the observations as well</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod, <span class="at">newdata =</span> data_test)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">plot</span>(fc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>The syntax is very similar if we wish to estimate the parameters of
the underlying Gaussian Process, this time using a Hilbert space
approximation. We simply omit the <code>rho</code> argument in
<code>dynamic</code> to make this happen. This will set up a call
similar to <code>gp(time, by = &#39;temp&#39;, c = 5/4, k = 40)</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(out <span class="sc">~</span> <span class="fu">dynamic</span>(temp, <span class="at">k =</span> <span class="dv">40</span>),</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>             <span class="at">data =</span> data_train,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>             <span class="at">silent =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>This model summary now contains estimates for the marginal deviation
and length scale parameters of the underlying Gaussian Process
function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">summary</span>(mod, <span class="at">include_betas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; out ~ gp(time, by = temp, c = 5/4, k = 40, scale = TRUE)</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000026c107b3fd8&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; gaussian</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; identity</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; 190 </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; Observation error parameter estimates:</span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt;              2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt; sigma_obs[1] 0.24 0.26   0.3    1  2285</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a><span class="co">#&gt;             2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)    4   4   4.1    1  3056</span></span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a><span class="co">#&gt; GAM gp term marginal deviation (alpha) and length scale (rho) estimates:</span></span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a><span class="co">#&gt;                      2.5%   50% 97.5% Rhat n_eff</span></span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a><span class="co">#&gt; alpha_gp(time):temp 0.630 0.880 1.400 1.00   619</span></span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a><span class="co">#&gt; rho_gp(time):temp   0.026 0.053 0.069 1.01   487</span></span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations ended with a divergence (0%)</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:53:17 AM 2024.</span></span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>Effects for <code>gp()</code> terms can also be plotted as
smooths:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot_mvgam_smooth</span>(mod, <span class="at">smooth =</span> <span class="dv">1</span>, <span class="at">newdata =</span> data)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">190</span>, <span class="at">lty =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="fu">lines</span>(beta_temp, <span class="at">lwd =</span> <span class="fl">2.5</span>, <span class="at">col =</span> <span class="st">&#39;white&#39;</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">lines</span>(beta_temp, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="salmon-survival-example" class="section level2">
<h2>Salmon survival example</h2>
<p>Here we will use openly available data on marine survival of Chinook
salmon to illustrate how time-varying effects can be used to improve
ecological time series models. <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1365-2419.2005.00346.x">Scheuerell
and Williams (2005)</a> used a dynamic linear model to examine the
relationship between marine survival of Chinook salmon and an index of
ocean upwelling strength along the west coast of the USA. The authors
hypothesized that stronger upwelling in April should create better
growing conditions for phytoplankton, which would then translate into
more zooplankton and provide better foraging opportunities for juvenile
salmon entering the ocean. The data on survival is measured as a
proportional variable over 42 years (1964–2005) and is available in the
<code>MARSS</code> package:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">&#39;https://github.com/atsa-es/MARSS/raw/master/data/SalmonSurvCUI.rda&#39;</span>))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(SalmonSurvCUI)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; Rows: 42</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; Columns: 3</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; $ year    &lt;int&gt; 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 19…</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; $ logit.s &lt;dbl&gt; -3.46, -3.32, -3.58, -3.03, -3.61, -3.35, -3.93, -4.19, -4.82,…</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; $ CUI.apr &lt;int&gt; 57, 5, 43, 11, 47, -21, 25, -2, -1, 43, 2, 35, 0, 1, -1, 6, -7…</span></span></code></pre></div>
<p>First we need to prepare the data for modelling. The variable
<code>CUI.apr</code> will be standardized to make it easier for the
sampler to estimate underlying GP parameters for the time-varying
effect. We also need to convert the survival back to a proportion, as in
its current form it has been logit-transformed (this is because most
time series packages cannot handle proportional data). As usual, we also
need to create a <code>time</code> indicator and a <code>series</code>
indicator for working in <code>mvgam</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>SalmonSurvCUI <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="co"># create a time variable</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="co"># create a series variable</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">series =</span> <span class="fu">as.factor</span>(<span class="st">&#39;salmon&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="co"># z-score the covariate CUI.apr</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">CUI.apr =</span> <span class="fu">as.vector</span>(<span class="fu">scale</span>(CUI.apr))) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  <span class="co"># convert logit-transformed survival back to proportional</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">survival =</span> <span class="fu">plogis</span>(logit.s)) <span class="ot">-&gt;</span> model_data</span></code></pre></div>
<p>Inspect the data</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(model_data)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; Rows: 42</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; Columns: 6</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; $ year     &lt;int&gt; 1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1…</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; $ logit.s  &lt;dbl&gt; -3.46, -3.32, -3.58, -3.03, -3.61, -3.35, -3.93, -4.19, -4.82…</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; $ CUI.apr  &lt;dbl&gt; 2.37949804, 0.03330223, 1.74782994, 0.30401713, 1.92830654, -…</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; $ time     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; $ series   &lt;fct&gt; salmon, salmon, salmon, salmon, salmon, salmon, salmon, salmo…</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; $ survival &lt;dbl&gt; 0.030472033, 0.034891409, 0.027119717, 0.046088827, 0.0263393…</span></span></code></pre></div>
<p>Plot features of the outcome variable, which shows that it is a
proportional variable with particular restrictions that we want to
model:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot_mvgam_series</span>(<span class="at">data =</span> model_data, <span class="at">y =</span> <span class="st">&#39;survival&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAA1VBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOmZmZjpmkJBmkLZmkNtmtrZmtttmtv+PJyeQOgCQOjqQZjqQkGaQtpCQtraQttuQ2/+2ZgC2Zjq2kDq2kGa2tma2tpC225C229u22/+2/7a2///HmZnbkDrbkGbbkJDbtmbbtpDb25Db29vb/7bb/9vb////tmb/trb/25D/27b/29v//7b//9v///9mn+MjAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAbP0lEQVR4nO2dC5+jtrmHmWnm2LvpSbcdZ3uvZ7bb0yG9nJNM3WbTdFw3Y77/Rzq6AQIkJAQvCPF/fskOxiDg9WMhdHNWAEBAtvQJgDSBWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSIBYgASIBUiAWIAEiAVIgFiABIgFSFhOrDyruH0OSuEcuuMauT5m9/xvnt29tC780y8iDAPEWgl2seIMw6K3wjhDEie6WM134oxiBGLxfy/7m/95n332dGH/fM2i+Od9dvObcrP/vM/kq3I1C/LPHrPbP/Pdq02rrdKkk2OV1yty/h27IbLXn/2Rb/lVlv30W7aJCtPXfEX27qVoBZmWaMQS98Qf8T/sGylvk/dyq9eDeHUsqtUsYvwG+he+e7mu3ipN2mJV16vEOmfNKEmxxF+54u6lFWRa4hFr93LKxD8i/3pi3y+Vw5+zm6drLgKjVrOIsaV/nvVNq62WvCBCpCXSEH7h9fWKKDLPdi/stQrlfx6zKkwiRF91gkx8vvGIdRQGiVenrPr6Mdh7N+/+yISpVrOI7dTu1bpqq0Rpi1Vfr4iiiB3X6yiXzlKsndj3h7/+MusEmfh8oxFLZDxGsYpvRRb+04ZY90VLrGqrROmUsarrVWLxUDKx7uugql2uv1e3xmaQic83UrFad7Qf/vpz9kWrVjfEqjeVW816BfNhqG5Q19uXY8kw3fz6nyeIJfPs3xRVOYAtsNXsvWq1Jla1rtpqyQsipC1Wfb3GMtahDtOJPxg+1mXUDYtlfCrUHhY1sdpPhSkX3k1PhaLwzp8KT82nwh/r379V3gqzESlYxbp+pddjiULCu5eiWq2LVW1abbU06nH/ftpUO7dCLSr8Qa9Vj6XdCou/77N33x/4881WxEqSXGaa18fdMsdnt8L/ein+tHR1PMSamNcvVSnv8naZT7asl5g4xxwKnVgPD2OTXiUhYj2UTHIG19/vM/YguHChgFKsbZpV3Qr9nyMe/iZJKWAQa3JOg29FEMuUAMRyU7bGWN6GWKYEIJabrN8siGVKAGI1eT1kt98cssxQ2wCxhiQAsZrk98WZV4CfumZBrCEJQKwGvLrh8ubJWN0AsYYkALEaCLG4UxBrZAIQqwluhQIysZhW2zSLFd7vvkfhHWLNCMTy2tNRNwOxOkCsIQlALG+cYk3ZFr0wEGtGnGIllHFBrBmBWEMSgFjeQKwhCUAsbyDWkAQgljcQqw2v9PtuP6TSj0sFsVpArDY5H7e2G9JMIaSCWU0gVjn8M5Oz7QW02McmFumpvB78Zk+CWC24WGL0iYdY6hOMTyzSc/GbPwlitVEjT3xuheoT3JhYYpyoc/gExOKc61uhKGRZBve6xYpCrzlaSnLrhIK+fd63INb18f76eHw9uL6GrWA9mMSKIFLkYvFJXuqsvcVAsVJoM7SKxctUvM+aq+zQEUtzKiqxSHPOMrPqH/7sK1YKnR16xWJFKhUp+wwqzWBV1Vf6P8mL9Xrwm4EDYnFYsYplVyeRY/XMoGIWq3E/jEQsOrPUfA3O2RogFodXzuRy6sW+iS4awap8ik0s2odUFZ+zK9+CWC1CxVJLiYt1rormrhmxIFbBMyytQNUzg4oerIZO9VIsYpGdSPXFcwCxOOdMq5YxzKDS8whd3f2UVcubFUeNGsRSMJ2csxA7xIqkBp5SrNfDbw96ZbIdiFWThwTLW6zZjNNbMJcDYinydo5leO4xBstfrJmCB7Hmxi7WKfP6LS2XWPKPZee5xCoPQ3W4y5un10NYsYGzKbHcrYQqAbNY5d9NiHV9vOcPzkObv4qqUXCUWHE2LXrVY/Um0JdCbGJRFd+/fOKNEgObvzo5VahYUWZwFi3aTzr+wWrgyikSEev6eLzsj8XA5q9NitViQLCMJC6W7DMjH6C9WymKjYqll7GGBMtI6mJpQCyJV807lVizlTjrw8zQj9Sv+UuczCbFKrSa9wHBMpK6WOpnvGV51P4DAhCrJh8aLCMLi6UdheSAzl/6srSrblasTs27KQGI5e7dALE0xtS8dzB/nguIRWLW9bETqNxUvQyxipE17x1sYs3TekctlqrBEjTHkDeBWIXxW2hOAGJVMgmVZMMOcizbG2N7RTYxfpyz9QFsikV9SDHLBcSyvmMYTm9MIHKxOu2z9O21PLOnEMvS2LwysV5dvSIdo3ubLCWW8aMgEIs96Ry1zg35jkSs3tVrEcs7gcjFGrI6mPzuXzyXqvP4s3GGEIg1JAFPsQyXnYxYotvMcfiA1U2K5bwVlgn4qbkFsQYPWN2kWJLrh0lq3gvjZ5mMWMWJ3woHz8yzZbEGzzZjJWmx5GjowROvbVms4IkuOnQfkx9Ma6fF3hGM9LAWIFaNZSYxLQF/sTpP/QXE2p5YqvA+Te8GQcJi5T5TgkCsDkMaVntofZqOETxT0DM8aMKjXPbCqXzwl3DzYhV63V87gbnECnFhHrHKWnZ7kBQQi9MY3cuHZFoSGFDF2vw4B4s1PHL2XSY0q/r5gLjqsdrjWC0vqXS0ahE6urePoWI1LjtesXqGmjSZV6zW6gfjS7J8zl54b4zu7UkgVCz1wlesoC8XxIpPrMbo3r4EBohl6nHnEOvBtGxJcci784o1TZ/3NMTSR/cGD7FvM0wsvYOprbNpfz42UxnL/sysgFgWxg6xLxksVvW2rfknArH8gVgtRo+ELgkWy1qZ2itW6HtUQKwWk4mlf5xOsfSnRptY/UV6iBW5WKOH2Ff0itWOjFLqofF7BJ1tHFleyHtUQKwOw6bjtqM/5XXXPJi2ravxIFZ6YvUkMCwF/TGvs/Bg3LJ+oysDxIJYErtYbUfM+VN3RaBYqtjWf7YTA7Fs+E7HbcchVvep0bhzY0VgnYKUclazylhZJrXtiNWmpUY7ldb1tVMxvvQeFTu0aXH+HKtdZrdUKJjrFkwrwsWabX4uRSWWWaiOWJa3C0sqrevzTNzv1AdncHOL1X0YbKzoFu4N+4rFekV7y94k9MTq582ZgFgDGCqWxSDtEVBfbdy3lMJcC9H7FNnabuYyPMTqMFFbIcd8z9OVKayFn7pqS89u2k+TD1Ui/efhYd+0QKw2U7UVCloZRVc0eylRlYtK90xiVe55OgOxvKARa7omHY5BrHaPPtun3XDOfNfUZPNzZkazIFaLacVqPYy1qxn899TW6qlpyfql6XfsCYBYbSZrKxS0xRr90K8loNfjeyY7n1kQq8PI6bhbdMQankQ7wfbCgHQhlgcrqG4oOoWiCT5YU3FridZAjvsJGmL5JDA6hSlYoO7AhscTNMTySSAKsXorKWbF+KDT6mIEsXwSiEOsIhKv/MRaMb5xSEasaOh5gt4SE4iVDFPEs+h7gl5F0CaKAsSqmSKe6w/ZVBc5UToyoay9YF47eLtxb7u2mxvPDy/mzTwSmigdiOVPzMZArAmPMjcxGwOxJjzK3MRsDMSa8ChzE7MxEGvCo8xNzMZArAmPMjcxGwOxJjzK3MRsTHxiAaADsQAJEAuQALEACRALkACxAAkQC5AAsQAJEAuQALEACRALkDCVWNfHY3dlbvnpX7kx/w0a46/P1G8bflmy2suc+PVR7lX+7XJ58yTfdv7o/JToByyXw0/ClJo1nEGpFSpQwUwkFjufrlj8l0dNPw4pN349sLdP1rf5SGLDaOJqL0vi+U7+aGf515A605EnLFKaC/2A5XL4SZhSs4YzKLVCBSqcacQ6ZZ+974hlM15tLKyohnea3+4mUe5lSVysPt29lH8NR/8Je0u87fyNzwnRD1guh5+EKTVbOMNSK1SgwplGrH88G26FtpjpGxv8UG8LK6pfxW3C9ur5QMqcyphjXb74jh1S7O383coJ0Q9YLoefhCk18UbQ3cucmgxUOIRlrNPdn3oLUYV55gz1tsyx9iax+F7WxNmNVDhX/m29+0HkdcLacWWIYegHLJfDT8KUGl82hzMoNRWocCjFyixlrGpjSyDE26+HHS+gG8QSe9kTr1cb3j7dF+mKFeaVOTUVqHBIc6wXy9OiWnnZm0uu9VPh7wx7y73sievett++fPEi4pXkrdAWzpDUykCFQyjW2SHW2fbUoRXBumFXe1kSl0XYw7H823pbTatwFOnOWnjXDlguh5+EKTV7OENSKwMVliKHUKy6qGR8x/6FqN42FL/LvSyJy9V3L+VfQ+oy4eSqG8LzF0t1Q7w5lqhssxfe7V8KlaFlpurDai9L4ny1zMwyU+G9KBauIOXVb9NVkGqpjchjTOdWxCIWAA0gFiABYgES4hRLFRiyY1AbxebpRm3+OMYpVjFv9WX6QKwKKZZobv6YZbuz6AVjf9bbICfRb0hU1p1vn68fPmY3n/Oq93zHopbLpeKyF4+KEKuiFmu/K87MKrZC1GsZ+yxsEF6Jx/6vxOKzNPN1bAWLWrnE383ZVhCrRBPrKL6WZX26pR1nc6ja4Vqse/niLDRSS+WWEKtCuxU+iZychcpjouvtwIsFR10s/n1jNz/2Hw+XXCo7lkKsCqNYuAs2yFkhqynW+fabgyxRqaUD+xoix9IxiWXpJrNd2P2vKdbr4Vdvn1W4+JJoLoVYOiaxZAF1VFfsdODfMvFAw3v3l2KxR8WdqlwQS2KjPcvXIFaJSSxRroBXijxThazs5g9vn6s+bkcllux9yzbi90SIBRIBYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgIVaxLvvs9lkufvp5lt28+7ooro+Z4OZp2XOLjSpArwcRnx/9+mX5YMUq1onF5CiWvlIBOi4eq0ipA6TEyrK7l8WDFalYLCy/zHZ8iRn2u6L4ds+CxVbeL31i8aEFiInFv4xseVcsHaxIxbrsb/93z79sZXxOLKtfOlZRogdIicVcu31eOliRinXKdjIyl32dly8dqyjRA1SKxdctHSxPsXJ5w57rVFlUjkwuVlQ4Zw2xBMeZzmIV6AEqxeJ/lw6Wn1g5+4gL/snuSE+mQnwNxT8Qy8GqxXr9Up375e0z5clUnLIyh8St0MGqb4Vzi1V+2+SDjojP+b//D2KZ0ANUinVeTeG9uhXKv9Rc9iJAIpeXT9Of9hHEKk60ACmxPq2ouuE0a+H9JGvd5ZexUUEKsbpYK0gjFYtlG5xbx80vm77CgsVkp/7yHPLT+7pJZ91iEcSKUwWo1aQTp1i+T4BEwUqSLcXKeqlVgV3n3M2/thSssWwpVj05lqMGJCsRrx4eJj2tNWH8CjZpxmrF+H/M9ks9+T0BQiwu1vXRp0ATqVgPQ/BN1H4rVE8YnoV3iOWxZZxikXg1vhEaYq1brEG2DABijWbVYlF51SfWqaoSrSreDDdGiLVesYbd3IbRU3jnEr0eZMBya6UWxOr72jWJTCxKr/oK77I9UwbL/o2EWP5EJxZh4p5i9SQAsbyJQqyQR7wAPG+FPQlALNXBVpUW2J3x9ptD9VInArHC6g4C8Cq89yYAsS57IVEue9zl98WZ9145dc1aXCxqmzRQ3TCeXH37xBMOf0a8vHkydopcWqwZvYJY41GlUVUeFWJxp+ISa4abXxPLpb4efosmHU9aHbejvBXO7tWIHAu9GxQtsVjh/e77eArvcxTUTbj6YzmHT0As/6EmC4i1lFdOsVCP5STemvdllJJYLvVc3ehcHZQhloXle9su6dXArsmmBCCWG/oepCN7T00PqhsmQGROJ9eNkDLHis6rHrHOqG7w5Cyr3M/OeRKoxFpaIhM9gynur49HtBW6qYadqFEC9pl5aMRaPHMy0lvG4nV9riEVEKtdQWqfmYdKLIpUx9Ir1mmHeiw3VZOOiFVfrRaJWJFG3n6p+Y5nV85BYBCr6l5bNUILIJYF/kXM3ZPuGsSK9FLJeD3IbjPyOadnZh4KsWINNkV1Q6zXSkeul9btM/NML1aU5XYBRSN0rNe6OJOLFa9X9m4zA9u/IJYH48WKqg60F9wKZ2SsWHHVrfcDsWZkvFjTnMcc9A+mODbqR3NTLTzE8mekWKuKa0891t2/Ho+qbmbYEHtIZmGUWHHf+Tr01bzzRjBZzSczrpAca1XBCGOejn4r88opluquJgY0QayRBIsVeUHdhP1ST/xWWPVu4JJBrFBGdvRboVd9hfdzs/4430EsG8P6rnmxlmoFGwMu9Wwcbw+xBvdd82HtXo2YNblMAGIN7bvmwTpl0hk2mMI+8mTzYg3ou+Zm/V71Fd4dA7/8GqHXHyEfhvVdc5NA1Ow5VvjcDdsTa1jfNTcJRI26rTCBEE2Hr1gpBM2z8O4ceQKxmvRVzThJIWh+hXf3yJNti8VrGlRfZI92VRdJxMyr8O4xQGDTYqk5peXXz92u6iCBR8LCs/DeL1a7uWLtr4fTnPLJ2a7aTxpejf9N6I5Ya38dgohPVVBwtav2sdJ69i6e4XSOPPG4FSYSMSP6fNyFq121h2S8IpmOe4NiteltV7WSjla9hffgHxCAWBb6xVprc7OZnsJ78E+ebEwsywzTg2f0Sys+EGsOvB4Q0opP+K2wGaxNizWwi5GZxMKDwvsEDJyv1Uxi4ZmxETqxyOk0uhgFzuiXWHgg1gQ0uhgFzuiXWnTsl6o1rPYmALEahE68llp0rJfaaFjtSwBiNQgUK7ng2Ksbwn9LZ2Niteqxwmb0Sy449kttNqzaEwgSK7k4aoTM6JdePHru+q2GVVsCEMsbq1gpteUoFnoqTC2QIpdy1pLaxErQK4g1CcMa7DskFg3BQjXvaYVyYLtqh7SiIVmo20xaoVRihY6ETisYioV6NyQWS/H7X8G3wsSCIQkXK0uO4CDWQ776B45DLM7IAmkQ4XndiAra+T5Xc6yS9Mqz8H59lEvUv3M80CCPPeMQqzdT3JxYGnzuZF4Tn6RY82GM1fKnRYJXW6Fczm+fIZaZMVNFblSsszYS+nT37YxiDdtkUbHcJVGJKVaJemUT61yVCuRP8ckmwzx8ogs/pony7PUa4V2Tkxrx1cCVY0nKPiA5sVjTMP9n5Zr9UNGJVbpeTdZWuG0Cy1jpauU520xvAhCr/rlxB61YpeyVK8e6fmiUHqifCldKYBkrZa+ct8IJ5y5PmOav78ms3tmDNGmvnGJNN3d5wgQN/0r6RugWyz5KZ3zbbZJ4j9JJ2ytn4V3NXR44uneD+IqVuFfu6oZ/jxjduw24SmIUplTJa/hXwhVYCocWucfkthSntSZaYvkM/0rfq16xys4yEKuXtlh2ylilr1WfWJd9lpW5edjo3o0QIhb9WS2NTYszt6qununL3ttPh2t/PRSLWBuvTLZcqrz5OWtHC4NYa389GI8ca/Qx1oftUtmNUM+xehLYULDM9P16TpMtxcp+qTxeDbHMX8gsHSYP7pZj1btF3ihVQSw/+iqTk8EZBccWZy1773/oGfGxhO+6xJ4ueiqT/fE/vQEXQpJocBI/VHdDiOVDX52fPxsQa4aEIFYHiDVFQkmJ1VeZ7A/EmiKhtMTqqUz2B2JNkVBiYk0BxJoiIYjVAWJNkRDE6gCxADACsQAJEAuQALEACRALkACxAAkQC5AAsQAJEAuQALEACRALkDCNWNWY6eHwcbFZQNel6+Mx8MByz9DjkqFfSr0sT9a9JR/6YhgkZNqU/+12mzYfvri88ZtTrsMkYvH+3b5TUrc5h3UNZ9d+DDuw3DP0uGTol1Ivq5N1bilenzpmGRPNd+UvyTsPzxZvlhRLaO0zCNFA7jd9Z4tT9tn7Y9CB1Z6Bx6VDv5RquTxZ55bnxtwtvZuKv6d2zIyHZ9v9ZNEcS5xEWB/v64fPQ+5I/3gW94iAA6s9A49Lh34p1bI6WY8tOd3blm3Tbo5l3vLyxXeLiiX8D7sbiyz38kVgGSvowGLP4ONSoV+KtmwQy7KlacCZeVN2f+18pYxbXj88LVvGGiGWwHc6a52RYgUfl4rRYpkGMtoc7M5YYtzydL9w4X3ErVBgevTx2ifowPXRQo5LheWu5X0rvOwNzzDWu2YnWdOWPENfVixxQmGFd0up040ITdCBpZKhx6VCvxRt2SCWccuz8enNtKm88nZebdpSDTcK+/ItXd1QZzwhOwYdWO0ZeFwqrM/7XtUNlozFtKn5yi2HXzjHKkZUkHYmtfE+5LgK0tDjklFeSn7vW0GqbWnLXEyJ8r/dKzcffmmxAGgBsQAJEAuQEK9Y3dph4En3aXf+51+ItQkgVk0llujgIlphspuPrvljN8RJ/NKRqJE63z5fP3zMbj7nle/5jmmUy6UyeBCrphRLRC6/fRbVNXuIVcIrOs88LEosPh8XX8dWMI3KpTJ4EKuicStkcRJ1et0uR5tFNffVYt3LF2ehkVoqt4RYNbVYsnek+KV4w889bBVei3nUxRK9zHb8P66RXCqDB7Fq6lthds8jB7E65KyQ1RTrfPvNQZao1JIKHsSqKcUSt0DcCo2wGDXFej386u2zEEsulcGDWDWVWMyly/7mib9+PUCsEhGXN0+8xfj6WIrFHhV3qnJBLJXBg1g1vAyR8fEkOSskqGz95mNU7cbLkte1MH94W4p12R+VWGKpDB7EchBTRxfQx3rE4l3ZUBu/GtYjluhzBK/WworEAmsCYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARIgFiABYgESIBYgAWIBEiAWIAFiARL+H7fm5F3r8A0xAAAAAElFTkSuQmCC" width="60%" style="display: block; margin: auto;" /></p>
<div id="a-state-space-beta-regression" class="section level3">
<h3>A State-Space Beta regression</h3>
<p><code>mvgam</code> can easily handle data that are bounded at 0 and 1
with a Beta observation model (using the <code>mgcv</code> function
<code>betar()</code>, see <code>?mgcv::betar</code> for details). First
we will fit a simple State-Space model that uses an AR1 dynamic process
model with no predictors and a Beta observation model:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>mod0 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(<span class="at">formula =</span> survival <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>             <span class="at">trend_model =</span> <span class="fu">AR</span>(),</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>             <span class="at">noncentred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">betar</span>(),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>             <span class="at">data =</span> model_data,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>             <span class="at">silent =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The summary of this model shows good behaviour of the Hamiltonian
Monte Carlo sampler and provides useful summaries on the Beta
observation model parameters:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">summary</span>(mod0)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt; survival ~ 1</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000026c107b3fd8&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="co">#&gt; beta</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; logit</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; AR()</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#&gt; 42 </span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a><span class="co">#&gt; Observation precision parameter estimates:</span></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="co">#&gt;        2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a><span class="co">#&gt; phi[1]   98 270   650 1.01   272</span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="co">#&gt;             2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a><span class="co">#&gt; (Intercept) -4.7 -4.4  -4.1    1   570</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="co">#&gt; Latent trend parameter AR estimates:</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a><span class="co">#&gt;           2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a><span class="co">#&gt; ar1[1]   0.037 0.69  0.98 1.00   570</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a><span class="co">#&gt; sigma[1] 0.120 0.45  0.73 1.01   225</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co">#&gt; 1 of 2000 iterations ended with a divergence (0.05%)</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co">#&gt;  *Try running with larger adapt_delta to remove the divergences</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:54:12 AM 2024.</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>A plot of the underlying dynamic component shows how it has easily
handled the temporal evolution of the time series:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">plot</span>(mod0, <span class="at">type =</span> <span class="st">&#39;trend&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="including-time-varying-upwelling-effects" class="section level3">
<h3>Including time-varying upwelling effects</h3>
<p>Now we can increase the complexity of our model by constructing and
fitting a State-Space model with a time-varying effect of the coastal
upwelling index in addition to the autoregressive dynamics. We again use
a Beta observation model to capture the restrictions of our proportional
observations, but this time will include a <code>dynamic()</code> effect
of <code>CUI.apr</code> in the latent process model. We do not specify
the <span class="math inline">\(\rho\)</span> parameter, instead opting
to estimate it using a Hilbert space approximate GP:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(<span class="at">formula =</span> survival <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>              <span class="at">trend_formula =</span> <span class="sc">~</span> <span class="fu">dynamic</span>(CUI.apr, <span class="at">k =</span> <span class="dv">25</span>, <span class="at">scale =</span> <span class="cn">FALSE</span>),</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>              <span class="at">trend_model =</span> <span class="fu">AR</span>(),</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>              <span class="at">noncentred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">betar</span>(),</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>              <span class="at">data =</span> model_data,</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>              <span class="at">silent =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The summary for this model now includes estimates for the
time-varying GP parameters:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">summary</span>(mod1, <span class="at">include_betas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co">#&gt; GAM observation formula:</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; survival ~ 1</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000026c107b3fd8&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt; GAM process formula:</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt; ~dynamic(CUI.apr, k = 25, scale = FALSE)</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000026c107b3fd8&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt; beta</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt; logit</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt; AR()</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt; N process models:</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a><span class="co">#&gt; 42 </span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt; Observation precision parameter estimates:</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a><span class="co">#&gt;        2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a><span class="co">#&gt; phi[1]  180 360   670 1.01   504</span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a><span class="co">#&gt; GAM observation model coefficient (beta) estimates:</span></span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a><span class="co">#&gt;             2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a><span class="co">#&gt; (Intercept) -6.1 -2.4   1.8    1  1605</span></span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a><span class="co">#&gt; Process model AR parameter estimates:</span></span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a><span class="co">#&gt;        2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a><span class="co">#&gt; ar1[1] 0.48 0.89     1 1.01   681</span></span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a><span class="co">#&gt; Process error parameter estimates:</span></span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a><span class="co">#&gt;          2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a><span class="co">#&gt; sigma[1] 0.18 0.35  0.57 1.02   488</span></span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a><span class="co">#&gt; GAM process model coefficient (beta) estimates:</span></span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a><span class="co">#&gt;                   2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a><span class="co">#&gt; (Intercept)_trend -5.8 -1.5   2.3    1  1670</span></span>
<span id="cb22-53"><a href="#cb22-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-54"><a href="#cb22-54" tabindex="-1"></a><span class="co">#&gt; GAM process model gp term marginal deviation (alpha) and length scale (rho) estimates:</span></span>
<span id="cb22-55"><a href="#cb22-55" tabindex="-1"></a><span class="co">#&gt;                               2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb22-56"><a href="#cb22-56" tabindex="-1"></a><span class="co">#&gt; alpha_gp_time_byCUI_apr_trend 0.03 0.32   1.3    1   629</span></span>
<span id="cb22-57"><a href="#cb22-57" tabindex="-1"></a><span class="co">#&gt; rho_gp_time_byCUI_apr_trend   1.40 5.70  32.0    1   560</span></span>
<span id="cb22-58"><a href="#cb22-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-59"><a href="#cb22-59" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb22-60"><a href="#cb22-60" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb22-61"><a href="#cb22-61" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb22-62"><a href="#cb22-62" tabindex="-1"></a><span class="co">#&gt; 114 of 2000 iterations ended with a divergence (5.7%)</span></span>
<span id="cb22-63"><a href="#cb22-63" tabindex="-1"></a><span class="co">#&gt;  *Try running with larger adapt_delta to remove the divergences</span></span>
<span id="cb22-64"><a href="#cb22-64" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb22-65"><a href="#cb22-65" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb22-66"><a href="#cb22-66" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-67"><a href="#cb22-67" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:55:32 AM 2024.</span></span>
<span id="cb22-68"><a href="#cb22-68" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb22-69"><a href="#cb22-69" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb22-70"><a href="#cb22-70" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>The estimates for the underlying dynamic process, and for the
hindcasts, haven’t changed much:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="at">type =</span> <span class="st">&#39;trend&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="at">type =</span> <span class="st">&#39;forecast&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>But the process error parameter <span class="math inline">\(\sigma\)</span> is slightly smaller for this model
than for the first model:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Extract estimates of the process error &#39;sigma&#39; for each model</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>mod0_sigma <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mod0, <span class="at">variable =</span> <span class="st">&#39;sigma&#39;</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&#39;Mod0&#39;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>mod1_sigma <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mod1, <span class="at">variable =</span> <span class="st">&#39;sigma&#39;</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&#39;Mod1&#39;</span>)</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">rbind</span>(mod0_sigma, mod1_sigma)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co"># Plot using ggplot2</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="fu">require</span>(ggplot2)</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="fu">ggplot</span>(sigmas, <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">sigma[1]</span><span class="st">`</span>, <span class="at">fill =</span> model)) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>Why does the process error not need to be as flexible in the second
model? Because the estimates of this dynamic process are now informed
partly by the time-varying effect of upwelling, which we can visualise
on the link scale using <code>plot()</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="at">type =</span> <span class="st">&#39;smooths&#39;</span>, <span class="at">trend_effects =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="comparing-model-predictive-performances" class="section level3">
<h3>Comparing model predictive performances</h3>
<p>A key question when fitting multiple time series models is whether
one of them provides better predictions than the other. There are
several options in <code>mvgam</code> for exploring this quantitatively.
First, we can compare models based on in-sample approximate
leave-one-out cross-validation as implemented in the popular
<code>loo</code> package:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">loo_compare</span>(mod0, mod1)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co">#&gt;      elpd_diff se_diff</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#&gt; mod1  0.0       0.0   </span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt; mod0 -7.2       2.4</span></span></code></pre></div>
<p>The second model has the larger Expected Log Predictive Density
(ELPD), meaning that it is slightly favoured over the simpler model that
did not include the time-varying upwelling effect. However, the two
models certainly do not differ by much. But this metric only compares
in-sample performance, and we are hoping to use our models to produce
reasonable forecasts. Luckily, <code>mvgam</code> also has routines for
comparing models using approximate leave-future-out cross-validation.
Here we refit both models to a reduced training set (starting at time
point 30) and produce approximate 1-step ahead forecasts. These
forecasts are used to estimate forecast ELPD before expanding the
training set one time point at a time. We use Pareto-smoothed importance
sampling to reweight posterior predictions, acting as a kind of particle
filter so that we don’t need to refit the model too often (you can read
more about how this process works in Bürkner et al. 2020).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>lfo_mod0 <span class="ot">&lt;-</span> <span class="fu">lfo_cv</span>(mod0, <span class="at">min_t =</span> <span class="dv">30</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>lfo_mod1 <span class="ot">&lt;-</span> <span class="fu">lfo_cv</span>(mod1, <span class="at">min_t =</span> <span class="dv">30</span>)</span></code></pre></div>
<p>The model with the time-varying upwelling effect tends to provides
better 1-step ahead forecasts, with a higher total forecast ELPD</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">sum</span>(lfo_mod0<span class="sc">$</span>elpds)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="co">#&gt; [1] 39.67952</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="fu">sum</span>(lfo_mod1<span class="sc">$</span>elpds)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co">#&gt; [1] 41.14095</span></span></code></pre></div>
<p>We can also plot the ELPDs for each model as a contrast. Here, values
less than zero suggest the time-varying predictor model (Mod1) gives
better 1-step ahead forecasts:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lfo_mod0<span class="sc">$</span>elpds) <span class="sc">+</span> <span class="dv">30</span>,</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>     <span class="at">y =</span> lfo_mod0<span class="sc">$</span>elpds <span class="sc">-</span> lfo_mod1<span class="sc">$</span>elpds,</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;ELPDmod0 - ELPDmod1&#39;</span>,</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Evaluation time point&#39;</span>,</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>,</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">&#39;l&#39;</span>)</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&#39;dashed&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Comparing forecast skill for dynamic beta regression models in mvgam and R" width="60%" style="display: block; margin: auto;" /></p>
<p>A useful exercise to further expand this model would be to think
about what kinds of predictors might impact measurement error, which
could easily be implemented into the observation formula in
<code>mvgam()</code>. But for now, we will leave the model as-is.</p>
</div>
</div>
<div id="further-reading" class="section level2">
<h2>Further reading</h2>
<p>The following papers and resources offer a lot of useful material
about dynamic linear models and how they can be applied / evaluated in
practice:</p>
<p>Bürkner, PC, Gabry, J and Vehtari, A <a href="https://www.tandfonline.com/doi/full/10.1080/00949655.2020.1783262">Approximate
leave-future-out cross-validation for Bayesian time series models</a>.
<em>Journal of Statistical Computation and Simulation</em>. 90:14 (2020)
2499-2523.</p>
<p>Herrero, Asier, et al. <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/1365-2745.12527">From
the individual to the landscape and back: time‐varying effects of
climate and herbivory on tree sapling growth at distribution limits</a>.
<em>Journal of Ecology</em> 104.2 (2016): 430-442.</p>
<p>Holmes, Elizabeth E., Eric J. Ward, and Wills Kellie. “<a href="https://journal.r-project.org/archive/2012/RJ-2012-002/index.html">MARSS:
multivariate autoregressive state-space models for analyzing time-series
data.</a>” <em>R Journal</em>. 4.1 (2012): 11.</p>
<p>Scheuerell, Mark D., and John G. Williams. <a href="https://onlinelibrary.wiley.com/doi/10.1111/j.1365-2419.2005.00346.x">Forecasting
climate induced changes in the survival of Snake River Spring/Summer
Chinook Salmon (<em>Oncorhynchus Tshawytscha</em>)</a> <em>Fisheries
Oceanography</em> 14 (2005): 448–57.</p>
</div>
<div id="interested-in-contributing" class="section level2">
<h2>Interested in contributing?</h2>
<p>I’m actively seeking PhD students and other researchers to work in
the areas of ecological forecasting, multivariate model evaluation and
development of <code>mvgam</code>. Please reach out if you are
interested (n.clark’at’uq.edu.au)</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
