<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Nicholas J Clark" />

<meta name="date" content="2024-09-04" />

<title>Overview of the mvgam package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Overview of the mvgam package</h1>
<h4 class="author">Nicholas J Clark</h4>
<h4 class="date">2024-09-04</h4>


<div id="TOC">
<ul>
<li><a href="#dynamic-gams" id="toc-dynamic-gams">Dynamic GAMs</a></li>
<li><a href="#supported-observation-families" id="toc-supported-observation-families">Supported observation
families</a></li>
<li><a href="#supported-temporal-dynamic-processes" id="toc-supported-temporal-dynamic-processes">Supported temporal dynamic
processes</a>
<ul>
<li><a href="#independent-random-walks" id="toc-independent-random-walks">Independent Random Walks</a></li>
<li><a href="#multivariate-random-walks" id="toc-multivariate-random-walks">Multivariate Random Walks</a></li>
<li><a href="#autoregressive-processes" id="toc-autoregressive-processes">Autoregressive processes</a></li>
<li><a href="#vector-autoregressive-processes" id="toc-vector-autoregressive-processes">Vector Autoregressive
processes</a></li>
<li><a href="#gaussian-processes" id="toc-gaussian-processes">Gaussian
Processes</a></li>
<li><a href="#piecewise-logistic-and-linear-trends" id="toc-piecewise-logistic-and-linear-trends">Piecewise logistic and
linear trends</a></li>
<li><a href="#continuous-time-ar1-processes" id="toc-continuous-time-ar1-processes">Continuous time AR(1)
processes</a></li>
</ul></li>
<li><a href="#regression-formulae" id="toc-regression-formulae">Regression formulae</a></li>
<li><a href="#example-time-series-data" id="toc-example-time-series-data">Example time series data</a></li>
<li><a href="#manipulating-data-for-modelling" id="toc-manipulating-data-for-modelling">Manipulating data for
modelling</a></li>
<li><a href="#glms-with-temporal-random-effects" id="toc-glms-with-temporal-random-effects">GLMs with temporal random
effects</a>
<ul>
<li><a href="#plotting-effects-and-residuals" id="toc-plotting-effects-and-residuals">Plotting effects and
residuals</a></li>
<li><a href="#bayesplot-support" id="toc-bayesplot-support"><code>bayesplot</code> support</a></li>
</ul></li>
<li><a href="#automatic-forecasting-for-new-data" id="toc-automatic-forecasting-for-new-data">Automatic forecasting for
new data</a></li>
<li><a href="#adding-predictors-as-fixed-effects" id="toc-adding-predictors-as-fixed-effects">Adding predictors as “fixed”
effects</a>
<ul>
<li><a href="#marginaleffects-support" id="toc-marginaleffects-support"><code>marginaleffects</code>
support</a></li>
</ul></li>
<li><a href="#adding-predictors-as-smooths" id="toc-adding-predictors-as-smooths">Adding predictors as
smooths</a></li>
<li><a href="#latent-dynamics-in-mvgam" id="toc-latent-dynamics-in-mvgam">Latent dynamics in
<code>mvgam</code></a></li>
<li><a href="#interested-in-contributing" id="toc-interested-in-contributing">Interested in contributing?</a></li>
</ul>
</div>

<p>The purpose of this vignette is to give a general overview of the
<code>mvgam</code> package and its primary functions.</p>
<div id="dynamic-gams" class="section level2">
<h2>Dynamic GAMs</h2>
<p><code>mvgam</code> is designed to propagate unobserved temporal
processes to capture latent dynamics in the observed time series. This
works in a state-space format, with the temporal <em>trend</em> evolving
independently of the observation process. An introduction to the package
and some worked examples are also shown in this seminar: <a href="https://www.youtube.com/watch?v=0zZopLlomsQ" target="_blank">Ecological Forecasting with Dynamic Generalized Additive
Models</a>. Briefly, assume <span class="math inline">\(\tilde{\boldsymbol{y}}_{i,t}\)</span> is the
conditional expectation of response variable <span class="math inline">\(\boldsymbol{i}\)</span> at time <span class="math inline">\(\boldsymbol{t}\)</span>. Assuming <span class="math inline">\(\boldsymbol{y_i}\)</span> is drawn from an
exponential distribution with an invertible link function, the linear
predictor for a multivariate Dynamic GAM can be written as:</p>
<p><span class="math display">\[for~i~in~1:N_{series}~...\]</span> <span class="math display">\[for~t~in~1:N_{timepoints}~...\]</span></p>
<p><span class="math display">\[g^{-1}(\tilde{\boldsymbol{y}}_{i,t})=\alpha_{i}+\sum\limits_{j=1}^J\boldsymbol{s}_{i,j,t}\boldsymbol{x}_{j,t}+\boldsymbol{z}_{i,t}\,,\]</span>
Here <span class="math inline">\(\alpha\)</span> are the unknown
intercepts, the <span class="math inline">\(\boldsymbol{s}\)</span>’s
are unknown smooth functions of covariates (<span class="math inline">\(\boldsymbol{x}\)</span>’s), which can potentially
vary among the response series, and <span class="math inline">\(\boldsymbol{z}\)</span> are dynamic latent
processes. Each smooth function <span class="math inline">\(\boldsymbol{s_j}\)</span> is composed of basis
expansions whose coefficients, which must be estimated, control the
functional relationship between <span class="math inline">\(\boldsymbol{x}_{j}\)</span> and <span class="math inline">\(g^{-1}(\tilde{\boldsymbol{y}})\)</span>. The size
of the basis expansion limits the smooth’s potential complexity. A
larger set of basis functions allows greater flexibility. For more
information on GAMs and how they can smooth through data, see <a href="https://ecogambler.netlify.app/blog/interpreting-gams/" target="_blank">this blogpost on how to interpret nonlinear effects from
Generalized Additive Models</a>.</p>
<p>Several advantages of GAMs are that they can model a diversity of
response families, including discrete distributions (i.e. Poisson,
Negative Binomial, Gamma) that accommodate common ecological features
such as zero-inflation or overdispersion, and that they can be
formulated to include hierarchical smoothing for multivariate responses.
<code>mvgam</code> supports a number of different observation families,
which are summarized below:</p>
</div>
<div id="supported-observation-families" class="section level2">
<h2>Supported observation families</h2>
<table>
<colgroup>
<col width="16%" />
<col width="15%" />
<col width="46%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Distribution</th>
<th align="center">Function</th>
<th align="center">Support</th>
<th align="center">Extra parameter(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Gaussian (identity link)</td>
<td align="center"><code>gaussian()</code></td>
<td align="center">Real values in <span class="math inline">\((-\infty,
\infty)\)</span></td>
<td align="center"><span class="math inline">\(\sigma\)</span></td>
</tr>
<tr class="even">
<td align="center">Student’s T (identity link)</td>
<td align="center"><code>student-t()</code></td>
<td align="center">Heavy-tailed real values in <span class="math inline">\((-\infty, \infty)\)</span></td>
<td align="center"><span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\nu\)</span></td>
</tr>
<tr class="odd">
<td align="center">LogNormal (identity link)</td>
<td align="center"><code>lognormal()</code></td>
<td align="center">Positive real values in <span class="math inline">\([0, \infty)\)</span></td>
<td align="center"><span class="math inline">\(\sigma\)</span></td>
</tr>
<tr class="even">
<td align="center">Gamma (log link)</td>
<td align="center"><code>Gamma()</code></td>
<td align="center">Positive real values in <span class="math inline">\([0, \infty)\)</span></td>
<td align="center"><span class="math inline">\(\alpha\)</span></td>
</tr>
<tr class="odd">
<td align="center">Beta (logit link)</td>
<td align="center"><code>betar()</code></td>
<td align="center">Real values (proportional) in <span class="math inline">\([0,1]\)</span></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
</tr>
<tr class="even">
<td align="center">Bernoulli (logit link)</td>
<td align="center"><code>bernoulli()</code></td>
<td align="center">Binary data in <span class="math inline">\({0,1}\)</span></td>
<td align="center">-</td>
</tr>
<tr class="odd">
<td align="center">Poisson (log link)</td>
<td align="center"><code>poisson()</code></td>
<td align="center">Non-negative integers in <span class="math inline">\((0,1,2,...)\)</span></td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="center">Negative Binomial2 (log link)</td>
<td align="center"><code>nb()</code></td>
<td align="center">Non-negative integers in <span class="math inline">\((0,1,2,...)\)</span></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
</tr>
<tr class="odd">
<td align="center">Binomial (logit link)</td>
<td align="center"><code>binomial()</code></td>
<td align="center">Non-negative integers in <span class="math inline">\((0,1,2,...)\)</span></td>
<td align="center">-</td>
</tr>
<tr class="even">
<td align="center">Beta-Binomial (logit link)</td>
<td align="center"><code>beta_binomial()</code></td>
<td align="center">Non-negative integers in <span class="math inline">\((0,1,2,...)\)</span></td>
<td align="center"><span class="math inline">\(\phi\)</span></td>
</tr>
<tr class="odd">
<td align="center">Poisson Binomial N-mixture (log link)</td>
<td align="center"><code>nmix()</code></td>
<td align="center">Non-negative integers in <span class="math inline">\((0,1,2,...)\)</span></td>
<td align="center">-</td>
</tr>
</tbody>
</table>
<p>For all supported observation families, any extra parameters that
need to be estimated (i.e. the <span class="math inline">\(\sigma\)</span> in a Gaussian model or the <span class="math inline">\(\phi\)</span> in a Negative Binomial model) are by
default estimated independently for each series. However, users can opt
to force all series to share extra observation parameters using
<code>share_obs_params = TRUE</code> in <code>mvgam()</code>. Note that
default link functions cannot currently be changed.</p>
</div>
<div id="supported-temporal-dynamic-processes" class="section level2">
<h2>Supported temporal dynamic processes</h2>
<p>The dynamic processes can take a wide variety of forms, some of which
can be multivariate to allow the different time series to interact or be
correlated. When using the <code>mvgam()</code> function, the user
chooses between different process models with the
<code>trend_model</code> argument. Available process models are
described in detail below.</p>
<div id="independent-random-walks" class="section level3">
<h3>Independent Random Walks</h3>
<p>Use <code>trend_model = &#39;RW&#39;</code> or
<code>trend_model = RW()</code> to set up a model where each series in
<code>data</code> has independent latent temporal dynamics of the
form:</p>
<p><span class="math display">\[\begin{align*}
z_{i,t} &amp; \sim \text{Normal}(z_{i,t-1}, \sigma_i)
\end{align*}\]</span></p>
<p>Process error parameters <span class="math inline">\(\sigma\)</span>
are modeled independently for each series. If a moving average process
is required, use <code>trend_model = RW(ma = TRUE)</code> to set up the
following:</p>
<p><span class="math display">\[\begin{align*}
z_{i,t} &amp; = z_{i,t-1} + \theta_i * error_{i,t-1} + error_{i,t} \\
error_{i,t} &amp; \sim \text{Normal}(0, \sigma_i)
\end{align*}\]</span></p>
<p>Moving average coefficients <span class="math inline">\(\theta\)</span> are independently estimated for
each series and will be forced to be stationary by default <span class="math inline">\((abs(\theta)&lt;1)\)</span>. Only moving averages
of order <span class="math inline">\(q=1\)</span> are currently
allowed.</p>
</div>
<div id="multivariate-random-walks" class="section level3">
<h3>Multivariate Random Walks</h3>
<p>If more than one series is included in <code>data</code> <span class="math inline">\((N_{series} &gt; 1)\)</span>, a multivariate
Random Walk can be set up using
<code>trend_model = RW(cor = TRUE)</code>, resulting in the
following:</p>
<p><span class="math display">\[\begin{align*}
z_{t} &amp; \sim \text{MVNormal}(z_{t-1}, \Sigma)
\end{align*}\]</span></p>
<p>Where the latent process estimate <span class="math inline">\(z_t\)</span> now takes the form of a vector. The
covariance matrix <span class="math inline">\(\Sigma\)</span> will
capture contemporaneously correlated process errors. It is parameterised
using a Cholesky factorization, which requires priors on the
series-level variances <span class="math inline">\(\sigma\)</span> and
on the strength of correlations using <code>Stan</code>’s
<code>lkj_corr_cholesky</code> distribution.</p>
<p>Moving average terms can also be included for multivariate random
walks, in which case the moving average coefficients <span class="math inline">\(\theta\)</span> will be parameterised as an <span class="math inline">\(N_{series} * N_{series}\)</span> matrix</p>
</div>
<div id="autoregressive-processes" class="section level3">
<h3>Autoregressive processes</h3>
<p>Autoregressive models up to <span class="math inline">\(p=3\)</span>,
in which the autoregressive coefficients are estimated independently for
each series, can be used by specifying <code>trend_model = &#39;AR1&#39;</code>,
<code>trend_model = &#39;AR2&#39;</code>, <code>trend_model = &#39;AR3&#39;</code>, or
<code>trend_model = AR(p = 1, 2, or 3)</code>. For example, a univariate
AR(1) model takes the form:</p>
<p><span class="math display">\[\begin{align*}
z_{i,t} &amp; \sim \text{Normal}(ar1_i * z_{i,t-1}, \sigma_i)
\end{align*}\]</span></p>
<p>All options are the same as for Random Walks, but additional options
will be available for placing priors on the autoregressive coefficients.
By default, these coefficients will not be forced into stationarity, but
users can impose this restriction by changing the upper and lower bounds
on their priors. See <code>?get_mvgam_priors</code> for more
details.</p>
</div>
<div id="vector-autoregressive-processes" class="section level3">
<h3>Vector Autoregressive processes</h3>
<p>A Vector Autoregression of order <span class="math inline">\(p=1\)</span> can be specified if <span class="math inline">\(N_{series} &gt; 1\)</span> using
<code>trend_model = &#39;VAR1&#39;</code> or <code>trend_model = VAR()</code>. A
VAR(1) model takes the form:</p>
<p><span class="math display">\[\begin{align*}
z_{t} &amp; \sim \text{Normal}(A * z_{t-1}, \Sigma)
\end{align*}\]</span></p>
<p>Where <span class="math inline">\(A\)</span> is an <span class="math inline">\(N_{series} * N_{series}\)</span> matrix of
autoregressive coefficients in which the diagonals capture lagged
self-dependence (i.e. the effect of a process at time <span class="math inline">\(t\)</span> on its own estimate at time <span class="math inline">\(t+1\)</span>), while off-diagonals capture lagged
cross-dependence (i.e. the effect of a process at time <span class="math inline">\(t\)</span> on the process for another series at
time <span class="math inline">\(t+1\)</span>). By default, the
covariance matrix <span class="math inline">\(\Sigma\)</span> will
assume no process error covariance by fixing the off-diagonals to <span class="math inline">\(0\)</span>. To allow for correlated errors, use
<code>trend_model = &#39;VAR1cor&#39;</code> or
<code>trend_model = VAR(cor = TRUE)</code>. A moving average of order
<span class="math inline">\(q=1\)</span> can also be included using
<code>trend_model = VAR(ma = TRUE, cor = TRUE)</code>.</p>
<p>Note that for all VAR models, stationarity of the process is enforced
with a structured prior distribution that is described in detail in <a href="https://www.tandfonline.com/doi/full/10.1080/10618600.2022.2079648">Heaps
2022</a></p>
<p>Heaps, Sarah E. “<a href="https://www.tandfonline.com/doi/full/10.1080/10618600.2022.2079648">Enforcing
stationarity through the prior in vector autoregressions.</a>”
<em>Journal of Computational and Graphical Statistics</em> 32.1 (2023):
74-83.</p>
</div>
<div id="gaussian-processes" class="section level3">
<h3>Gaussian Processes</h3>
<p>The final option for modelling temporal dynamics is to use a Gaussian
Process with squared exponential kernel. These are set up independently
for each series (there is currently no multivariate GP option), using
<code>trend_model = &#39;GP&#39;</code>. The dynamics for each latent process
are modelled as:</p>
<p><span class="math display">\[\begin{align*}
z &amp; \sim \text{MVNormal}(0, \Sigma_{error}) \\
\Sigma_{error}[t_i, t_j] &amp; = \alpha^2 * exp(-0.5 * ((|t_i - t_j| /
\rho))^2) \end{align*}\]</span></p>
<p>The latent dynamic process evolves from a complex, high-dimensional
Multivariate Normal distribution which depends on <span class="math inline">\(\rho\)</span> (often called the length scale
parameter) to control how quickly the correlations between the model’s
errors decay as a function of time. For these models, covariance decays
exponentially fast with the squared distance (in time) between the
observations. The functions also depend on a parameter <span class="math inline">\(\alpha\)</span>, which controls the marginal
variability of the temporal function at all points; in other words it
controls how much the GP term contributes to the linear predictor.
<code>mvgam</code> capitalizes on some advances that allow GPs to be
approximated using Hilbert space basis functions, which <a href="https://link.springer.com/article/10.1007/s11222-022-10167-2" target="_blank">considerably speed up computation at little cost to
accuracy or prediction performance</a>.</p>
</div>
<div id="piecewise-logistic-and-linear-trends" class="section level3">
<h3>Piecewise logistic and linear trends</h3>
<p>Modeling growth for many types of time series is often similar to
modeling population growth in natural ecosystems, where there series
exhibits nonlinear growth that saturates at some particular carrying
capacity. The logistic trend model available in {<code>mvgam</code>}
allows for a time-varying capacity <span class="math inline">\(C(t)\)</span> as well as a non-constant growth
rate. Changes in the base growth rate <span class="math inline">\(k\)</span> are incorporated by explicitly defining
changepoints throughout the training period where the growth rate is
allowed to vary. The changepoint vector <span class="math inline">\(a\)</span> is represented as a vector of
<code>1</code>s and <code>0</code>s, and the rate of growth at time
<span class="math inline">\(t\)</span> is represented as <span class="math inline">\(k+a(t)^T\delta\)</span>. Potential changepoints
are selected uniformly across the training period, and the number of
changepoints, as well as the flexibility of the potential rate changes
at these changepoints, can be controlled using
<code>trend_model = PW()</code>. The full piecewise logistic growth
model is then:</p>
<p><span class="math display">\[\begin{align*}
z_t &amp; = \frac{C_t}{1 +
\exp(-(k+a(t)^T\delta)(t-(m+a(t)^T\gamma)))}  \end{align*}\]</span></p>
<p>For time series that do not appear to exhibit saturating growth, a
piece-wise constant rate of growth can often provide a useful trend
model. The piecewise linear trend is defined as:</p>
<p><span class="math display">\[\begin{align*}
z_t &amp; = (k+a(t)^T\delta)t +
(m+a(t)^T\gamma)  \end{align*}\]</span></p>
<p>In both trend models, <span class="math inline">\(m\)</span> is an
offset parameter that controls the trend intercept. Because of this
parameter, it is not recommended that you include an intercept in your
observation formula because this will not be identifiable. You can read
about the full description of piecewise linear and logistic trends <a href="https://www.tandfonline.com/doi/abs/10.1080/00031305.2017.1380080" target="_blank">in this paper by Taylor and Letham</a>.</p>
<p>Sean J. Taylor and Benjamin Letham. “<a href="https://www.tandfonline.com/doi/full/10.1080/00031305.2017.1380080">Forecasting
at scale.</a>” <em>The American Statistician</em> 72.1 (2018):
37-45.</p>
</div>
<div id="continuous-time-ar1-processes" class="section level3">
<h3>Continuous time AR(1) processes</h3>
<p>Most trend models in the <code>mvgam()</code> function expect time to
be measured in regularly-spaced, discrete intervals (i.e. one
measurement per week, or one per year for example). But some time series
are taken at irregular intervals and we’d like to model autoregressive
properties of these. The <code>trend_model = CAR()</code> can be useful
to set up these models, which currently only support autoregressive
processes of order <code>1</code>. The evolution of the latent dynamic
process follows the form:</p>
<p><span class="math display">\[\begin{align*}
z_{i,t} &amp; \sim \text{Normal}(ar1_i^{distance} * z_{i,t-1}, \sigma_i)
\end{align*}\]</span></p>
<p>Where <span class="math inline">\(distance\)</span> is a vector of
non-negative measurements of the time differences between successive
observations. See the <strong>Examples</strong> section in
<code>?CAR</code> for an illustration of how to set these models up.</p>
</div>
</div>
<div id="regression-formulae" class="section level2">
<h2>Regression formulae</h2>
<p><code>mvgam</code> supports an observation model regression formula,
built off the <code>mgcv</code> package, as well as an optional process
model regression formula. The formulae supplied to are exactly like
those supplied to <code>glm()</code> except that smooth terms,
<code>s()</code>, <code>te()</code>, <code>ti()</code> and
<code>t2()</code>, time-varying effects using <code>dynamic()</code>,
monotonically increasing (using <code>s(x, bs = &#39;moi&#39;)</code>) or
decreasing splines (using <code>s(x, bs = &#39;mod&#39;)</code>; see
<code>?smooth.construct.moi.smooth.spec</code> for details), as well as
Gaussian Process functions using <code>gp()</code>, can be added to the
right hand side (and <code>.</code> is not supported in
<code>mvgam</code> formulae). See <code>?mvgam_formulae</code> for more
guidance.</p>
<p>For setting up State-Space models, the optional process model formula
can be used (see <a href="https://nicholasjclark.github.io/mvgam/articles/trend_formulas.html">the
State-Space model vignette</a> and <a href="https://nicholasjclark.github.io/mvgam/articles/trend_formulas.html">the
shared latent states vignette</a> for guidance on using trend
formulae).</p>
</div>
<div id="example-time-series-data" class="section level2">
<h2>Example time series data</h2>
<p>The ‘portal_data’ object contains time series of rodent captures from
the Portal Project, <a href="https://portal.weecology.org/" target="_blank">a long-term monitoring study based near the town of
Portal, Arizona</a>. Researchers have been operating a standardized set
of baited traps within 24 experimental plots at this site since the
1970’s. Sampling follows the lunar monthly cycle, with observations
occurring on average about 28 days apart. However, missing observations
do occur due to difficulties accessing the site (weather events, COVID
disruptions etc…). You can read about the full sampling protocol <a href="https://www.biorxiv.org/content/10.1101/332783v3.full" target="_blank">in this preprint by Ernest et al on the Biorxiv</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;portal_data&quot;</span>)</span></code></pre></div>
<p>As the data come pre-loaded with the <code>mvgam</code> package, you
can read a little about it in the help page using
<code>?portal_data</code>. Before working with data, it is important to
inspect how the data are structured, first using <code>head</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">head</span>(portal_data)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt;   moon DM DO PP OT year month mintemp precipitation     ndvi</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; 1  329 10  6  0  2 2004     1  -9.710          37.8 1.465889</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; 2  330 14  8  1  0 2004     2  -5.924           8.7 1.558507</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; 3  331  9  1  2  1 2004     3  -0.220          43.5 1.337817</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 4  332 NA NA NA NA 2004     4   1.931          23.9 1.658913</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 5  333 15  8 10  1 2004     5   6.568           0.9 1.853656</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 6  334 NA NA NA NA 2004     6  11.590           1.4 1.761330</span></span></code></pre></div>
<p>But the <code>glimpse</code> function in <code>dplyr</code> is also
useful for understanding how variables are structured</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(portal_data)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Rows: 199</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Columns: 10</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; $ moon          &lt;int&gt; 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 3…</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; $ DM            &lt;int&gt; 10, 14, 9, NA, 15, NA, NA, 9, 5, 8, NA, 14, 7, NA, NA, 9…</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; $ DO            &lt;int&gt; 6, 8, 1, NA, 8, NA, NA, 3, 3, 4, NA, 3, 8, NA, NA, 3, NA…</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; $ PP            &lt;int&gt; 0, 1, 2, NA, 10, NA, NA, 16, 18, 12, NA, 3, 2, NA, NA, 1…</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; $ OT            &lt;int&gt; 2, 0, 1, NA, 1, NA, NA, 1, 0, 0, NA, 2, 1, NA, NA, 1, NA…</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; $ year          &lt;int&gt; 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 20…</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; $ month         &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6,…</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; $ mintemp       &lt;dbl&gt; -9.710, -5.924, -0.220, 1.931, 6.568, 11.590, 14.370, 16…</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; $ precipitation &lt;dbl&gt; 37.8, 8.7, 43.5, 23.9, 0.9, 1.4, 20.3, 91.0, 60.5, 25.2,…</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; $ ndvi          &lt;dbl&gt; 1.4658889, 1.5585069, 1.3378172, 1.6589129, 1.8536561, 1…</span></span></code></pre></div>
<p>We will focus analyses on the time series of captures for one
specific rodent species, the Desert Pocket Mouse <em>Chaetodipus
penicillatus</em>. This species is interesting in that it goes into a
kind of “hibernation” during the colder months, leading to very low
captures during the winter period</p>
</div>
<div id="manipulating-data-for-modelling" class="section level2">
<h2>Manipulating data for modelling</h2>
<p>Manipulating the data into a ‘long’ format is necessary for modelling
in <code>mvgam</code>. By ‘long’ format, we mean that each
<code>series x time</code> observation needs to have its own entry in
the <code>dataframe</code> or <code>list</code> object that we wish to
use as data for modelling. A simple example can be viewed by simulating
data using the <code>sim_mvgam</code> function. See
<code>?sim_mvgam</code> for more details</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">sim_mvgam</span>(<span class="at">n_series =</span> <span class="dv">4</span>, <span class="at">T =</span> <span class="dv">24</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">head</span>(data<span class="sc">$</span>data_train, <span class="dv">12</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;    y season year   series time</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt; 1  1      1    1 series_1    1</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt; 2  5      1    1 series_2    1</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; 3  2      1    1 series_3    1</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; 4  3      1    1 series_4    1</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; 5  3      2    1 series_1    2</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt; 6  8      2    1 series_2    2</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; 7  1      2    1 series_3    2</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; 8  2      2    1 series_4    2</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; 9  2      3    1 series_1    3</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; 10 4      3    1 series_2    3</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; 11 1      3    1 series_3    3</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; 12 2      3    1 series_4    3</span></span></code></pre></div>
<p>Notice how we have four different time series in these simulated
data, but we do not spread the outcome values into different columns.
Rather, there is only a single column for the outcome variable, labelled
<code>y</code> in these simulated data. We also must supply a variable
labelled <code>time</code> to ensure the modelling software knows how to
arrange the time series when building models. This setup still allows us
to formulate multivariate time series models, as you can see in the <a href="https://nicholasjclark.github.io/mvgam/articles/trend_formulas.html">State-Space
vignette</a>. Below are the steps needed to shape our
<code>portal_data</code> object into the correct form. First, we create
a <code>time</code> variable, select the column representing counts of
our target species (<code>PP</code>), and select appropriate variables
that we can use as predictors</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>portal_data <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="co"># mvgam requires a &#39;time&#39; variable be present in the data to index</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="co"># the temporal observations. This is especially important when tracking </span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="co"># multiple time series. In the Portal data, the &#39;moon&#39; variable indexes the</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="co"># lunar monthly timestep of the trapping sessions</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time =</span> moon <span class="sc">-</span> (<span class="fu">min</span>(moon)) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="co"># We can also provide a more informative name for the outcome variable, which </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="co"># is counts of the &#39;PP&#39; species (Chaetodipus penicillatus) across all control</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="co"># plots</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">count =</span> PP) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  </span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  <span class="co"># The other requirement for mvgam is a &#39;series&#39; variable, which needs to be a</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>  <span class="co"># factor variable to index which time series each row in the data belongs to.</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  <span class="co"># Again, this is more useful when you have multiple time series in the data</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">series =</span> <span class="fu">as.factor</span>(<span class="st">&#39;PP&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>  </span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>  <span class="co"># Select the variables of interest to keep in the model_data</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(series, year, time, count, mintemp, ndvi) <span class="ot">-&gt;</span> model_data</span></code></pre></div>
<p>The data now contain six variables:<br />
<code>series</code>, a factor indexing which time series each
observation belongs to<br />
<code>year</code>, the year of sampling<br />
<code>time</code>, the indicator of which time step each observation
belongs to<br />
<code>count</code>, the response variable representing the number of
captures of the species <code>PP</code> in each sampling
observation<br />
<code>mintemp</code>, the monthly average minimum temperature at each
time step<br />
<code>ndvi</code>, the monthly average Normalized Difference Vegetation
Index at each time step</p>
<p>Now check the data structure again</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">head</span>(model_data)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt;   series year time count mintemp     ndvi</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; 1     PP 2004    1     0  -9.710 1.465889</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; 2     PP 2004    2     1  -5.924 1.558507</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; 3     PP 2004    3     2  -0.220 1.337817</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; 4     PP 2004    4    NA   1.931 1.658913</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; 5     PP 2004    5    10   6.568 1.853656</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; 6     PP 2004    6    NA  11.590 1.761330</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(model_data)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt; Rows: 199</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; Columns: 6</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; $ series  &lt;fct&gt; PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP…</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; $ year    &lt;int&gt; 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 20…</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; $ time    &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; $ count   &lt;int&gt; 0, 1, 2, NA, 10, NA, NA, 16, 18, 12, NA, 3, 2, NA, NA, 13, NA,…</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; $ mintemp &lt;dbl&gt; -9.710, -5.924, -0.220, 1.931, 6.568, 11.590, 14.370, 16.520, …</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; $ ndvi    &lt;dbl&gt; 1.4658889, 1.5585069, 1.3378172, 1.6589129, 1.8536561, 1.76132…</span></span></code></pre></div>
<p>You can also summarize multiple variables, which is helpful to search
for data ranges and identify missing values</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">summary</span>(model_data)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt;  series        year           time           count          mintemp       </span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;  PP:199   Min.   :2004   Min.   :  1.0   Min.   : 0.00   Min.   :-24.000  </span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;           1st Qu.:2008   1st Qu.: 50.5   1st Qu.: 2.50   1st Qu.: -3.884  </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;           Median :2012   Median :100.0   Median :12.00   Median :  2.130  </span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;           Mean   :2012   Mean   :100.0   Mean   :15.14   Mean   :  3.504  </span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;           3rd Qu.:2016   3rd Qu.:149.5   3rd Qu.:24.00   3rd Qu.: 12.310  </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;           Max.   :2020   Max.   :199.0   Max.   :65.00   Max.   : 18.140  </span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;                                          NA&#39;s   :36                       </span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;       ndvi       </span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;  Min.   :0.2817  </span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:1.0741  </span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt;  Median :1.3501  </span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;  Mean   :1.4709  </span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:1.8178  </span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;  Max.   :3.9126  </span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; </span></span></code></pre></div>
<p>We have some <code>NA</code>s in our response variable
<code>count</code>. These observations will generally be thrown out by
most modelling packages in . But as you will see when we work through
the tutorials, <code>mvgam</code> keeps these in the data so that
predictions can be automatically returned for the full dataset. The time
series and some of its descriptive features can be plotted using
<code>plot_mvgam_series()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot_mvgam_series</span>(<span class="at">data =</span> model_data, <span class="at">series =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="st">&#39;count&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="glms-with-temporal-random-effects" class="section level2">
<h2>GLMs with temporal random effects</h2>
<p>Our first task will be to fit a Generalized Linear Model (GLM) that
can adequately capture the features of our <code>count</code>
observations (integer data, lower bound at zero, missing values) while
also attempting to model temporal variation. We are almost ready to fit
our first model, which will be a GLM with Poisson observations, a log
link function and random (hierarchical) intercepts for
<code>year</code>. This will allow us to capture our prior belief that,
although each year is unique, having been sampled from the same
population of effects, all years are connected and thus might contain
valuable information about one another. This will be done by
capitalizing on the partial pooling properties of hierarchical models.
Hierarchical (also known as random) effects offer many advantages when
modelling data with grouping structures (i.e. multiple species,
locations, years etc…). The ability to incorporate these in time series
models is a huge advantage over traditional models such as ARIMA or
Exponential Smoothing. But before we fit the model, we will need to
convert <code>year</code> to a factor so that we can use a random effect
basis in <code>mvgam</code>. See <code>?smooth.terms</code> and
<code>?smooth.construct.re.smooth.spec</code> for details about the
<code>re</code> basis construction that is used by both
<code>mvgam</code> and <code>mgcv</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>model_data <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="co"># Create a &#39;year_fac&#39; factor version of &#39;year&#39;</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year_fac =</span> <span class="fu">factor</span>(year)) <span class="ot">-&gt;</span> model_data</span></code></pre></div>
<p>Preview the dataset to ensure year is now a factor with a unique
factor level for each year in the data</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(model_data)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Rows: 199</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; Columns: 7</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; $ series   &lt;fct&gt; PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, PP, P…</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; $ year     &lt;int&gt; 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2…</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; $ time     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18…</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; $ count    &lt;int&gt; 0, 1, 2, NA, 10, NA, NA, 16, 18, 12, NA, 3, 2, NA, NA, 13, NA…</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; $ mintemp  &lt;dbl&gt; -9.710, -5.924, -0.220, 1.931, 6.568, 11.590, 14.370, 16.520,…</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; $ ndvi     &lt;dbl&gt; 1.4658889, 1.5585069, 1.3378172, 1.6589129, 1.8536561, 1.7613…</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; $ year_fac &lt;fct&gt; 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2004, 2…</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">levels</span>(model_data<span class="sc">$</span>year_fac)</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;2004&quot; &quot;2005&quot; &quot;2006&quot; &quot;2007&quot; &quot;2008&quot; &quot;2009&quot; &quot;2010&quot; &quot;2011&quot; &quot;2012&quot; &quot;2013&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; [11] &quot;2014&quot; &quot;2015&quot; &quot;2016&quot; &quot;2017&quot; &quot;2018&quot; &quot;2019&quot; &quot;2020&quot;</span></span></code></pre></div>
<p>We are now ready for our first <code>mvgam</code> model. The syntax
will be familiar to users who have previously built models with
<code>mgcv</code>. But for a refresher, see <code>?formula.gam</code>
and the examples in <code>?gam</code>. Random effects can be specified
using the <code>s</code> wrapper with the <code>re</code> basis. Note
that we can also suppress the primary intercept using the usual
<code>R</code> formula syntax <code>- 1</code>. <code>mvgam</code> has a
number of possible observation families that can be used, see
<code>?mvgam_families</code> for more information. We will use
<code>Stan</code> as the fitting engine, which deploys Hamiltonian Monte
Carlo (HMC) for full Bayesian inference. By default, 4 HMC chains will
be run using a warmup of 500 iterations and collecting 500 posterior
samples from each chain. The package will also aim to use the
<code>Cmdstan</code> backend when possible, so it is recommended that
users have an up-to-date installation of <code>Cmdstan</code> and the
associated <code>cmdstanr</code> interface on their machines (note that
you can set the backend yourself using the <code>backend</code>
argument: see <code>?mvgam</code> for details). Interested users should
consult the <a href="https://mc-stan.org/docs/stan-users-guide/index.html" target="_blank"><code>Stan</code> user’s guide</a> for more information
about the software and the enormous variety of models that can be
tackled with HMC.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(count <span class="sc">~</span> <span class="fu">s</span>(year_fac, <span class="at">bs =</span> <span class="st">&#39;re&#39;</span>) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                <span class="at">data =</span> model_data)</span></code></pre></div>
<p>The model can be described mathematically for each timepoint <span class="math inline">\(t\)</span> as follows: <span class="math display">\[\begin{align*}
\boldsymbol{count}_t &amp; \sim \text{Poisson}(\lambda_t) \\
log(\lambda_t) &amp; = \beta_{year[year_t]} \\
\beta_{year} &amp; \sim \text{Normal}(\mu_{year}, \sigma_{year})
\end{align*}\]</span></p>
<p>Where the <span class="math inline">\(\beta_{year}\)</span> effects
are drawn from a <em>population</em> distribution that is parameterized
by a common mean <span class="math inline">\((\mu_{year})\)</span> and
variance <span class="math inline">\((\sigma_{year})\)</span>. Priors on
most of the model parameters can be interrogated and changed using
similar functionality to the options available in <code>brms</code>. For
example, the default priors on <span class="math inline">\((\mu_{year})\)</span> and <span class="math inline">\((\sigma_{year})\)</span> can be viewed using the
following code:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">get_mvgam_priors</span>(count <span class="sc">~</span> <span class="fu">s</span>(year_fac, <span class="at">bs =</span> <span class="st">&#39;re&#39;</span>) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                 <span class="at">data =</span> model_data)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">#&gt;                      param_name param_length           param_info</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co">#&gt; 1             vector[1] mu_raw;            1 s(year_fac) pop mean</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co">#&gt; 2 vector&lt;lower=0&gt;[1] sigma_raw;            1   s(year_fac) pop sd</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#&gt;                               prior                 example_change</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="co">#&gt; 1            mu_raw ~ std_normal();   mu_raw ~ normal(-0.7, 0.81);</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co">#&gt; 2 sigma_raw ~ student_t(3, 0, 2.5); sigma_raw ~ exponential(0.85);</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="co">#&gt;   new_lowerbound new_upperbound</span></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; 1             NA             NA</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#&gt; 2             NA             NA</span></span></code></pre></div>
<p>See examples in <code>?get_mvgam_priors</code> to find out different
ways that priors can be altered. Once the model has finished, the first
step is to inspect the <code>summary</code> to ensure no major
diagnostic warnings have been produced and to quickly summarise
posterior distributions for key parameters</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">summary</span>(model1)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; count ~ s(year_fac, bs = &quot;re&quot;) - 1</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000024869b48078&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; 199 </span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt;                 2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; s(year_fac).1   1.80 2.0   2.3 1.00  2660</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; s(year_fac).2   2.50 2.7   2.9 1.00  2901</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; s(year_fac).3   3.00 3.1   3.2 1.00  3803</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; s(year_fac).4   3.10 3.3   3.4 1.00  2872</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; s(year_fac).5   1.90 2.1   2.3 1.00  3127</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; s(year_fac).6   1.50 1.8   2.0 1.00  2977</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt; s(year_fac).7   1.80 2.0   2.3 1.00  2586</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt; s(year_fac).8   2.80 3.0   3.1 1.00  3608</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; s(year_fac).9   3.10 3.3   3.4 1.00  2846</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt; s(year_fac).10  2.60 2.8   2.9 1.00  2911</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt; s(year_fac).11  3.00 3.1   3.2 1.00  3026</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt; s(year_fac).12  3.10 3.2   3.3 1.00  2736</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt; s(year_fac).13  2.00 2.2   2.5 1.00  2887</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="co">#&gt; s(year_fac).14  2.50 2.6   2.8 1.00  3026</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co">#&gt; s(year_fac).15  1.90 2.2   2.4 1.00  2268</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co">#&gt; s(year_fac).16  1.90 2.1   2.3 1.00  2649</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co">#&gt; s(year_fac).17 -0.26 1.1   1.9 1.01   384</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt; GAM group-level estimates:</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="co">#&gt;                   2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co">#&gt; mean(s(year_fac)) 2.00 2.40   2.8 1.01   209</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="co">#&gt; sd(s(year_fac))   0.46 0.68   1.1 1.02   193</span></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co">#&gt;              edf Ref.df Chi.sq p-value    </span></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a><span class="co">#&gt; s(year_fac) 13.7     17   1637  &lt;2e-16 ***</span></span>
<span id="cb14-55"><a href="#cb14-55" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb14-56"><a href="#cb14-56" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb14-57"><a href="#cb14-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-58"><a href="#cb14-58" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb14-59"><a href="#cb14-59" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb14-60"><a href="#cb14-60" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb14-61"><a href="#cb14-61" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations ended with a divergence (0%)</span></span>
<span id="cb14-62"><a href="#cb14-62" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb14-63"><a href="#cb14-63" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb14-64"><a href="#cb14-64" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-65"><a href="#cb14-65" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:30:51 AM 2024.</span></span>
<span id="cb14-66"><a href="#cb14-66" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb14-67"><a href="#cb14-67" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb14-68"><a href="#cb14-68" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>The diagnostic messages at the bottom of the summary show that the
HMC sampler did not encounter any problems or difficult posterior
spaces. This is a good sign. Posterior distributions for model
parameters can be extracted in any way that an object of class
<code>brmsfit</code> can (see <code>?mvgam::mvgam_draws</code> for
details). For example, we can extract the coefficients related to the
GAM linear predictor (i.e. the <span class="math inline">\(\beta\)</span>’s) into a <code>data.frame</code>
using:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>beta_post <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(model1, <span class="at">variable =</span> <span class="st">&#39;betas&#39;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(beta_post)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; Rows: 2,000</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; Columns: 17</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).1`  &lt;dbl&gt; 2.21482, 1.93877, 2.29682, 1.74808, 1.95131, 2.24533,…</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).2`  &lt;dbl&gt; 2.76723, 2.60145, 2.79886, 2.65931, 2.71225, 2.68233,…</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).3`  &lt;dbl&gt; 2.94903, 3.09928, 3.09161, 3.10005, 3.18758, 3.16841,…</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).4`  &lt;dbl&gt; 3.26861, 3.25354, 3.33401, 3.27266, 3.32254, 3.28928,…</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).5`  &lt;dbl&gt; 2.24324, 2.07771, 2.09387, 2.20329, 2.09680, 2.22082,…</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).6`  &lt;dbl&gt; 1.84890, 1.72516, 1.75302, 1.59202, 1.89224, 1.89458,…</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).7`  &lt;dbl&gt; 2.06401, 2.20919, 1.88047, 2.09898, 2.12196, 2.01012,…</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).8`  &lt;dbl&gt; 3.02799, 2.87193, 3.06112, 3.03637, 2.92891, 2.91725,…</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).9`  &lt;dbl&gt; 3.21091, 3.28829, 3.20874, 3.15167, 3.27000, 3.29526,…</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).10` &lt;dbl&gt; 2.81849, 2.68918, 2.81146, 2.74898, 2.65924, 2.81729,…</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).11` &lt;dbl&gt; 3.06540, 3.01926, 3.12711, 3.12696, 3.06283, 3.10466,…</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).12` &lt;dbl&gt; 3.16679, 3.14866, 3.20039, 3.17305, 3.27057, 3.16223,…</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).13` &lt;dbl&gt; 2.12371, 2.38737, 2.07735, 2.22997, 2.08580, 2.14124,…</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).14` &lt;dbl&gt; 2.69768, 2.57665, 2.66538, 2.51016, 2.64938, 2.42338,…</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).15` &lt;dbl&gt; 2.21619, 2.14404, 2.24750, 2.14194, 2.10472, 2.24652,…</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).16` &lt;dbl&gt; 2.15356, 2.06512, 2.02614, 2.14004, 2.21221, 2.07094,…</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).17` &lt;dbl&gt; -0.0533815, 0.4696020, -0.2424530, 1.2282600, 1.16988…</span></span></code></pre></div>
<p>With any model fitted in <code>mvgam</code>, the underlying
<code>Stan</code> code can be viewed using the <code>code</code>
function:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">code</span>(model1)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; // Stan model code generated by package mvgam</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; data {</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; total_obs; // total number of observations</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; n; // number of timepoints per series</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; n_series; // number of series</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; num_basis; // total number of basis coefficients</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt;   matrix[total_obs, num_basis] X; // mgcv GAM design matrix</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt;   array[n, n_series] int&lt;lower=0&gt; ytimes; // time-ordered matrix (which col in X belongs to each [time, series] observation?)</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; n_nonmissing; // number of nonmissing observations</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt;   array[n_nonmissing] int&lt;lower=0&gt; flat_ys; // flattened nonmissing observations</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt;   matrix[n_nonmissing, num_basis] flat_xs; // X values for nonmissing observations</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt;   array[n_nonmissing] int&lt;lower=0&gt; obs_ind; // indices of nonmissing observations</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; parameters {</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt;   // raw basis coefficients</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt;   vector[num_basis] b_raw;</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt;   // random effect variances</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt;   vector&lt;lower=0&gt;[1] sigma_raw;</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt;   // random effect means</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt;   vector[1] mu_raw;</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt; transformed parameters {</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt;   // basis coefficients</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a><span class="co">#&gt;   vector[num_basis] b;</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co">#&gt;   b[1 : 17] = mu_raw[1] + b_raw[1 : 17] * sigma_raw[1];</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a><span class="co">#&gt; model {</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a><span class="co">#&gt;   // prior for random effect population variances</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a><span class="co">#&gt;   sigma_raw ~ student_t(3, 0, 2.5);</span></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a><span class="co">#&gt;   // prior for random effect population means</span></span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a><span class="co">#&gt;   mu_raw ~ std_normal();</span></span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a><span class="co">#&gt;   // prior (non-centred) for s(year_fac)...</span></span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a><span class="co">#&gt;   b_raw[1 : 17] ~ std_normal();</span></span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a><span class="co">#&gt;   {</span></span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a><span class="co">#&gt;     // likelihood functions</span></span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a><span class="co">#&gt;     flat_ys ~ poisson_log_glm(flat_xs, 0.0, b);</span></span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a><span class="co">#&gt; generated quantities {</span></span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a><span class="co">#&gt;   vector[total_obs] eta;</span></span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a><span class="co">#&gt;   matrix[n, n_series] mus;</span></span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a><span class="co">#&gt;   array[n, n_series] int ypred;</span></span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a><span class="co">#&gt;   // posterior predictions</span></span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a><span class="co">#&gt;   eta = X * b;</span></span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a><span class="co">#&gt;   for (s in 1 : n_series) {</span></span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a><span class="co">#&gt;     mus[1 : n, s] = eta[ytimes[1 : n, s]];</span></span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a><span class="co">#&gt;     ypred[1 : n, s] = poisson_log_rng(mus[1 : n, s]);</span></span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb16-55"><a href="#cb16-55" tabindex="-1"></a><span class="co">#&gt; }</span></span></code></pre></div>
<div id="plotting-effects-and-residuals" class="section level3">
<h3>Plotting effects and residuals</h3>
<p>Now for interrogating the model. We can get some sense of the
variation in yearly intercepts from the summary above, but it is easier
to understand them using targeted plots. Plot posterior distributions of
the temporal random effects using <code>plot.mvgam</code> with
<code>type = &#39;re&#39;</code>. See <code>?plot.mvgam</code> for more details
about the types of plots that can be produced from fitted
<code>mvgam</code> objects</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">type =</span> <span class="st">&#39;re&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="bayesplot-support" class="section level3">
<h3><code>bayesplot</code> support</h3>
<p>We can also capitalize on most of the useful MCMC plotting functions
from the <code>bayesplot</code> package to visualize posterior
distributions and diagnostics (see <code>?mvgam::mcmc_plot.mvgam</code>
for details):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">mcmc_plot</span>(<span class="at">object =</span> model1,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>          <span class="at">variable =</span> <span class="st">&#39;betas&#39;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&#39;areas&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>We can also use the wide range of posterior checking functions
available in <code>bayesplot</code> (see
<code>?mvgam::ppc_check.mvgam</code> for details):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">pp_check</span>(<span class="at">object =</span> model1)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>There is clearly some variation in these yearly intercept estimates.
But how do these translate into time-varying predictions? To understand
this, we can plot posterior hindcasts from this model for the training
period using <code>plot.mvgam</code> with
<code>type = &#39;forecast&#39;</code></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">type =</span> <span class="st">&#39;forecast&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAAbFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtrZmtv+PJyeQOgCQOjqQZgCQ2/+iUFC2ZgC2//+5fHzHmZnbkDrb25Db2//b/7bb/9vb///cvLz/tmb/25D//7b//9v////9DIPWAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAdgElEQVR4nO2di5qbOpZGfZLK6T7pSTIdV3DN9BxcKd7/HcfohiQkIYm9QeB/fV9SdrnYCLEshNDlMgDAwGXvBIBzArEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7BAK9YFngIJxAIsQCzAAsQCLEAswALEAixALMACxAIsQCzAAsQi5PLkx28Dsei4XGCWAWLRAbEsIBYdEMsCYhECryYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYKHMhI8f4kHr5dOvSDSIBSRFJrxdvskX98tf4WgQC0hKTPj4YXR6+/x3MBrEApISE35//aZf3sMXQ4gFFCixAAtldaw/fsoX719QxwJJykz4/VXeFYbLK4hFz2E7paIdq2mO242eJtUXA0k4oDlunpalemzIev9yuei61izaMTOhXZ5ErLdPv4b3P3+O94ffgn9w0ExomKN6Vd6O9foyvryjuQEkKRVLtWWhgRSkKTLh9SHVG0oskEGRCb+/fv5bFFn3SO0dYgFFoQl32ajwEosGsco5bP08CRpI9+a4LQpJINbeQKycaCfMIW4gVk60E+YQO6f0CmIBHiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZg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" width="60%" style="display: block; margin: auto;" /></p>
<p>If you wish to extract these hindcasts for other downstream analyses,
the <code>hindcast</code> function can be used. This will return a list
object of class <code>mvgam_forecast</code>. In the
<code>hindcasts</code> slot, a matrix of posterior retrodictions will be
returned for each series in the data (only one series in our
example):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hindcast</span>(model1)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">str</span>(hc)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt; List of 15</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt;  $ call              :Class &#39;formula&#39;  language count ~ s(year_fac, bs = &quot;re&quot;) - 1</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: 0x0000024869b48078&gt; </span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt;  $ trend_call        : NULL</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt;  $ family            : chr &quot;poisson&quot;</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt;  $ trend_model       : chr &quot;None&quot;</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt;  $ drift             : logi FALSE</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt;  $ use_lv            : logi FALSE</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt;  $ fit_engine        : chr &quot;stan&quot;</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt;  $ type              : chr &quot;response&quot;</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt;  $ series_names      : chr &quot;PP&quot;</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt;  $ train_observations:List of 1</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt;   ..$ PP: int [1:199] 0 1 2 NA 10 NA NA 16 18 12 ...</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt;  $ train_times       : num [1:199] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt;  $ test_observations : NULL</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt;  $ test_times        : NULL</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt;  $ hindcasts         :List of 1</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt;   ..$ PP: num [1:2000, 1:199] 11 3 14 9 10 9 15 9 11 10 ...</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:199] &quot;ypred[1,1]&quot; &quot;ypred[2,1]&quot; &quot;ypred[3,1]&quot; &quot;ypred[4,1]&quot; ...</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt;  $ forecasts         : NULL</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;mvgam_forecast&quot;</span></span></code></pre></div>
<p>You can also extract these hindcasts on the linear predictor scale,
which in this case is the log scale (our Poisson GLM used a log link
function). Sometimes this can be useful for asking more targeted
questions about drivers of variation:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hindcast</span>(model1, <span class="at">type =</span> <span class="st">&#39;link&#39;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">range</span>(hc<span class="sc">$</span>hindcasts<span class="sc">$</span>PP)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; [1] -1.53871  3.48355</span></span></code></pre></div>
<p>In any regression analysis, a key question is whether the residuals
show any patterns that can be indicative of un-modelled sources of
variation. For GLMs, we can use a modified residual called the <a href="https://www.jstor.org/stable/1390802" target="_blank">Dunn-Smyth,
or randomized quantile, residual</a>. Inspect Dunn-Smyth residuals from
the model using <code>plot.mvgam</code> with
<code>type = &#39;residuals&#39;</code></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">type =</span> <span class="st">&#39;residuals&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="automatic-forecasting-for-new-data" class="section level2">
<h2>Automatic forecasting for new data</h2>
<p>These temporal random effects do not have a sense of “time”. Because
of this, each yearly random intercept is not restricted in some way to
be similar to the previous yearly intercept. This drawback becomes
evident when we predict for a new year. To do this, we can repeat the
exercise above but this time will split the data into training and
testing sets before re-running the model. We can then supply the test
set as <code>newdata</code>. For splitting, we will make use of the
<code>filter</code> function from <code>dplyr</code></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>model_data <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(time <span class="sc">&lt;=</span> <span class="dv">160</span>) <span class="ot">-&gt;</span> data_train </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>model_data <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(time <span class="sc">&gt;</span> <span class="dv">160</span>) <span class="ot">-&gt;</span> data_test</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>model1b <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(count <span class="sc">~</span> <span class="fu">s</span>(year_fac, <span class="at">bs =</span> <span class="st">&#39;re&#39;</span>) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>                 <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>                 <span class="at">data =</span> data_train,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                 <span class="at">newdata =</span> data_test)</span></code></pre></div>
<p>We can view the test data in the forecast plot to see that the
predictions do not capture the temporal variation in the test set</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">plot</span>(model1b, <span class="at">type =</span> <span class="st">&#39;forecast&#39;</span>, <span class="at">newdata =</span> data_test)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>As with the <code>hindcast</code> function, we can use the
<code>forecast</code> function to automatically extract the posterior
distributions for these predictions. This also returns an object of
class <code>mvgam_forecast</code>, but now it will contain both the
hindcasts and forecasts for each series in the data:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model1b)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="fu">str</span>(fc)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#&gt; List of 16</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt;  $ call              :Class &#39;formula&#39;  language count ~ s(year_fac, bs = &quot;re&quot;) - 1</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: 0x0000024869b48078&gt; </span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt;  $ trend_call        : NULL</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt;  $ family            : chr &quot;poisson&quot;</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt;  $ family_pars       : NULL</span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt;  $ trend_model       : chr &quot;None&quot;</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co">#&gt;  $ drift             : logi FALSE</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co">#&gt;  $ use_lv            : logi FALSE</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co">#&gt;  $ fit_engine        : chr &quot;stan&quot;</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="co">#&gt;  $ type              : chr &quot;response&quot;</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co">#&gt;  $ series_names      : Factor w/ 1 level &quot;PP&quot;: 1</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co">#&gt;  $ train_observations:List of 1</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="co">#&gt;   ..$ PP: int [1:160] 0 1 2 NA 10 NA NA 16 18 12 ...</span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co">#&gt;  $ train_times       : num [1:160] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="co">#&gt;  $ test_observations :List of 1</span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt;   ..$ PP: int [1:39] NA 0 0 10 3 14 18 NA 28 46 ...</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co">#&gt;  $ test_times        : num [1:39] 161 162 163 164 165 166 167 168 169 170 ...</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="co">#&gt;  $ hindcasts         :List of 1</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt;   ..$ PP: num [1:2000, 1:160] 12 7 15 10 5 13 13 8 3 11 ...</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:160] &quot;ypred[1,1]&quot; &quot;ypred[2,1]&quot; &quot;ypred[3,1]&quot; &quot;ypred[4,1]&quot; ...</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co">#&gt;  $ forecasts         :List of 1</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="co">#&gt;   ..$ PP: num [1:2000, 1:39] 7 6 8 8 10 14 13 5 10 7 ...</span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:39] &quot;ypred[161,1]&quot; &quot;ypred[162,1]&quot; &quot;ypred[163,1]&quot; &quot;ypred[164,1]&quot; ...</span></span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;mvgam_forecast&quot;</span></span></code></pre></div>
</div>
<div id="adding-predictors-as-fixed-effects" class="section level2">
<h2>Adding predictors as “fixed” effects</h2>
<p>Any users familiar with GLMs will know that we nearly always wish to
include predictor variables that may explain some of the variation in
our observations. Predictors are easily incorporated into GLMs / GAMs.
Here, we will update the model from above by including a parametric
(fixed) effect of <code>ndvi</code> as a linear predictor:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(count <span class="sc">~</span> <span class="fu">s</span>(year_fac, <span class="at">bs =</span> <span class="st">&#39;re&#39;</span>) <span class="sc">+</span> </span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>                  ndvi <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>                <span class="at">data =</span> data_train,</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>                <span class="at">newdata =</span> data_test)</span></code></pre></div>
<p>The model can be described mathematically as follows: <span class="math display">\[\begin{align*}
\boldsymbol{count}_t &amp; \sim \text{Poisson}(\lambda_t) \\
log(\lambda_t) &amp; = \beta_{year[year_t]} + \beta_{ndvi} *
\boldsymbol{ndvi}_t \\
\beta_{year} &amp; \sim \text{Normal}(\mu_{year}, \sigma_{year}) \\
\beta_{ndvi} &amp; \sim \text{Normal}(0, 1) \end{align*}\]</span></p>
<p>Where the <span class="math inline">\(\beta_{year}\)</span> effects
are the same as before but we now have another predictor <span class="math inline">\((\beta_{ndvi})\)</span> that applies to the
<code>ndvi</code> value at each timepoint <span class="math inline">\(t\)</span>. Inspect the summary of this model</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">summary</span>(model2)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co">#&gt; count ~ ndvi + s(year_fac, bs = &quot;re&quot;) - 1</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000024869b48078&gt;</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a><span class="co">#&gt; 199 </span></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a><span class="co">#&gt;                2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a><span class="co">#&gt; ndvi           0.32 0.39  0.46    1  1835</span></span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a><span class="co">#&gt; s(year_fac).1  1.10 1.40  1.70    1  2267</span></span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a><span class="co">#&gt; s(year_fac).2  1.80 2.00  2.20    1  2518</span></span>
<span id="cb29-32"><a href="#cb29-32" tabindex="-1"></a><span class="co">#&gt; s(year_fac).3  2.20 2.40  2.60    1  2140</span></span>
<span id="cb29-33"><a href="#cb29-33" tabindex="-1"></a><span class="co">#&gt; s(year_fac).4  2.30 2.50  2.70    1  1978</span></span>
<span id="cb29-34"><a href="#cb29-34" tabindex="-1"></a><span class="co">#&gt; s(year_fac).5  1.20 1.40  1.60    1  2341</span></span>
<span id="cb29-35"><a href="#cb29-35" tabindex="-1"></a><span class="co">#&gt; s(year_fac).6  1.00 1.30  1.50    1  2318</span></span>
<span id="cb29-36"><a href="#cb29-36" tabindex="-1"></a><span class="co">#&gt; s(year_fac).7  1.20 1.40  1.70    1  2447</span></span>
<span id="cb29-37"><a href="#cb29-37" tabindex="-1"></a><span class="co">#&gt; s(year_fac).8  2.10 2.30  2.50    1  2317</span></span>
<span id="cb29-38"><a href="#cb29-38" tabindex="-1"></a><span class="co">#&gt; s(year_fac).9  2.70 2.90  3.00    1  1916</span></span>
<span id="cb29-39"><a href="#cb29-39" tabindex="-1"></a><span class="co">#&gt; s(year_fac).10 2.00 2.20  2.40    1  2791</span></span>
<span id="cb29-40"><a href="#cb29-40" tabindex="-1"></a><span class="co">#&gt; s(year_fac).11 2.30 2.40  2.60    1  2214</span></span>
<span id="cb29-41"><a href="#cb29-41" tabindex="-1"></a><span class="co">#&gt; s(year_fac).12 2.50 2.70  2.80    1  2010</span></span>
<span id="cb29-42"><a href="#cb29-42" tabindex="-1"></a><span class="co">#&gt; s(year_fac).13 1.40 1.60  1.80    1  2976</span></span>
<span id="cb29-43"><a href="#cb29-43" tabindex="-1"></a><span class="co">#&gt; s(year_fac).14 0.68 2.00  3.30    1  1581</span></span>
<span id="cb29-44"><a href="#cb29-44" tabindex="-1"></a><span class="co">#&gt; s(year_fac).15 0.69 2.00  3.30    1  1874</span></span>
<span id="cb29-45"><a href="#cb29-45" tabindex="-1"></a><span class="co">#&gt; s(year_fac).16 0.56 2.00  3.40    1  1442</span></span>
<span id="cb29-46"><a href="#cb29-46" tabindex="-1"></a><span class="co">#&gt; s(year_fac).17 0.60 2.00  3.30    1  1671</span></span>
<span id="cb29-47"><a href="#cb29-47" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-48"><a href="#cb29-48" tabindex="-1"></a><span class="co">#&gt; GAM group-level estimates:</span></span>
<span id="cb29-49"><a href="#cb29-49" tabindex="-1"></a><span class="co">#&gt;                   2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb29-50"><a href="#cb29-50" tabindex="-1"></a><span class="co">#&gt; mean(s(year_fac))  1.6 2.0   2.3 1.01   417</span></span>
<span id="cb29-51"><a href="#cb29-51" tabindex="-1"></a><span class="co">#&gt; sd(s(year_fac))    0.4 0.6   1.0 1.01   417</span></span>
<span id="cb29-52"><a href="#cb29-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-53"><a href="#cb29-53" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb29-54"><a href="#cb29-54" tabindex="-1"></a><span class="co">#&gt;              edf Ref.df Chi.sq p-value    </span></span>
<span id="cb29-55"><a href="#cb29-55" tabindex="-1"></a><span class="co">#&gt; s(year_fac) 10.9     17    265  &lt;2e-16 ***</span></span>
<span id="cb29-56"><a href="#cb29-56" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb29-57"><a href="#cb29-57" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb29-58"><a href="#cb29-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-59"><a href="#cb29-59" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb29-60"><a href="#cb29-60" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb29-61"><a href="#cb29-61" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb29-62"><a href="#cb29-62" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations ended with a divergence (0%)</span></span>
<span id="cb29-63"><a href="#cb29-63" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb29-64"><a href="#cb29-64" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb29-65"><a href="#cb29-65" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb29-66"><a href="#cb29-66" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:32:01 AM 2024.</span></span>
<span id="cb29-67"><a href="#cb29-67" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb29-68"><a href="#cb29-68" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb29-69"><a href="#cb29-69" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>Rather than printing the summary each time, we can also quickly look
at the posterior empirical quantiles for the fixed effect of
<code>ndvi</code> (and other linear predictor coefficients) using
<code>coef</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">coef</span>(model2)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="co">#&gt;                     2.5%       50%     97.5% Rhat n_eff</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="co">#&gt; ndvi           0.3219980 0.3897445 0.4574249    1  1835</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="co">#&gt; s(year_fac).1  1.1251775 1.3947750 1.6786482    1  2267</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="co">#&gt; s(year_fac).2  1.8029418 2.0028550 2.1983995    1  2518</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="co">#&gt; s(year_fac).3  2.1828568 2.3833850 2.5667087    1  2140</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co">#&gt; s(year_fac).4  2.3216057 2.5041200 2.6876810    1  1978</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="co">#&gt; s(year_fac).5  1.1947695 1.4253400 1.6404350    1  2341</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="co">#&gt; s(year_fac).6  1.0302375 1.2719450 1.5071408    1  2318</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="co">#&gt; s(year_fac).7  1.1527560 1.4237300 1.6631115    1  2447</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a><span class="co">#&gt; s(year_fac).8  2.1024232 2.2693150 2.4510250    1  2317</span></span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a><span class="co">#&gt; s(year_fac).9  2.7252610 2.8546400 2.9843943    1  1916</span></span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a><span class="co">#&gt; s(year_fac).10 1.9848580 2.1821250 2.3831660    1  2791</span></span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a><span class="co">#&gt; s(year_fac).11 2.2655225 2.4353150 2.6026625    1  2214</span></span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a><span class="co">#&gt; s(year_fac).12 2.5445065 2.6914450 2.8342325    1  2010</span></span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a><span class="co">#&gt; s(year_fac).13 1.3758873 1.6138700 1.8464015    1  2976</span></span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a><span class="co">#&gt; s(year_fac).14 0.6763885 2.0087850 3.2876045    1  1581</span></span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a><span class="co">#&gt; s(year_fac).15 0.6927259 1.9904050 3.3384072    1  1874</span></span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a><span class="co">#&gt; s(year_fac).16 0.5608287 1.9907700 3.3807122    1  1442</span></span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a><span class="co">#&gt; s(year_fac).17 0.5989812 2.0276550 3.3404602    1  1671</span></span></code></pre></div>
<p>Look at the estimated effect of <code>ndvi</code> using using a
histogram. This can be done by first extracting the posterior
coefficients:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>beta_post <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(model2, <span class="at">variable =</span> <span class="st">&#39;betas&#39;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(beta_post)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a><span class="co">#&gt; Rows: 2,000</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="co">#&gt; Columns: 18</span></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="co">#&gt; $ ndvi             &lt;dbl&gt; 0.356033, 0.419265, 0.401340, 0.408547, 0.365358, 0.4…</span></span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).1`  &lt;dbl&gt; 1.35402, 1.49105, 1.26309, 1.22981, 1.55560, 1.46103,…</span></span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).2`  &lt;dbl&gt; 2.08371, 2.03387, 1.81765, 1.82714, 2.20838, 2.12063,…</span></span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).3`  &lt;dbl&gt; 2.43563, 2.31586, 2.36554, 2.40869, 2.38362, 2.24695,…</span></span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).4`  &lt;dbl&gt; 2.66322, 2.44635, 2.48168, 2.50480, 2.57476, 2.42963,…</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).5`  &lt;dbl&gt; 1.40050, 1.33274, 1.38421, 1.36805, 1.40633, 1.34501,…</span></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).6`  &lt;dbl&gt; 1.431430, 1.341260, 1.332540, 1.300360, 1.243430, 1.2…</span></span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).7`  &lt;dbl&gt; 1.46134, 1.25454, 1.42857, 1.41534, 1.40782, 1.40564,…</span></span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).8`  &lt;dbl&gt; 2.38557, 2.27800, 2.25584, 2.26500, 2.31796, 2.20621,…</span></span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).9`  &lt;dbl&gt; 2.80751, 2.83031, 2.73530, 2.78705, 2.84959, 2.77223,…</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).10` &lt;dbl&gt; 2.09385, 2.08026, 2.22424, 2.23312, 2.18318, 2.09513,…</span></span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).11` &lt;dbl&gt; 2.41232, 2.36077, 2.43681, 2.47770, 2.51130, 2.44691,…</span></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).12` &lt;dbl&gt; 2.74478, 2.67146, 2.68431, 2.72280, 2.80983, 2.60829,…</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).13` &lt;dbl&gt; 1.63171, 1.55937, 1.71905, 1.70544, 1.52311, 1.48743,…</span></span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).14` &lt;dbl&gt; 2.628480, 1.679080, 1.817260, 1.805210, 1.732590, 2.2…</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).15` &lt;dbl&gt; 2.5601600, 1.3652300, 1.7714600, 1.7648100, 2.4456900…</span></span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).16` &lt;dbl&gt; 1.345990, 2.422970, 1.949050, 1.983840, 2.160030, 1.8…</span></span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a><span class="co">#&gt; $ `s(year_fac).17` &lt;dbl&gt; 2.206790, 1.674940, 1.699170, 1.657840, 2.982300, 1.1…</span></span></code></pre></div>
<p>The posterior distribution for the effect of <code>ndvi</code> is
stored in the <code>ndvi</code> column. A quick histogram confirms our
inference that <code>log(counts)</code> respond positively to increases
in <code>ndvi</code>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">hist</span>(beta_post<span class="sc">$</span>ndvi,</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">max</span>(<span class="fu">abs</span>(beta_post<span class="sc">$</span>ndvi)),</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>              <span class="fu">max</span>(<span class="fu">abs</span>(beta_post<span class="sc">$</span>ndvi))),</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&#39;darkred&#39;</span>,</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(beta[NDVI]),</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>     <span class="at">yaxt =</span> <span class="st">&#39;n&#39;</span>,</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lwd =</span> <span class="fl">2.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAAflBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZpA6kNtmAABmADpmOgBmOjpmOpBmZmZmkLZmtttmtv+LAACQOgCQOjqQOmaQZgCQtpCQ2/+2ZgC2tma225C2///bkDrb25Db/9vb////tmb/25D/27b//7b//9v////capnJAAAACXBIWXMAAA9hAAAPYQGoP6dpAAALlElEQVR4nO3cC29T6RlFYTPATNvQ6S1l2pIWz5BM4v//BxvnBknYAuucN6wd1iOERJA+H+8sHMcR3uykAZtvfQF6ngxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxLIwxrkY37BQ6ziGElDrOIYSUOs4hhJQ6ziGElDrOIYSUOs4hhJQ6ziGElDrOIYSUOs4hhJQ6ziGElDrOIYSUOs0hRWP+88UQ31zMMkmElPcMgGVbSMwySYSU9wyAZVtIzDJJhJT3DIBlW0jMMkmElPcMgGVbSMwySYSU9wyAZVtIzDJJhJT3DIBlW0jMMkmElPcMgGVbSMwySYSU9wyAZVtIzDJJhJT3DIBlW0jMMkmElPcMgGVbSMwySYSU9wyAZVtIzDJJhJT3DIBlW0jMMkmElPcMgGVbSMwySYSU9wyAZVtIzDFJjWE9TWM8wSIaV9AyDZFhJzzBIhpX0DINkWEnPMEiGlfQMg2RYSc8wSIaV9AyDZFhJzzBIhpX0DINkWEnPMEj8sB73ZFgFDCvBD8NmWAl+GDbDSvDDsBlWgh+GzbAS/DBshpXgh2EzrAQ/DJthJfhh2AwrwQ/DZlgJfhg2w0rww7AZVoIfhs2wEvwwbIaV4IdhM6wEPwybYSX4YdgMK8EPw2ZYCX4YNsNK8MOwGVaCH4bNsBL8MGyGleCHYTOsBD8Mm2El+GHYDCvBD8NmWAl+GDbDSvDDsBlWgh+GzbAS/DBshpXgh2EzrAQ/DJthJfhh2AwrwQ/DZlgJfhg2w0rww7AZVoIfhs2wEvwwbIaV4IdhM6wEPwybYSX4YdgMK8EPw2ZYCX4YNsNK8MOwGVaCH4bNsBL8MGyGleCHYTOsBD8Mm2El+GHYDCvBD8NmWAl+GDbDSvDDsBlWgh+GzbAS/DBshpXgh2EzrAQ/DJthJfhh2AwrwQ/DZlgJfhg2w0rww7AZVoIfhs2wEvwwbIaV4IdhM6wEPwybYSX4YdgMK8EPw2ZYCX4YNsNK8MOwGVaCH4bNsBL8MGyGleCHYTOsBD8Mm2El+GHYDCvBD8NmWAl+GDbDSvDDsBlWgh+GzbAS/DBshpXgh2EzrAQ/DJthJfhh2AwrwQ/DZlgJfhg2w0rww7AZVoIfhs2wEvwwbIaV4IdhM6wEPwybYSX4YdgMK8EPw2ZYCX4YNsNK8MOwccPKPT1NYdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpoNhJdhhOhhWgh2mg2El2GE6GFaCHaaDYSXYYToYVoIdpgMurIfVGFYnw0pow5R5HmFNFEYbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0YcoYVkIbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0YcoYVkIbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0YcoYVkIbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0YcoYVkIbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0YcoYVkIbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0YcoYVkIbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0YcoYVkIbpoxhJbRhyhhWQhumjGEltGHKGFZCG6aMYSW0Yco8s7BWLIw2TBlKWLERw+pkWAlkmFaGlUCGaWVYCWSYVoaVQIZpZVgJZJhWhpVAhmllWAlkmFaGlUCGaWVYCWSYVoaVQIZpZVgJZJhWhpVAhmllWAlkmFaGlUCGaWVYCWSYVt84rC83YlidnmtYywszrEUMKzGsRSjPsXgcZhHDShxmEcNKHGYRw0ocZhHDShxmEcNKHGYRw0ocZhHDShxmEcNKHGYRw0ocZhHDSljDbDTviT6VT3MzX+VbL/6deKJP5tPczFcZu89zY/ZdsmE1HFx4yYbVcHDhJRtWw8GFl2xYDQcXXrJhNRxceMmG1XBw4SUbVsPBhZdsWA0HF17y9xiWnhHD0gjD0gjD0gjD0gjD0gjD0gjD0gjD0gjD0gjD0gjD0gjD0ghGWKebzebVpx84eflh4ODtw5tZ59hHV7/Wwatd7+DCCSKs083x7vzNq08/sM7dvn/wdnN0+ZEVPlP3j3109WsdvNr1Di4cEcK6eLu/x6cv3t1+4PzNOnf7/sHXw25/eL/usY+ufq2DV7vewYUzQlhnr4/ufr+yffnvVe72/YPPXh/vz15ewMNjH1z9egevdL2DC2eMsPYLnr+5vdtnP75b5xnAw4P3TpY/Atw/9nM3ssrB11a43sGFM0JY+ycAu49PAS7eHq301PLBwXv75y3rHvuZG1nn4CtrXO/gwhkwrO3lXZ4Ka7Xn7k8U1orP3UcWzr5tWPvvpzdHD760/Phu+TfDnzt4t9a//6f7UrjO9T664jUW/hLCI9btU8vjqz9tr99sZ83nrMc3fz5Z5/N0/9iHN7Lawatd7+DCGSGsz3zDvs6/pwcHbzcrfPIfHTv2csNq1zu4cEYI6zMvMa50t+8dvMorAo+PHXuBdL3rHVw4QoR19wOH09t/o2v/SGd/8IpfAe5f78CPdFa+3sGFE0ZYenYMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMMSyMM6yBnP282f5r9D3nPhGEdYv+fky+m/6vn82BYh9i//8/1m7XoCwzrEIb11QzrEFdhnfql8CsY1iG2L397++IPPmB9BcM6xNUj1u9/Ob55D7Ozn96fvd6/I8zx7uLt1Qf++OtPK7wX7XNgWIe4Cmv/+9nr/ZsZ78Pah3T+5ni33b+Z1fbozLCuGdYhrsM6/eGyp/+++hjW5SPVh8tfu4tf3hnWDcM6xCdhvT85/hjW+Z/fXUZ11ZdhXTOsQ2xf/P3D7vc3R/ukzv/64S6sfVWXXwu3V3/xrS+SwbAOsX3568+bF/+4+iJ4/YTq7hHr8uHqt/2DlmFdM6xDbG9fwtr3c/HLf27D2r+0dfGv/10+zTKsG4Z1iHth7fbfGt59V3j5l3872hnWLcM6xMntmyNf97P94e51rN3Nj3oM64ZhHeJkpXfd/g4YlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkYYlkb8HzpmAoV9lehsAAAAAElFTkSuQmCC" width="60%" style="display: block; margin: auto;" /></p>
<div id="marginaleffects-support" class="section level3">
<h3><code>marginaleffects</code> support</h3>
<p>Given our model used a nonlinear link function (log link in this
example), it can still be difficult to fully understand what
relationship our model is estimating between a predictor and the
response. Fortunately, the <code>marginaleffects</code> package makes
this relatively straightforward. Objects of class <code>mvgam</code> can
be used with <code>marginaleffects</code> to inspect contrasts,
scenario-based predictions, conditional and marginal effects, all on the
outcome scale. Like <code>brms</code>, <code>mvgam</code> has the simple
<code>conditional_effects</code> function to make quick and informative
plots for main effects, which rely on <code>marginaleffects</code>
support. This will likely be your go-to function for quickly
understanding patterns from fitted <code>mvgam</code> models</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">conditional_effects</span>(model2)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAA1VBMVEUAAAAAADoAAGYAOpAAZrYDAwMHBwcPDw8TExMfHx8hISEzMzM6AAA6ADo6AGY6kNs+Pj4/Pz9NTU1NTW5NTY5NbqtNjshmAABmADpmtv9uTU1uTW5uTY5ubo5ubqtuq+R3d3d/f3+OTU2OTW6OTY6Obk2ObquOyP+QOgCQkGaQtpCQ2/+rbk2rbm6rjk2ryKur5OSr5P+2ZgC225C2/9u2///Ijk3I///bkDrb/9vb///kq27k///q6ur/tmb/yI7/25D/5Kv//7b//8j//9v//+T///+43Eq0AAAACXBIWXMAAA9hAAAPYQGoP6dpAAATg0lEQVR4nO2dC2PbRBKATYHLlcI1DpRC4fqESw/KHeWuTY/Ebd00+v8/6WQnfsiWpX3M7M5K3wdtHWctSzufR7OrhycVgAKT3CsAwwSxQAXEAhUQC1RALFABsUAFX7EQEZxALFABsUAFxAIVEAtUQCxQAbFABcQCFRALVEAsUAGxQAXEAhUQC1RALFABsUAFxAIVEAtUQCxQwaRY0+k0xduAIhbFmj558gSzCsdbrB001gmxBgAZC1SwKBY11gAwKRaUD2KBCogFKiAWqIBYoAJigQqIBSogFqiAWKACYoEKiAUqIBaogFigAmKBCogFKiAWqIBYoAJigQqIBSogFqiAWKACYoEKiAUqdIly9eLk65dVdfn05N6FS3uANV2ivD6t3t27uHpxWp1/69JeFS5iLYsOUS5/Olv9M//xrL+9Klx2Xxgdoswf/muxK5w/vKgun9W7xOpOTYqbgrSBWIXRJdaD04VV9d7wRqye9qogVmF0ZqylUZuM1dNeF2qssuiqsf6xNMpGjQWF0TMqrNPV1YtHFkaFUBZdolw+PfnmjHksCIGZd1ABsUAFxAIVEAtUKFssJrfMUrRYTMfbxeIXCDiDWHYhY4EKRYtFjWWXssUCsyAWqIBYoAJigQqIBSogFqiAWKACYoEKiAUqIBaogFigAmKBCogFKiAWqIBYoAJigQqIBSogFqiAWKACYoEKiAUqIBaogFigAmKBCogFKiAWqIBYoAJigQqIBSogFqiAWKACYoEKiAUqIBaogFigAmKBCogFKpgXixsjl4l1sbiVe6FY/2YKxCoUMhaoYF0saqxCMS8WlAligQqIBSogFqiAWKACYoEKiAUqIFYPzKOFgVjdMPMfiPVjhblBrEDIWN0gViCI1QM1VhiIBSqUJhYJpBAKE4uSpxQKGxUiVimQsSCAWW+LwsSixrLAbDY8sSA7sxlixRKdHweYYGeIFU10RTe8knA20xJrTMcKEWuH2UxPrLA1KhPEajJDLCGosbaYzRALxJnNEAvkmSEWyLOrFWJBMPsyIRYIgFigQbdXiAVh9HiFWBBEn1eIBSH0eoVYEEC/V4gFASAWaODgFWKBNy5eIZYgQzpToQMnrxBLjoGdW3UIN684g1SOcYjl6BUZS45RiOXqFWIJMvway1krxAJ3PLRCLHDGyyvEAjf8tEIscMJXK8QCF/y9QizoJUArxII+grRCLOgmUCvEgi6CtUIsOEyEVogFB4nyCrGgnTitEAtaidUKsaCNeK8QC/YQ0AqxYBcRrRALdhDyCrFgGymtosW6enFaVZdPT+5duLUHy8hpFS3W+cnpUq7zb93awxKbZ8dLehUp1vzvP59Wlz+dVfMfz1zawxKT1/OIahUp1tVvv9fZav7worp89rL++U7NeK8rdMegWMJaRYp1/mixG3x3byVWX3u4BrGqTlHqVHXVyFg97WGFuRpL3Ksosc5PFjyixioeea8kphuuXjzKMCpU+tDnzyUZ1kDBq2LnsZTKlPzVT4Y10PCq2LvNIJYYKl4Ve0gHscRArAbUWELoeFWuWCCDklfjFit/esqOllejFit/QZUdNa+KHRVKMFax9GxSFStsY3OAWIilwzhrrCRejVusUZLGK8QaG4m8QqyRkcorxBoXybxCrHGBWKBBOq8Qa0wk9GowYqWdkjI5Ada7Uim9GopYaSfRTU7Z965UUq+GcqwQsQ6sVFqbVMXybC8DYiGWDtRYrSuVzSs/sT7c/37xz9tbr9zaQ2byeYVYQyajVz5ivVkX5J85tYfM5PQqKGM5t4ecZPVqMMU77FGSWO+/XO4KqbEKIK9XfmJ9fN5VXe23h3xk9ooaa4HJaak4Dgb8+PjYnlgfnw9SLJMT6XEc9urx48dJzOpdxYYonTNYN+3Lua5wxVDEcom3TbE+3J8MsXgfiFhO8U4klkNCGcN0wxBqLNeQp6ixJhPmsQaCuis+TBZ/9a5y4bvCyGRURi7LbVKDydKrkIz14btfvdrnJLJ8KqL6yixSkxutwnaFbz/9s6O9qVHhUMXKKk8Hk/Wj3k1oE6ucXeFAxcqoTheTjVdBYv3RmbEi+kuBIdZY+czpZFursOL9k3JqrAGSy5s+Js0fe7eD6YZ2ptOjZTYbyE2OY5nseIVYgUyf3J7eruuvxFVYFmn62dPKW6zl6cl3O9ubGhWqkUWsDMo4sa+Vr1hvFuPBD/e7zBqqSTvkECu5MG60pKsZV+kEk7zGSu2LI+1aIVYppLXFnQNajX5XaHKeqoWUrnhwKF3NNIr3uB5Mi9WZ9R0SquJDh1aDudtMIEWIlUwUT7q0Gvs8VgliJdLEl850NfMV6+Pzu33XgBUllv0aK40l3vRp5SvWHwunus0qSyzjpHAkhF6tmG5IQ2Bi1DckiP50NUOsJISVcuqChOGklcY8VkmjwkS4i6UsRTBbAXV8Re+mNs14O6x5rEQ4i6UqRzjONm3Ru62Dnm5IhVuNJW+ECCFaIZYdpH0QIkyrgYu1ThQ7GcPi7JWsDlKEajVssdalzU6NY3C+XVIGOcK1GvaxwmLEklNBlAityFgWkBJBlph0NRu2WGXUWEIeCBOp1cDFKgARC+SJ1Wr0YuXOXQIOKBCdrmZjFytztRUfPg0ktBr2qLCfrGJJhE8BEa3IWPnEkomfNDLpajZ2sfLVWELhE0ZMq9GLlQmx8Mkip5V5sVozSu6h3IawNREMXwiH7pssmK5m1sVqrYHsTJwHrYlk9EI4cKd3Wa2sjwqHIpZszOJoF0tYKzJWFK5rIh20KNrEkk5XM+tiDaLGEo9ZJHs1loJW5sUqH4WYCaOhFWIF4ZEyVYImiUq6miFWCOVfzbVGSyvro0KbdIulFSkxtqOj9y69vUjG2qNLLL1ICaEp0za9vYhY+xyssdLELIJUWiGWJKliFkw6rRBLjnQxCySlVogVR8pIxZJUK8SKI22sYkibrmaIFUXiWIWTXCvEiiF5sEJJr9XQxDo6Omo+sZoY0Dhuvei+QyfNWSJDupoNTKyj2p+GWaupTI0zbRa9d+CkOUvk0Wpgh3RSirXsPftiZdKKjBXMsvesi5UrXc0GJlbCGuum+0zXWBm1GppYycgYMWdyaoVYN2xlNJfkljVkbmRNVzPEumarBnMpx/KGzIXcWg1sVBjMYbFyx8eHJCfwudLb5+POWLnD44EFm7bo7fNRiHWgxsodHA+MaYVYHeQOjQfmtCpArFxXp+YOjAcGtbIvVqbr6XOHxQOTWtkfFSYUK3cofDA1AGylt7tHk7FyR8IDszZt0dvfI6mxcsfBgxK0KkCsJOSOgg9FaIVYS9o65vj4rxbPXCgjXc0QqzqQro4ff3H8hblzrYrRyv6oUBSPfjEklv0R4AaPYAwoY/n0kBmxCrBpg080BiOWZx/ZqLEGq1W3KPMHJyenVXX59OTehUv7jOTu9DCGq1WnKJfPXlbzH15evTitzr91aJ+RmfHT01sZcLqqOkV5t7Dp9enlT2fV/Mez/vbZWGy49Qtq9hi2Vr2i1Flr/vBimbyq6k6NlVHh7qaXIdZAR4BtdJtx9eJR9e7eSqz+9snY64YSxCrApg2xEeoU5fLpo7qEf2hOrLaOMF9jjUqrvlFhPSaszNVYuTs9jHFp1SnKtVfL3aGlUaFefyomvZGlq6pTlPOTBae25rEU+1OvTBufVqUdK1TtUTWxRqhVYYd0dPtUSawxpquqKLHUe1WjxhqpVgWJlbvTwxirVuWIpdCROoPA7aWONl1VpYil0ZE6JdXWUsesleFRoXpXqoi13TXSy5ZBLWA7WMhYbZur38MKYtUyWT9mqRC+dvKL1bbFSfpYusa6zlGmj1mKB+8wucVq2+h8HR+D0V3fFsKh6yazWG0bvv755rz0Azlg/fTqQaNd65OKWC2ptpCNXB9ZxWrb9s0PN1fSHKha1k+vHjTatT6pB1rtkXFU2NcV1sUyPwDcIiJMgeTLWL2dYVusAmzaIBY0d3KJ5dIdhmsstOojj1i5uzoWtOoli1jxvdWXiFQHgwVMWG2QiFcIGcQS6K2+0km3Zld/CznioxWKwqgwQX8lF2t/BGhXLAkt4pHPWCn6LrFYbaW6WbHCPBBHWqxEvZeyxjowArRZY4V6II6sWLm7VQNGgEGIipW7X31wTDjLdJV1DOpBhAfiCIqVu1u9cCuRbiYWMo5BPYjyQByxUWHubvVkT4bdDdsaARoWS1YGScQyVp6ODWZHhs5DNHbFigy+JmMVy+tqGqM1VmTodRmtWFuUNO7bEBl4bQyLlSgPFHWiwobIuKtjV6w0lQtaKWF3VKh5jl5B535ukA28NuPLWEXJtEVkoFNjVyydGgutEmFYLA3QKhWjEmuTrsSyodOCIr+4xz06ib6v1uWNRiTW1l5QrH5zWlDcV415BCfZN2w7vJHdUWEMHQf+llgXyz/US4oW69AvIqIjTX+Bblwsz5isQSxNnMZ9lmssz4hsQ42lR6HjvjWe8TCLcbF8M4vCNJX8dFrXEiPDaQfbYnnWQhqzn/IHADqWGBlMS9geFR6OQd+4L8EqCC1RNp5mKDNjJTwwoy1WZPzMYlus9nIk7fE+1RorMnqGMS5WG6WP+zZExs40xYklk66201C2qwIjQ2ebwsQS2gtulzm5rrGJDJx1jI0KWwd78uO+XGLJxs40pjJWsqo8k1iRsSoKQ2KlHOzlqLEiI1UYdsQazmCvlcg4FYcVsSTSleOZBlmuao4MU3nYEEtkL+h4blSO+zBEBqlEko8K9QZ7FsSSDU7JJM5YmgW6AbEigzEkkoqlPO7LXWNFhmJYpBRr2OO+yEAMDSmxpr0f9MB0tZVBrNzqs5XYQAwNIbGmT3pKk9C94FbNY+RWn61Ex2FwCI0Kp0+UDvKZE0s6AEMlVcYKxZpY0R0+FtLVWIGYqrFie3tE2Jh5L4PIrh4XxYhFuiqLUsTKXmBF9vPoMHYG6UHUxZLtViBjXRPZjbBLKWLp1liRnQj7FCOWIpFdCG0YESvnmG+zDaK3l0p2ryqb2BDLxhezid4QL9nd9YxiY1SoJ5bPtiGWIAPPWF7bhliC2BBLqcby7QxqLDmMiKVBZM9AFPJi5T+od03flnRllJFnGwnExcp+UO+a3g3pqoHGXh9JID4qTC5W4IYjli7FZ6zQDUcsXQqvsSK2nBpLlaJHhZHbDoqULFbkpsdCWuuiXLEiNzwaCrFObBwrNGOLB4jVia2MFbkxSUGsTiyJFbkpqaHG6sKOWJEbArYwItbxsfunf5Ep/LKFT2vykAw2xDr2qFcWtc2RV33jUw1ROQmhOip0Xqpv6BHLPJoZy32piDU49MTyWqxvFUSNZR0tsSJXC0pHSazItWrglENcGsUnI9KZMypiRa5TE6eqx6VRfPlEAeaO2KhQDcQqErGMpQZiFYl9saixiqQAsaBEEojV8TFf/epwE9ccMT066ltUyGJTLmlY6IvVUZisfnW4iWtVM709rf93foFcsUTZdQD9USFijRIyVhyIdQBqrEiosdphVAgqWBOrkQCmdR46Ck0IO0ua7j4FqhgTq1GyTJ/crr26HSbDzpIWP1APJcTYsULEGgpkLFDBmFjUWEPBQZTLpyf3LjzaA7iIcvXitDr/1r39Pr2JYt2gMa9V56u2F26WVqezrZd8/vlRo8H65T1vTxpToV+Uy5/OqvmPZ87t9+gtbdYNGjPxdYU1vb3/ws3Sam9qd1Yv+cvt20dHWw3WL+95ewovHfpFmT+8qC6fvawf3akJGBUi1hjpN+PdvZVYbu33QKwx4pOx3NrvQ401QhLUWDBGXEaFjyJHhTBCmMcCFcRm3ieHm1yPHVtfObl+ejm8nGweTJbPrwaeq/+qrV9eP1o9XvyzGqNOrps1Xrb61WTrDZvvuV7R6z+rxU42q1ZVq/br1jdv3dy2SWODV69sdI97p08OPD7UfNJ4K0V63wSxECsExEIsFRALsVRALMRSAbEQSwXEQiwVEAuxVEAsxFIBsRBLBcRCLBUQC7FUQCzEUkFerFTsnQSdFVtrY3l1QsVKxp3cK9DA1tqUsDqI5YSttSlhdRDLCVtrU8LqmBULygaxQAXEAhUQC1RALFDBqlibS2TzM39wcnKaeyU2vDs5+cZO51TX9yPaw6hY7wz13eL+AvMfXvY3TMPiI7e5gNgC520fO5tivf7633Yy1rtFFF8bSlm28nk1//vPxYhlrOuqrbuimMBSxrr67feCdoXGxFrcv8IO8wdfG9L8/FFJNZYtsS6fWvKqMpVA5w8vECuQ+QNTBdYCOyXf+cmC/Q8eYvVizKvmHRYtQMYK4/ozaUeuen0s1ViFiQWFg1igAmKBCogFKiAWqIBYoAJigQqIFcfbW69uHr3/6tesa2IMxIpjIxY0QKw4EOsAiOXN+69++XIy+b6qPtyffPLPW/99frd+8s2t/7Ar3AaxvHn/5ad/1iK9+nD/bu3WrVdv6h8/Pr9LjdUAsbx5/+X3y1J9uResBVsYVf9BrAaI5c3SoPqvRaaq3v/tVZ2tqvoxYjVALG92xarefvq/2i3EaoBY3qzEWu4KF399+O6XWi/EaoBY3qzE+nD/s2XxXlV/TD5jgnQHxPJmJdbNdMMibU2+R6wdEAtUQCxQAbFABcQCFRALVEAsUAGxQAXEAhUQC1RALFDh/9GYZefrOgoVAAAAAElFTkSuQmCC" width="60%" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="adding-predictors-as-smooths" class="section level2">
<h2>Adding predictors as smooths</h2>
<p>Smooth functions, using penalized splines, are a major feature of
<code>mvgam</code>. Nonlinear splines are commonly viewed as variations
of random effects in which the coefficients that control the shape of
the spline are drawn from a joint, penalized distribution. This strategy
is very often used in ecological time series analysis to capture smooth
temporal variation in the processes we seek to study. When we construct
smoothing splines, the workhorse package <code>mgcv</code> will
calculate a set of basis functions that will collectively control the
shape and complexity of the resulting spline. It is often helpful to
visualize these basis functions to get a better sense of how splines
work. We’ll create a set of 6 basis functions to represent possible
variation in the effect of <code>time</code> on our outcome.In addition
to constructing the basis functions, <code>mgcv</code> also creates a
penalty matrix <span class="math inline">\(S\)</span>, which contains
<strong>known</strong> coefficients that work to constrain the
wiggliness of the resulting smooth function. When fitting a GAM to data,
we must estimate the smoothing parameters (<span class="math inline">\(\lambda\)</span>) that will penalize these
matrices, resulting in constrained basis coefficients and smoother
functions that are less likely to overfit the data. This is the key to
fitting GAMs in a Bayesian framework, as we can jointly estimate the
<span class="math inline">\(\lambda\)</span>’s using informative priors
to prevent overfitting and expand the complexity of models we can
tackle. To see this in practice, we can now fit a model that replaces
the yearly random effects with a smooth function of <code>time</code>.
We will need a reasonably complex function (large <code>k</code>) to try
and accommodate the temporal variation in our observations. Following
some <a href="https://fromthebottomoftheheap.net/2020/06/03/extrapolating-with-gams/" target="_blank">useful advice by Gavin Simpson</a>, we will use a
b-spline basis for the temporal smooth. Because we no longer have
intercepts for each year, we also retain the primary intercept term in
this model (there is no <code>-1</code> in the formula now):</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(count <span class="sc">~</span> <span class="fu">s</span>(time, <span class="at">bs =</span> <span class="st">&#39;bs&#39;</span>, <span class="at">k =</span> <span class="dv">15</span>) <span class="sc">+</span> </span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>                  ndvi,</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>                <span class="at">data =</span> data_train,</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>                <span class="at">newdata =</span> data_test)</span></code></pre></div>
<p>The model can be described mathematically as follows: <span class="math display">\[\begin{align*}
\boldsymbol{count}_t &amp; \sim \text{Poisson}(\lambda_t) \\
log(\lambda_t) &amp; = f(\boldsymbol{time})_t + \beta_{ndvi} *
\boldsymbol{ndvi}_t  \\
f(\boldsymbol{time}) &amp; = \sum_{k=1}^{K}b * \beta_{smooth} \\
\beta_{smooth} &amp; \sim \text{MVNormal}(0, (\Omega * \lambda)^{-1}) \\
\beta_{ndvi} &amp; \sim \text{Normal}(0, 1) \end{align*}\]</span></p>
<p>Where the smooth function <span class="math inline">\(f_{time}\)</span> is built by summing across a set
of weighted basis functions. The basis functions <span class="math inline">\((b)\)</span> are constructed using a thin plate
regression basis in <code>mgcv</code>. The weights <span class="math inline">\((\beta_{smooth})\)</span> are drawn from a
penalized multivariate normal distribution where the precision matrix
<span class="math inline">\((\Omega\)</span>) is multiplied by a
smoothing penalty <span class="math inline">\((\lambda)\)</span>. If
<span class="math inline">\(\lambda\)</span> becomes large, this acts to
<em>squeeze</em> the covariances among the weights <span class="math inline">\((\beta_{smooth})\)</span>, leading to a less
wiggly spline. Note that sometimes there are multiple smoothing
penalties that contribute to the covariance matrix, but I am only
showing one here for simplicity. View the summary as before</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">summary</span>(model3)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a><span class="co">#&gt; count ~ s(time, bs = &quot;bs&quot;, k = 15) + ndvi</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000024869b48078&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a><span class="co">#&gt; 199 </span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a><span class="co">#&gt;              2.5%   50%   97.5% Rhat n_eff</span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a><span class="co">#&gt; (Intercept)  2.00  2.10  2.2000 1.00   815</span></span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a><span class="co">#&gt; ndvi         0.26  0.33  0.4000 1.01   856</span></span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a><span class="co">#&gt; s(time).1   -2.10 -1.10  0.0073 1.01   513</span></span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a><span class="co">#&gt; s(time).2    0.48  1.30  2.3000 1.01   433</span></span>
<span id="cb35-33"><a href="#cb35-33" tabindex="-1"></a><span class="co">#&gt; s(time).3   -0.49  0.43  1.5000 1.01   389</span></span>
<span id="cb35-34"><a href="#cb35-34" tabindex="-1"></a><span class="co">#&gt; s(time).4    1.60  2.40  3.5000 1.01   375</span></span>
<span id="cb35-35"><a href="#cb35-35" tabindex="-1"></a><span class="co">#&gt; s(time).5   -1.10 -0.23  0.8300 1.01   399</span></span>
<span id="cb35-36"><a href="#cb35-36" tabindex="-1"></a><span class="co">#&gt; s(time).6   -0.54  0.37  1.5000 1.01   415</span></span>
<span id="cb35-37"><a href="#cb35-37" tabindex="-1"></a><span class="co">#&gt; s(time).7   -1.50 -0.54  0.5000 1.01   423</span></span>
<span id="cb35-38"><a href="#cb35-38" tabindex="-1"></a><span class="co">#&gt; s(time).8    0.62  1.50  2.5000 1.01   378</span></span>
<span id="cb35-39"><a href="#cb35-39" tabindex="-1"></a><span class="co">#&gt; s(time).9    1.20  2.00  3.1000 1.01   379</span></span>
<span id="cb35-40"><a href="#cb35-40" tabindex="-1"></a><span class="co">#&gt; s(time).10  -0.31  0.52  1.6000 1.01   380</span></span>
<span id="cb35-41"><a href="#cb35-41" tabindex="-1"></a><span class="co">#&gt; s(time).11   0.80  1.70  2.8000 1.01   377</span></span>
<span id="cb35-42"><a href="#cb35-42" tabindex="-1"></a><span class="co">#&gt; s(time).12   0.71  1.50  2.4000 1.01   399</span></span>
<span id="cb35-43"><a href="#cb35-43" tabindex="-1"></a><span class="co">#&gt; s(time).13  -1.20 -0.35  0.6400 1.01   497</span></span>
<span id="cb35-44"><a href="#cb35-44" tabindex="-1"></a><span class="co">#&gt; s(time).14  -7.50 -4.10 -1.2000 1.01   490</span></span>
<span id="cb35-45"><a href="#cb35-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-46"><a href="#cb35-46" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb35-47"><a href="#cb35-47" tabindex="-1"></a><span class="co">#&gt;          edf Ref.df Chi.sq p-value    </span></span>
<span id="cb35-48"><a href="#cb35-48" tabindex="-1"></a><span class="co">#&gt; s(time) 9.83     14   64.4  &lt;2e-16 ***</span></span>
<span id="cb35-49"><a href="#cb35-49" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb35-50"><a href="#cb35-50" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb35-51"><a href="#cb35-51" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-52"><a href="#cb35-52" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb35-53"><a href="#cb35-53" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb35-54"><a href="#cb35-54" tabindex="-1"></a><span class="co">#&gt; Rhat looks reasonable for all parameters</span></span>
<span id="cb35-55"><a href="#cb35-55" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations ended with a divergence (0%)</span></span>
<span id="cb35-56"><a href="#cb35-56" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb35-57"><a href="#cb35-57" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb35-58"><a href="#cb35-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb35-59"><a href="#cb35-59" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:32:49 AM 2024.</span></span>
<span id="cb35-60"><a href="#cb35-60" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb35-61"><a href="#cb35-61" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb35-62"><a href="#cb35-62" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>The summary above now contains posterior estimates for the smoothing
parameters as well as the basis coefficients for the nonlinear effect of
<code>time</code>. We can visualize <code>conditional_effects</code> as
before:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">conditional_effects</span>(model3, <span class="at">type =</span> <span class="st">&#39;link&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>Inspect the underlying <code>Stan</code> code to gain some idea of
how the spline is being penalized:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">code</span>(model3)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="co">#&gt; // Stan model code generated by package mvgam</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="co">#&gt; data {</span></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; total_obs; // total number of observations</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; n; // number of timepoints per series</span></span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; n_sp; // number of smoothing parameters</span></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; n_series; // number of series</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; num_basis; // total number of basis coefficients</span></span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a><span class="co">#&gt;   vector[num_basis] zero; // prior locations for basis coefficients</span></span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a><span class="co">#&gt;   matrix[total_obs, num_basis] X; // mgcv GAM design matrix</span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a><span class="co">#&gt;   array[n, n_series] int&lt;lower=0&gt; ytimes; // time-ordered matrix (which col in X belongs to each [time, series] observation?)</span></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a><span class="co">#&gt;   matrix[14, 28] S1; // mgcv smooth penalty matrix S1</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a><span class="co">#&gt;   int&lt;lower=0&gt; n_nonmissing; // number of nonmissing observations</span></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a><span class="co">#&gt;   array[n_nonmissing] int&lt;lower=0&gt; flat_ys; // flattened nonmissing observations</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a><span class="co">#&gt;   matrix[n_nonmissing, num_basis] flat_xs; // X values for nonmissing observations</span></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a><span class="co">#&gt;   array[n_nonmissing] int&lt;lower=0&gt; obs_ind; // indices of nonmissing observations</span></span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a><span class="co">#&gt; parameters {</span></span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a><span class="co">#&gt;   // raw basis coefficients</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a><span class="co">#&gt;   vector[num_basis] b_raw;</span></span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a><span class="co">#&gt;   // smoothing parameters</span></span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a><span class="co">#&gt;   vector&lt;lower=0&gt;[n_sp] lambda;</span></span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a><span class="co">#&gt; transformed parameters {</span></span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a><span class="co">#&gt;   // basis coefficients</span></span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a><span class="co">#&gt;   vector[num_basis] b;</span></span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a><span class="co">#&gt;   b[1 : num_basis] = b_raw[1 : num_basis];</span></span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb37-30"><a href="#cb37-30" tabindex="-1"></a><span class="co">#&gt; model {</span></span>
<span id="cb37-31"><a href="#cb37-31" tabindex="-1"></a><span class="co">#&gt;   // prior for (Intercept)...</span></span>
<span id="cb37-32"><a href="#cb37-32" tabindex="-1"></a><span class="co">#&gt;   b_raw[1] ~ student_t(3, 2.6, 2.5);</span></span>
<span id="cb37-33"><a href="#cb37-33" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb37-34"><a href="#cb37-34" tabindex="-1"></a><span class="co">#&gt;   // prior for ndvi...</span></span>
<span id="cb37-35"><a href="#cb37-35" tabindex="-1"></a><span class="co">#&gt;   b_raw[2] ~ student_t(3, 0, 2);</span></span>
<span id="cb37-36"><a href="#cb37-36" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb37-37"><a href="#cb37-37" tabindex="-1"></a><span class="co">#&gt;   // prior for s(time)...</span></span>
<span id="cb37-38"><a href="#cb37-38" tabindex="-1"></a><span class="co">#&gt;   b_raw[3 : 16] ~ multi_normal_prec(zero[3 : 16],</span></span>
<span id="cb37-39"><a href="#cb37-39" tabindex="-1"></a><span class="co">#&gt;                                     S1[1 : 14, 1 : 14] * lambda[1]</span></span>
<span id="cb37-40"><a href="#cb37-40" tabindex="-1"></a><span class="co">#&gt;                                     + S1[1 : 14, 15 : 28] * lambda[2]);</span></span>
<span id="cb37-41"><a href="#cb37-41" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb37-42"><a href="#cb37-42" tabindex="-1"></a><span class="co">#&gt;   // priors for smoothing parameters</span></span>
<span id="cb37-43"><a href="#cb37-43" tabindex="-1"></a><span class="co">#&gt;   lambda ~ normal(5, 30);</span></span>
<span id="cb37-44"><a href="#cb37-44" tabindex="-1"></a><span class="co">#&gt;   {</span></span>
<span id="cb37-45"><a href="#cb37-45" tabindex="-1"></a><span class="co">#&gt;     // likelihood functions</span></span>
<span id="cb37-46"><a href="#cb37-46" tabindex="-1"></a><span class="co">#&gt;     flat_ys ~ poisson_log_glm(flat_xs, 0.0, b);</span></span>
<span id="cb37-47"><a href="#cb37-47" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb37-48"><a href="#cb37-48" tabindex="-1"></a><span class="co">#&gt; }</span></span>
<span id="cb37-49"><a href="#cb37-49" tabindex="-1"></a><span class="co">#&gt; generated quantities {</span></span>
<span id="cb37-50"><a href="#cb37-50" tabindex="-1"></a><span class="co">#&gt;   vector[total_obs] eta;</span></span>
<span id="cb37-51"><a href="#cb37-51" tabindex="-1"></a><span class="co">#&gt;   matrix[n, n_series] mus;</span></span>
<span id="cb37-52"><a href="#cb37-52" tabindex="-1"></a><span class="co">#&gt;   vector[n_sp] rho;</span></span>
<span id="cb37-53"><a href="#cb37-53" tabindex="-1"></a><span class="co">#&gt;   array[n, n_series] int ypred;</span></span>
<span id="cb37-54"><a href="#cb37-54" tabindex="-1"></a><span class="co">#&gt;   rho = log(lambda);</span></span>
<span id="cb37-55"><a href="#cb37-55" tabindex="-1"></a><span class="co">#&gt;   </span></span>
<span id="cb37-56"><a href="#cb37-56" tabindex="-1"></a><span class="co">#&gt;   // posterior predictions</span></span>
<span id="cb37-57"><a href="#cb37-57" tabindex="-1"></a><span class="co">#&gt;   eta = X * b;</span></span>
<span id="cb37-58"><a href="#cb37-58" tabindex="-1"></a><span class="co">#&gt;   for (s in 1 : n_series) {</span></span>
<span id="cb37-59"><a href="#cb37-59" tabindex="-1"></a><span class="co">#&gt;     mus[1 : n, s] = eta[ytimes[1 : n, s]];</span></span>
<span id="cb37-60"><a href="#cb37-60" tabindex="-1"></a><span class="co">#&gt;     ypred[1 : n, s] = poisson_log_rng(mus[1 : n, s]);</span></span>
<span id="cb37-61"><a href="#cb37-61" tabindex="-1"></a><span class="co">#&gt;   }</span></span>
<span id="cb37-62"><a href="#cb37-62" tabindex="-1"></a><span class="co">#&gt; }</span></span></code></pre></div>
<p>The line below <code>// prior for s(time)...</code> shows how the
spline basis coefficients are drawn from a zero-centred multivariate
normal distribution. The precision matrix <span class="math inline">\(S\)</span> is penalized by two different smoothing
parameters (the <span class="math inline">\(\lambda\)</span>’s) to
enforce smoothness and reduce overfitting</p>
</div>
<div id="latent-dynamics-in-mvgam" class="section level2">
<h2>Latent dynamics in <code>mvgam</code></h2>
<p>Forecasts from the above model are not ideal:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">plot</span>(model3, <span class="at">type =</span> <span class="st">&#39;forecast&#39;</span>, <span class="at">newdata =</span> data_test)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAAe1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtrZmtv+PJyeQOgCQOjqQZgCQ2/+iUFCzs7O2ZgC2//+5eHi5fHzHmZnQ0NDbkDrb25Db2//b/7bb/9vb///cvLzcv7/p1dX/tmb/25D//7b//9v////pTUB1AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAcwklEQVR4nO2d6WLcOnJGeS3ZM6NEVmJTjnQ7mblOtPD9nzDNHVthLxBgf+eH3d0kiwXwCATBrRsAYKA7OgFwTiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEW8orVwVMwA7EACxALsACxAAsQC7AAsQALEAuwALEACxDrDFRY7xDrDFRY7xDrDFRY7xDrDFRY702J1bNGbxiIlQbEIoBYadQuVnfUBoZYaVQuVtcdZRbESgNikWs+ZLU2IFY+jhOrQiBWRuDVDsQCLEAswALEAixALMACxAIsQKwzUOHRKMQ6AxArDYhFALHSgFgEECsNiEXQvFifT9P5sO7LLyIaxDqE1sW6dI/zh7fuH+ZoEOsQGhfr82nT6XL3lzEaxDqExsX6eHhcP76Zd4YQ6xgaFwstFvAmrI/1x4/5w/tX9LGAlTATPh7mo0JzewWx8tPstYMYx6qadq92zpN1t5ElHAXEaoewrMeBrPevXbf2tbRoECsvNyLW5cuv4f3bj/H48NE4A8TKTatehY9jPd+PH98w3FATFdoXKtYyloUB0qpoXKzh+SrVBS1WfbQu1sfD3V9Tk/VG9N4h1jG0LtZ4WcPEPRUNYoWToX/evliuaBArmBwjChArDYhFxsiSSk4g1tFALJ9oECsc9LE8okEsMAOxAAsQC7AAsQALEAuwALEACxCrGs5VOohVDQmlwzhWGhCLAGKlAbEIIFYaEIsAYqUBsQggVhoQiwBipQGxCCBWGhCLAGKlAbEIIFYaEKsdIFY1nKt0EKsazlU6iFUN5yodxKqGc5UOYlXDuUrXklj9uape5Vyla+mVJ/25zbrhcayDX3nSgFgpN5/erlhHv0CgfrGSbpe/XbGOfuUJxKLXG78sE2ixcgKxNlp65Un9YqGPtRGW0bGvPGlArBRuWSxnNIgVD8QyRCnyyhOIRdG4WB8PY8/qDQOkLJyscMFiTc95FwYe5GgHiNXsS0EUblysRalDXiBgFKvd1xgp3LhY0zuaahoghVh1sm6Ty3XzmHdvO6NYn/8xi4UWKzcn60Eu22Qc+qRGPTfmUay5j1XPAGk1XiUmckqx5pM1xHkakatbVwUvVON2y0eFqU1n3aULZq6KZSCBGkXwjwaxokkpXS2NtoAkFvVGXv9oECsaiGWLxi9WNV0qDaY+lk/YCuukNbFOcxCoQYjlVeAKqwRi1cJJxdpPI6f04CFWPKcUK1u0W+5jJXLKPla2aDd8VJhK/qPCQ/8GQ07peESDWNFkF+vYXkPIKR2PaBArmuylq0Es71M6rmgQK5pTioVTOseTv3QV9LHaGcc6LycrHcSqhZOV7ixild0oHGuDWLZoECuOa3fopGK1ckqHnMa5Yva1TRV/xstmskWDWFFALFe0WxGrz7tGiOWKdjti5e0RJfaxIFYSJxZrKhzEoqPdjFjZj+EgljUaxEoJaS6Gx4pqFuvzKf2qGYiVFvKUYlE3N4dFg1gpIc0dt8bFEp5cmxANYqWEjBarQnYTlufIWKn3zRSnEMsctHGxtrM6llM6lbyZQqjpXvtQBIjlJMSESp7z3kOsBgh78FoVb6aAWC0gmPD+9bojtF05U0eL1UOsFthNmPtN5KOvRqp4M8VW+/1wpFjS1zwhzynW59P99P+z7VadGt5MIYrVHyaWdKfC4WLVPI61DpBear/Qrwqx5HurIJZOWItFRin4ZgqIpVOzWD59rHVOslErINZW+/JINcSqjJCjwpUDxeoVsdauTukbEeTWOWXta5wTi+XEfctFabG2DVxYrPlSYiGxtEhzjDOKde25f/ybu616/zr5VE2L1UOsNUp0AlwEiXXt2o8dsYPE6ne2b7tYRc0yixWTgo9Y7rjVijU9HsvrvsKx0apDrPmHfbMwrlnPRL6pJkEsnz5Wy2JdGy2vFmsYG62/1yDWcmNLv01jXDORifB1/i9jTGlKStyjiDDh46EGsZZb8SoRa945Z4wpTUmJexQN3UxBiaWdmWbHKFZiChDLGo1XrGEXq4dYddOsWP3ax9KvpWHHJBalRWBMQwiIVVas9SPEqpJGxepFhgrEIndkYSENIcoWLRsNijX2qiSx0js4EbnQYkVloovV71OcS9c8jjVdN3Ohr+Hzi1ZArGlI8VixpCE0Vay4TMxiLUX1SChmnazsGT1/+fX+9X69LCsyGr9Y2zjDcWLJQ2iKWJGZGMVSV2TJKGadrEh3Qr91jxVfQVqrWL1KTMzzijVemjzeLFG7WH09Yu2j/v5iURPPLdZ1b5j23pMinXfNq6P6WMxi9WfpY9398+E+8aEzpYYbtE1ZVixZAkaxlinOhKoW6/Op+/Irre8OsSDWSoPjWLcnlrNsECsFm1iRw5LRmYgWVCBWhUi7Qo8rSB3R2MSaL9kkxWK+o1FBssCoOb2oT8jlh31KprxLIg2Qpkfj2rzLReYWr0qaVUisXv7QFo08g7QpsWweQKy4aMeI1dcklr27d3tiJQ40LNEO6mP19fSxiO7edjOOT8j1B/lDW4jPbkh/0PtRR4WFK19aqe6VoRb22wddIcUf5A9tEfRwW3c0RrH6OsUyNFgRYunFCBIL41gJGNuHodc3CT8WsYjuXpxY267WNUwHsdwByAhLc6A2DweLpXpFdfccfaxTi+X9GCNLtMQC2o7u9EuxlO9pqw5AVFsXy55JmFhrG920WP4PXrNEuzWxzNiWdYWUf1g+ua53rlksr0dFcr/yxC6Wdo1fi2KZJ2oL99vOsHWxfB5uy//Kk7A+lnzNX+Kq/UkQi5qoL71dpNq6WB4t1rEvEOgdww2nEWuaY7/8uXWxPPpYx77y5EbF8ipd1WLV/sqThsSiU7GJJY2+h4lVIUEmHPrKk9sSS7tlhKksbISZcOQrT04gVic9YFINKYt1XPHyoD0qstr7CtsXa7n2hwoJsQxRNrIlpgGxmmI2YR34HHFe7/dGd/GjxPKsshsWi+6b1UvYU5Ofr969/+2XOPAgR7sBsdRetTuVrSH372PJ0ejl6iXIhHHw9Hlqrd4yDje0JZY2DuBMRewiUGnaxLK1dNsqspQtJyEZTe3U+7dJrIwDpCcUq9eWEAphoJfF6k8j1sfD3T/dV5DOO8DP/xkOa7EMXY9axerlJcRC6FjF6hsWy5PtiJG6paeoWNplf2Xw8Uq+gEo4WDanqdmkNM3OPpap3lkP0d2ErXy54YI8oRgnlp8Sqlha2xGx6jjcXpFX5sWJ5Sye7WLogxDWPXbNE2/VYRSrb0ssupNOxjurWPN+jjoL6BmtoFj6o/0i1h2FcavLX2wX9BHxHJfSW4tXs1jbhX7Fn+i3V5mtKnSxDjtPa9jm0pWsHf0cPlosOUS6WNX0sXyuIHVHSxLL+kdmECug5rNi9GrTwvrkUFIseceeQ6yDCbvm3RktooC9t1hD82KZ09TFOrR4eTj+Lp29zpoVS+7uCWKpKdFimR4GfRKx5out0h6SlSaW41aKisWSu3vd9rDuALEMD4M+i1g5oqWJ5Z6rYM3Tltu3v5hOb1qQiOcMnLd43EAsAst+2VMsfZQUYkVHixTLXWkVieXrlT6YZc5z/9UVryVCTkJ7RINYFrGIPM8sVrZo5xGL7mOFiNWbFjTHc0e25ZpWVgYaEcur6iMSjgFi+bDuCruNKneFFYnl7ZWYky3PM4s1Mp9+viQ9ICtaLJcUDYvVawtpAYnhX/UHOqeaxTrqlI5aaXrXpltf1Tu0KJZVkKmw+80Symz+J9lrFuuok9BKrekHY/u5jqFRsfR3o8uF3S491rzyvSyoZrEObrGaESvMK3uei1HnFms9CV26j6VUW6xY1AVQ2dnXlm7WUjSzWPvJbLdZVYs1HxqmtFc5xDL3sbY5wsTKfK3b1tnr1w53BrMWhUylW09mty5WjmjpYlnmGQLFsl6GE46waxqGNLFMoxBk6byqqDrqEWutWXqWoSKxbLl4oJa91wclpKKJS7WBvCu8+9dT0jvAcohFnf03ijVIH7RsqhVLjzB/NwWVxWrFLqHz/sePy91fxe/Skap2r3PTLIPQdVYr3djY5e9jUVoEo0WYv59QrPEBo+MdOqXv0tFrUA3ZCfU6/2eodGIvmhlSi2C0CNN3Y9DGxRoHSCexDhogFWpQjii1E/N/hkqHWJUhDZCOYhV+MwVZ6VtEVSxxoUEWi7vSaS2C0SLQ9SH1FvgLmQlxgPTxKpb1Lh2GN1P0Sq2pejQhVoRjauHTxKp7HGsaIC39nHeh0pS+8RZS6WMNfmJl7rjLyaqpBxglF0b6Pqi/adHbFMsJx5sp9jpTj+b1eYb5EhMvsTIPNajJSt8glgGhj+W8U5W1xaLFkrfF/os0VT2i5BBLscC46b0ZosTSa2cpbeaipqNdNmOD4c0Ue6UpvSnDLMMu1vrpSLFMDac/g79Ywor02llKm7mo6UjjWE6yv5lCrEC5N2WYZ1gPtnuhByVXvpgK355QEWuAWDrCpcnfkt7aO0dLEctQzfI8wzaKI7RHcuUnl8AvWfm7pRw06kJ0hWhi6aWsWayPlPsKu43ABS3Vrs+jrE+cWkIsLT3ZkRwDWy6xDLWz1AdnwaMIy+hy3Z7zU0gzHRW66lmaR1yPJha/WVp24rfIdksrsHGKrXaW+mAsdxxBGY06vX+9Hw4Xq9f7WCXFUn6YP9tK4wFdIbRYHGN1uVgz29oiC/OIxMcDfUaxmFi9MnU4XCxraTzQ17JPIWZmGavLxZLYOJDgvGJmGSAdzcokVlA9S8spQQZ+sfRMxG+pYplWs00i5m5ArHmswXXFzDqG+vl0f7RYapThaLGEX6L8Mq1mm0LM3oBY8+gocZ5mZ9Xp/Stx7JhdLGPd1y1WXMNlWs02hZq9Yq9ksZy3fq1XNXw+pYilHNHZKtpY955iZa52MjllnoJikVBFL2himFjOaD557y24s6KpylQq1ihW7h2Fnokhr+iDQ9NqtimW2Y1QRS+57zxKLI+a9q/MasTS5vSGXtgYUFmj6R5fQxEgVl+tWGurJP1knJMsh3GSvhrRW5dZFYu1n5Thv+bdx6sgsYbwPlZwHS/hO/ENb8sa1UhS0nRhpUnywsJN17RYwmrVoqT0sTK5d8gNq26tosXyPCwMP7O5bXDxnZT7b0TxLM2zPMkU0i6WuNqM7VCuVq1esQx16RPUN1GIZQZiEUGNkwyJRomlvkXXLJaYuirWQEySl3WJNQw9xNLn8ehhcYsV28dS36Lbm/pYUupKcQdi0pKTIPAaRw3YL10wWx8rhUxmFRfL75iQXaxgzJmYVxhUrC2k2EwJPukB9W2f9Vgvj1nVimWqeiuW2TKIFZOKsRR04SSx9jh6QIhlnoVJLMvJwpbEkoqxi6XuXhnHoxoVi+hjuXv0zsBtiGWeOi22bE+TWMpS0hFEdtrsYw3GmvXo0nuGNU4ILYcj5bC5fQqqLb1/nv43LOWVt+6Iw5psTWEdYvnsID3DGieElsOectjcXgXVFt8/jv+ZlvJJW9+rOfZz+XayECs848DZmcTyyeXmxfJ4I7L35hzMV9XEYjoq803Fv6Da4nLuluqx5gGx3G9EDhBLnVn9HlR3ecWij13kxdWPdPUY1i6NnN52H8sH77CDOrfyNeyv0nAgl1BCapphnetnR8ilSNHl4+KEYqlzqwsHVXxvGAlJKCE1TV3cP+ZSpNjysVFcLOP1MLROAZvTMnukWP1BYhkH3ojllj5YVPk4qUAsz9PSzv0/samMHVhXMTox13rFWjNVT/DEbtWMRpYWS99Ovid5nH+J5m3VdcF/wdsCa3/NboFHLuKi1O/S4n4ht0xzHcllbOsOEMtYOzallqoPFGs/nooVy2JHeDG3RaPimUNCrJ21KoXqYRNrHwI6QCyyZYqKR2QDsVaWmpRM8utjDY4egCnItEJTbfkN5lhScUEdkBijesSjsunms9HZBp+a7WNtJkkXT1qN8qt9c7M3mJf2/MuMTGVatJBYy+IVHAWqlBVrqYliYhFL+4kVm4plcfPv8fGCApQlTKzUV54sFaGK5WGWsxyOjpo+M5mjkmz0duyJ48mEeIkZlSRIrORXnqwVIfex9CGoiKqTvTKNwsoz0zmqySaIALG8SH6BAF0p0g9EP9yJNYR3KcVLVpI2Y68P2Rnj+ieWmtFMmXH5kHUkv/KErhTxu3Gv5pOfPYRvKc8uVqEzPiVbLEuliN+jrbCH8A9iyzZkK2o7eXM9+Mcj+dM7RpViJb/yxLKdhB/imxtrCC1Kv/2jxjAlK1yW48ss1noovC8IsTSSXnlCHLbNE8VfIveE4mLmdcnzz7KoUQix9ug+qSyhhr3VGljFEu6197oBz78M0ZQbx6IGBJbJdK15Vr7PmSFpgX5uTZQw23zygnt0/9pYxVrWUkCsQq2RDxlPMjlKlSKWdw7WKHIsc2xqoS16cN3oBBbMlVt/YrG2aOFibdOnL/pU7/r3FWvtWpk3Lr3p8okljosEL0ecjBbqIEeG6RQ8pePo95hqbVnGd+Wet+6v3SvDxqUXIr2K2ZQOr6iQTrE8kylhX9g41r7LixjHorayMJ3o2Xjm56fVsnGMzYbHonqRE8wyTyRD6jW0EHkhIydBK6Ae775Hs4RzbilySMs3PQ+l7L74zaUWOV4sYuLtiTW+7MQeLYNY+pCWd3qBNmlpeM2kFTlqK5HxrCGFE6tKPYWsu0Kxhjf7K8Js53bdG8twgBiyJ7SsxI3X0kSZYzYSGc4ack9T7lH6pdAJffzAdMMp1nn32FjJAz2JZnnMko+oeJtYyjHwn//3271w2UPGMmIFb6zYDRpplR+htcHElArEmgjfWLEblMmp4Dw4GXOBWCMRGyt2g2Zwp3av5gSlPpaXWIVOEq4ryxuNQ6ygDBK9sg3fh1WFk4TNrKVmEcu8GtOveb0rIZZ1UxLEbtAEq1avop5EFUzKjklLjRbLvBrTr5n3lAXEsm5KinVqPWKF1YQTiBUULbtYhiumrCSJ1atixZ8vdpK0HeUqHPP+TZgFsQxLLf+HpZDBrD07WTJ/fDZRymYUa3DMcRSLNsvzV/G3dMeqFyv0Ie1pYsnJSZoF5MB/YK/kOInlc2DoSYYCHCKWT6jYfQ+XWCE5HCRWPrUgls/aiGuYPKhXrEHOsetes5p1arEiU8gpljgKGZRE7GYJWE7KMUYsaV2qSY32sXxCVSFWYM6pBDUU8h/AIpa/WdK6lmYvMF17/JzBcooVi9GJFqwaIvZAuljeakGsUHqthZKSkIemGhdrzb/rvoeaBbFC0S+tEu+zEIemQm6/KMO0cR1bWJq85Pfnf31/dZmlhrX2sdI5QqysqzSsT12peLepcKDnf8NY0QsbHNtYmSyIZTerwJGqvL680WoQS17tnNb5xXp5eRHU0gWDWNkwiSUNTTnFWvtrhRKeCRNrLuWf//vdZRbEyoawLkEg0SVXg7Xeb1Uo4WFLNmTyKtbPWaxhoM3iyJZMM2+0ELGcJU2tir7f3gli9Yf0alifRFQBZGUIYl3NGucjdoZlOU4sZ9uc3Hiv3ShTDgFi5XhXeTKWyljEuvLyOs9Xg1llxZLn5RZLjhHjVT1YK2Mcxxr5+XJzYhlu/S0tls/9qNO/7Yl1nfr68vPnaNY032sFZpURa+k9qzNb6qrr4r0SlxM+O73q5tuug7wK7GnH46ir15eXSazRrNccYqVmXkSs9Xhfm5vMPtGr8Js6euEJJAFiBY4NsDDv/V4ms6ae1ksGs5IzLyiWYe6yYpmRxcq7roJivb6+vsxizQMPr6/aqFbgRTUQyz+skbVj1bZYk1nXjta4Q5zN0sdLA8xqQiwyyyq8WkdBJ7OIgNa10b+TqeTVbRbr9yLWz6XJcp3jEbIg/urTkkpaWotGVWNYlil/LhHLrmetMybTbWQLaV/d792s7zt+Zw9Z2lWIxRLwELFmXl8Fs8bh+Je1yyVbtg15LR9y5jOEihX3WjmIlSOkg7k1ms16nXVauluUWatY64dp+Wz5BJUv6rVyMd2lpP6VZWNqEzuJ4KDOTGwhwwLuS5on7C3Q702sn1uTZTxM7NaGrltveM14PUTIklEvaWLZgRP4eCVN7hSCw7qSiZoYF3TJUjLrezxJB1BDmFj0a+UsmwZiBU+MC2rMsg2x0GIFJxM1MS5oogi544X1sWJeK1fOK596j+hjxWpgXSa2Vhhk5YkXtmTSa+XALVFiHAtwU2G9Q6wzUGG9Q6wzUGG9Q6wzUGG9Q6wzUGG9Q6wzUGG9Q6wzUGG95xYLnByIBVg4RqxyK+DLmy3ybaUMsYpFvq2UIVaxyLeVMsQqFvm2UoZYxSLfVsoQq1jk20oZYhWLfFspQ6xikW8rZYhVLPJtpVzfSSZwCiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFrjFev8b8YDlBJ6nx3O9dV13nzPsFjBr5K0Clg+XrlsfX5cl8vzIsvuckdVMowIzi/XxQD25O5636blvb93jNXpGs7aAWSNvFbB8eL5uorfu0b5QSOS3dZtni6xmGheYV6w3+pHw0Vz/RK9ifT6NW/4t0x//MD5gddT18sePrJG3Clg+zM/YfKaeiBgR+bJUcLbIaqaRgVnFuuZ0yS7W5e4/r4Wci0s9CzWCTayckbcKWD/Mf/mXdGu3yM9L05orspZpZGDuPlZ2sd6//XiexBqL+/GQTaxlDzj+hWaNvFXAvLmm7ZNBrDXg59Pfr12sf2SNLGcaGbg1scZHgo9izX9HWTtZ71/nLZQ3sizWsl/J0smaAk55jnvvjJHlTCMDtybW+IB5HrHGPurn05dfrGItPeF8Ys2MrUq+yEqmcYEbE+u6I5w7ktl3hfMf5jUg665w/NPv7v77W7Zd4cx89JYrspppVODGxLrMz9LZu9g5/vQn5obqulPJHFkVa1pXlkpRxcoW2ZRpcODGxJp45hhu2FqszJFNYj1n2c0uXaFHMXaWyKZMgwO3Klb+AdK1j5U5sizWFDfPQeF6VHg/H9FkjCxnGhm4WbHyn9IZd7P5Iyst1njomalK9q7QtCPMF1nJNC4wTkIDFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgFmABYgEWIBZgAWIBFiAWYAFiARYgVgBv3cpjjufTnhqIFUieZ2mfH4gVCMTyA2IFsog1PQD93x+uO8W35b0Nl/npxWAGYgUiivXl1/Dc3f01PSJ+fDRZxsfONw/ECkQUa3149+XLr9kpjsfMNQrECkQU63F5VunVp/mZpRkftts6ECsQQqzLOg5xdH61ALECsbZYYANiBUKINfexoNcGxAqEEGt6mnfWx4M3DsQKhBJrGseCVxsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAv/D2E8vNHKZFglAAAAAElFTkSuQmCC" width="60%" style="display: block; margin: auto;" /></p>
<p>Why is this happening? The forecasts are driven almost entirely by
variation in the temporal spline, which is extrapolating linearly
<em>forever</em> beyond the edge of the training data. Any slight
wiggles near the end of the training set will result in wildly different
forecasts. To visualize this, we can plot the extrapolated temporal
functions into the out-of-sample test set for the two models. Here are
the extrapolated functions for the first model, with 15 basis
functions:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">plot_mvgam_smooth</span>(model3, <span class="at">smooth =</span> <span class="st">&#39;s(time)&#39;</span>,</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>                  <span class="co"># feed newdata to the plot function to generate</span></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>                  <span class="co"># predictions of the temporal smooth to the end of the </span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>                  <span class="co"># testing period</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>                  <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">time =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">max</span>(data_test<span class="sc">$</span>time),</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>                                       <span class="at">ndvi =</span> <span class="dv">0</span>))</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">max</span>(data_train<span class="sc">$</span>time), <span class="at">lty =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>This model is not doing well. Clearly we need to somehow account for
the strong temporal autocorrelation when modelling these data without
using a smooth function of <code>time</code>. Now onto another prominent
feature of <code>mvgam</code>: the ability to include (possibly latent)
autocorrelated residuals in regression models. To do so, we use the
<code>trend_model</code> argument (see <code>?mvgam_trends</code> for
details of different dynamic trend models that are supported). This
model will use a separate sub-model for latent residuals that evolve as
an AR1 process (i.e. the error in the current time point is a function
of the error in the previous time point, plus some stochastic noise). We
also include a smooth function of <code>ndvi</code> in this model,
rather than the parametric term that was used above, to showcase that
<code>mvgam</code> can include combinations of smooths and dynamic
components:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>model4 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(count <span class="sc">~</span> <span class="fu">s</span>(ndvi, <span class="at">k =</span> <span class="dv">6</span>),</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>                <span class="at">data =</span> data_train,</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>                <span class="at">newdata =</span> data_test,</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>                <span class="at">trend_model =</span> <span class="st">&#39;AR1&#39;</span>)</span></code></pre></div>
<p>The model can be described mathematically as follows: <span class="math display">\[\begin{align*}
\boldsymbol{count}_t &amp; \sim \text{Poisson}(\lambda_t) \\
log(\lambda_t) &amp; = f(\boldsymbol{ndvi})_t + z_t \\
z_t &amp; \sim \text{Normal}(ar1 * z_{t-1}, \sigma_{error}) \\
ar1 &amp; \sim \text{Normal}(0, 1)[-1, 1] \\
\sigma_{error} &amp; \sim \text{Exponential}(2) \\
f(\boldsymbol{ndvi}) &amp; = \sum_{k=1}^{K}b * \beta_{smooth} \\
\beta_{smooth} &amp; \sim \text{MVNormal}(0, (\Omega * \lambda)^{-1})
\end{align*}\]</span></p>
<p>Here the term <span class="math inline">\(z_t\)</span> captures
autocorrelated latent residuals, which are modelled using an AR1
process. You can also notice that this model is estimating
autocorrelated errors for the full time period, even though some of
these time points have missing observations. This is useful for getting
more realistic estimates of the residual autocorrelation parameters.
Summarise the model to see how it now returns posterior summaries for
the latent AR1 process:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">summary</span>(model4)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="co">#&gt; count ~ s(ndvi, k = 6)</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x0000024869b48078&gt;</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a><span class="co">#&gt; AR1</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a><span class="co">#&gt; 1 </span></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a><span class="co">#&gt; 199 </span></span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a><span class="co">#&gt;               2.5%     50% 97.5% Rhat n_eff</span></span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.100  2.0000 2.600 1.13    19</span></span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a><span class="co">#&gt; s(ndvi).1   -0.180 -0.0110 0.073 1.01   335</span></span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a><span class="co">#&gt; s(ndvi).2   -0.130  0.0200 0.300 1.01   381</span></span>
<span id="cb41-32"><a href="#cb41-32" tabindex="-1"></a><span class="co">#&gt; s(ndvi).3   -0.052 -0.0018 0.040 1.00   893</span></span>
<span id="cb41-33"><a href="#cb41-33" tabindex="-1"></a><span class="co">#&gt; s(ndvi).4   -0.210  0.1300 1.300 1.02   253</span></span>
<span id="cb41-34"><a href="#cb41-34" tabindex="-1"></a><span class="co">#&gt; s(ndvi).5   -0.080  0.1500 0.350 1.00   407</span></span>
<span id="cb41-35"><a href="#cb41-35" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-36"><a href="#cb41-36" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb41-37"><a href="#cb41-37" tabindex="-1"></a><span class="co">#&gt;          edf Ref.df Chi.sq p-value</span></span>
<span id="cb41-38"><a href="#cb41-38" tabindex="-1"></a><span class="co">#&gt; s(ndvi) 2.47      5    5.7    0.34</span></span>
<span id="cb41-39"><a href="#cb41-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-40"><a href="#cb41-40" tabindex="-1"></a><span class="co">#&gt; Latent trend parameter AR estimates:</span></span>
<span id="cb41-41"><a href="#cb41-41" tabindex="-1"></a><span class="co">#&gt;          2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb41-42"><a href="#cb41-42" tabindex="-1"></a><span class="co">#&gt; ar1[1]   0.70 0.81  0.92    1   416</span></span>
<span id="cb41-43"><a href="#cb41-43" tabindex="-1"></a><span class="co">#&gt; sigma[1] 0.68 0.79  0.95    1   378</span></span>
<span id="cb41-44"><a href="#cb41-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-45"><a href="#cb41-45" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb41-46"><a href="#cb41-46" tabindex="-1"></a><span class="co">#&gt; n_eff / iter looks reasonable for all parameters</span></span>
<span id="cb41-47"><a href="#cb41-47" tabindex="-1"></a><span class="co">#&gt; Rhats above 1.05 found for 94 parameters</span></span>
<span id="cb41-48"><a href="#cb41-48" tabindex="-1"></a><span class="co">#&gt;  *Diagnose further to investigate why the chains have not mixed</span></span>
<span id="cb41-49"><a href="#cb41-49" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations ended with a divergence (0%)</span></span>
<span id="cb41-50"><a href="#cb41-50" tabindex="-1"></a><span class="co">#&gt; 0 of 2000 iterations saturated the maximum tree depth of 12 (0%)</span></span>
<span id="cb41-51"><a href="#cb41-51" tabindex="-1"></a><span class="co">#&gt; E-FMI indicated no pathological behavior</span></span>
<span id="cb41-52"><a href="#cb41-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb41-53"><a href="#cb41-53" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using NUTS(diag_e) at Wed Sep 04 11:34:00 AM 2024.</span></span>
<span id="cb41-54"><a href="#cb41-54" tabindex="-1"></a><span class="co">#&gt; For each parameter, n_eff is a crude measure of effective sample size,</span></span>
<span id="cb41-55"><a href="#cb41-55" tabindex="-1"></a><span class="co">#&gt; and Rhat is the potential scale reduction factor on split MCMC chains</span></span>
<span id="cb41-56"><a href="#cb41-56" tabindex="-1"></a><span class="co">#&gt; (at convergence, Rhat = 1)</span></span></code></pre></div>
<p>View posterior hindcasts / forecasts and compare against the out of
sample test data</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">plot</span>(model4, <span class="at">type =</span> <span class="st">&#39;forecast&#39;</span>, <span class="at">newdata =</span> data_test)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>The trend is evolving as an AR1 process, which we can also view:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">plot</span>(model4, <span class="at">type =</span> <span class="st">&#39;trend&#39;</span>, <span class="at">newdata =</span> data_test)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>In-sample model performance can be interrogated using leave-one-out
cross-validation utilities from the <code>loo</code> package (a higher
value is preferred for this metric):</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">loo_compare</span>(model3, model4)</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="co">#&gt;        elpd_diff se_diff</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="co">#&gt; model4    0.0       0.0 </span></span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="co">#&gt; model3 -560.9      66.6</span></span></code></pre></div>
<p>The higher estimated log predictive density (ELPD) value for the
dynamic model suggests it provides a better fit to the in-sample
data.</p>
<p>Though it should be obvious that this model provides better
forecasts, we can quantify forecast performance for models 3 and 4 using
the <code>forecast</code> and <code>score</code> functions. Here we will
compare models based on their Discrete Ranked Probability Scores (a
lower value is preferred for this metric)</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>fc_mod3 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model3)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>fc_mod4 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(model4)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>score_mod3 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod3, <span class="at">score =</span> <span class="st">&#39;drps&#39;</span>)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>score_mod4 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod4, <span class="at">score =</span> <span class="st">&#39;drps&#39;</span>)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a><span class="fu">sum</span>(score_mod4<span class="sc">$</span>PP<span class="sc">$</span>score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">sum</span>(score_mod3<span class="sc">$</span>PP<span class="sc">$</span>score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="co">#&gt; [1] -132.6078</span></span></code></pre></div>
<p>A strongly negative value here suggests the score for the dynamic
model (model 4) is much smaller than the score for the model with a
smooth function of time (model 3)</p>
</div>
<div id="interested-in-contributing" class="section level2">
<h2>Interested in contributing?</h2>
<p>I’m actively seeking PhD students and other researchers to work in
the areas of ecological forecasting, multivariate model evaluation and
development of <code>mvgam</code>. Please reach out if you are
interested (n.clark’at’uq.edu.au)</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
